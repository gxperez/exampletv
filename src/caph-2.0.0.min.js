/**
 * Copyright (c) 2014 Samsung Electronics Co., Ltd All Rights Reserved 
 * PROPRIETARY/CONFIDENTIAL
 *  
 * This software is the confidential and proprietary information of SAMSUNG 
 * ELECTRONICS ("Confidential Information"). You shall not disclose such 
 * Confidential Information and shall use it only in accordance with the terms of 
 * the license agreement you entered into with SAMSUNG ELECTRONICS. SAMSUNG make 
 * no representations or warranties about the suitability of the software, either 
 * express or implied, including but not limited to the implied warranties of 
 * merchantability, fitness for a particular purpose, or non-infringement. 
 * SAMSUNG shall not be liable for any damages suffered by licensee as a result 
 * of using, modifying or distributing this software or its derivatives.
 */

/*! CaphFramework v2.1 2.0.0-150102 @ 2015-01-02 22:19:31 */
(function(){"use strict";function t(t,e){for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i;return-1}function e(t){var e=t._promiseCallbacks;return e||(e=t._promiseCallbacks={}),e}function i(t,e){return"onerror"===t?(ge.on("error",e),void 0):2!==arguments.length?ge[t]:(ge[t]=e,void 0)}function n(t){return"function"==typeof t||"object"==typeof t&&null!==t}function s(t){return"function"==typeof t}function o(t){return"object"==typeof t&&null!==t}function r(){}function a(){setTimeout(function(){for(var t,e=0;be.length>e;e++){t=be[e];var i=t.payload;i.guid=i.key+i.id,i.childGuid=i.key+i.childId,i.error&&(i.stack=i.error.stack),ge.trigger(t.name,t.payload)}be.length=0},50)}function h(t,e,i){1===be.push({name:t,payload:{key:e._guidKey,id:e._id,eventName:t,detail:e._result,childId:i&&i._id,label:e._label,timeStamp:Ie(),error:ge["instrument-with-stack"]?Error(e._label):null}})&&a()}function c(){return new TypeError("A promises callback cannot return that same promise.")}function l(){}function u(t){try{return t.then}catch(e){return Oe.error=e,Oe}}function p(t,e,i,n){try{t.call(e,i,n)}catch(s){return s}}function d(t,e,i){ge.async(function(t){var n=!1,s=p(i,e,function(i){n||(n=!0,e!==i?_(t,i):v(t,i))},function(e){n||(n=!0,y(t,e))},"Settle: "+(t._label||" unknown promise"));!n&&s&&(n=!0,y(t,s))},t)}function f(t,e){e._state===we?v(t,e._result):t._state===Ce?y(t,e._result):I(e,void 0,function(i){e!==i?_(t,i):v(t,i)},function(e){y(t,e)})}function m(t,e){if(e.constructor===t.constructor)f(t,e);else{var i=u(e);i===Oe?y(t,Oe.error):void 0===i?v(t,e):s(i)?d(t,e,i):v(t,e)}}function _(t,e){t===e?v(t,e):n(e)?m(t,e):v(t,e)}function g(t){t._onerror&&t._onerror(t._result),T(t)}function v(t,e){t._state===Se&&(t._result=e,t._state=we,0===t._subscribers.length?ge.instrument&&Ee("fulfilled",t):ge.async(T,t))}function y(t,e){t._state===Se&&(t._state=Ce,t._result=e,ge.async(g,t))}function I(t,e,i,n){var s=t._subscribers,o=s.length;t._onerror=null,s[o]=e,s[o+we]=i,s[o+Ce]=n,0===o&&t._state&&ge.async(T,t)}function T(t){var e=t._subscribers,i=t._state;if(ge.instrument&&Ee(i===we?"fulfilled":"rejected",t),0!==e.length){for(var n,s,o=t._result,r=0;e.length>r;r+=3)n=e[r],s=e[r+i],n?S(i,n,s,o):s(o);t._subscribers.length=0}}function b(){this.error=null}function E(t,e){try{return t(e)}catch(i){return xe.error=i,xe}}function S(t,e,i,n){var o,r,a,h,l=s(i);if(l){if(o=E(i,n),o===xe?(h=!0,r=o.error,o=null):a=!0,e===o)return y(e,c()),void 0}else o=n,a=!0;e._state!==Se||(l&&a?_(e,o):h?y(e,r):t===we?v(e,o):t===Ce&&y(e,o))}function w(t,e){try{e(function(e){_(t,e)},function(e){y(t,e)})}catch(i){y(t,i)}}function C(t,e,i){return t===we?{state:"fulfilled",value:i}:{state:"rejected",reason:i}}function O(t,e,i,n){this._instanceConstructor=t,this.promise=new t(l,n),this._abortOnReject=i,this._validateInput(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._init(),0===this.length?v(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&v(this.promise,this._result))):y(this.promise,this._validationError())}function x(t,e){return new Me(this,t,!0,e).promise}function M(t,e){function i(t){_(o,t)}function n(t){y(o,t)}var s=this,o=new s(l,e);if(!ye(t))return y(o,new TypeError("You must pass an array to race.")),o;for(var r=t.length,a=0;o._state===Se&&r>a;a++)I(s.resolve(t[a]),void 0,i,n);return o}function P(t,e){var i=this;if(t&&"object"==typeof t&&t.constructor===i)return t;var n=new i(l,e);return _(n,t),n}function A(t,e){var i=this,n=new i(l,e);return y(n,t),n}function N(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function L(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function R(t,e){this._id=De++,this._label=e,this._state=void 0,this._result=void 0,this._subscribers=[],ge.instrument&&Ee("created",this),l!==t&&(s(t)||N(),this instanceof R||L(),w(this,t))}function D(){this.value=void 0}function k(t){try{return t.then}catch(e){return Fe.value=e,Fe}}function F(t,e,i){try{t.apply(e,i)}catch(n){return Fe.value=n,Fe}}function B(t,e){for(var i,n,s={},o=t.length,r=Array(o),a=0;o>a;a++)r[a]=t[a];for(n=0;e.length>n;n++)i=e[n],s[i]=r[n+1];return s}function z(t){for(var e=t.length,i=Array(e-1),n=1;e>n;n++)i[n-1]=t[n];return i}function H(t,e){return{then:function(i,n){return t.call(e,i,n)}}}function $(t,e){var i=function(){for(var i,n=this,s=arguments.length,o=Array(s+1),r=!1,a=0;s>a;++a){if(i=arguments[a],!r){if(r=q(i),r===Be){var h=new ke(l);return y(h,Be.value),h}r&&r!==!0&&(i=H(r,i))}o[a]=i}var c=new ke(l);return o[s]=function(t,i){t?y(c,t):void 0===e?_(c,i):e===!0?_(c,z(arguments)):ye(e)?_(c,B(arguments,e)):_(c,i)},r?U(c,o,t,n):V(c,o,t,n)};return i.__proto__=t,i}function V(t,e,i,n){var s=F(i,n,e);return s===Fe&&y(t,s.value),t}function U(t,e,i,n){return ke.all(e).then(function(e){var s=F(i,n,e);return s===Fe&&y(t,s.value),t})}function q(t){return t&&"object"==typeof t?t.constructor===ke?!0:k(t):!1}function W(t,e){return ke.all(t,e)}function G(t,e,i){this._superConstructor(t,e,!1,i)}function Z(t,e){return new G(ke,t,e).promise}function j(t,e){return ke.race(t,e)}function X(t,e,i){this._superConstructor(t,e,!0,i)}function K(t,e){return new Ue(ke,t,e).promise}function Y(t,e,i){this._superConstructor(t,e,!1,i)}function Q(t,e){return new Y(ke,t,e).promise}function J(t){throw setTimeout(function(){throw t}),t}function te(t){var e={};return e.promise=new ke(function(t,i){e.resolve=t,e.reject=i},t),e}function ee(t,e,i){return ke.all(t,i).then(function(t){if(!s(e))throw new TypeError("You must pass a function as map's second argument.");for(var n=t.length,o=Array(n),r=0;n>r;r++)o[r]=e(t[r]);return ke.all(o,i)})}function ie(t,e){return ke.resolve(t,e)}function ne(t,e){return ke.reject(t,e)}function se(t,e,i){return ke.all(t,i).then(function(t){if(!s(e))throw new TypeError("You must pass a function as filter's second argument.");for(var n=t.length,o=Array(n),r=0;n>r;r++)o[r]=e(t[r]);return ke.all(o,i).then(function(e){for(var i=Array(n),s=0,o=0;n>o;o++)e[o]&&(i[s]=t[o],s++);return i.length=s,i})})}function oe(t,e){oi[Je]=t,oi[Je+1]=e,Je+=2,2===Je&&We()}function re(){return function(){process.nextTick(ue)}}function ae(){return function(){vertxNext(ue)}}function he(){var t=0,e=new ni(ue),i=document.createTextNode("");return e.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}function ce(){var t=new MessageChannel;return t.port1.onmessage=ue,function(){t.port2.postMessage(0)}}function le(){return function(){setTimeout(ue,1)}}function ue(){for(var t=0;Je>t;t+=2){var e=oi[t],i=oi[t+1];e(i),oi[t]=void 0,oi[t+1]=void 0}Je=0}function pe(){try{var t=require("vertx");return t.runOnLoop||t.runOnContext,ae()}catch(e){return le()}}function de(t,e){ge.async(t,e)}function fe(){ge.on.apply(ge,arguments)}function me(){ge.off.apply(ge,arguments)}var _e={mixin:function(t){return t.on=this.on,t.off=this.off,t.trigger=this.trigger,t._promiseCallbacks=void 0,t},on:function(i,n){var s,o=e(this);s=o[i],s||(s=o[i]=[]),-1===t(s,n)&&s.push(n)},off:function(i,n){var s,o,r=e(this);return n?(s=r[i],o=t(s,n),-1!==o&&s.splice(o,1),void 0):(r[i]=[],void 0)},trigger:function(t,i){var n,s,o=e(this);if(n=o[t])for(var r=0;n.length>r;r++)s=n[r],s(i)}},ge={instrument:!1};_e.mixin(ge);var ve;ve=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var ye=ve,Ie=Date.now||function(){return(new Date).getTime()},Te=Object.create||function(t){if(arguments.length>1)throw Error("Second argument not supported");if("object"!=typeof t)throw new TypeError("Argument must be an object");return r.prototype=t,new r},be=[],Ee=h,Se=void 0,we=1,Ce=2,Oe=new b,xe=new b,Me=O;O.prototype._validateInput=function(t){return ye(t)},O.prototype._validationError=function(){return Error("Array Methods must be provided an Array")},O.prototype._init=function(){this._result=Array(this.length)},O.prototype._enumerate=function(){for(var t=this.length,e=this.promise,i=this._input,n=0;e._state===Se&&t>n;n++)this._eachEntry(i[n],n)},O.prototype._eachEntry=function(t,e){var i=this._instanceConstructor;o(t)?t.constructor===i&&t._state!==Se?(t._onerror=null,this._settledAt(t._state,e,t._result)):this._willSettleAt(i.resolve(t),e):(this._remaining--,this._result[e]=this._makeResult(we,e,t))},O.prototype._settledAt=function(t,e,i){var n=this.promise;n._state===Se&&(this._remaining--,this._abortOnReject&&t===Ce?y(n,i):this._result[e]=this._makeResult(t,e,i)),0===this._remaining&&v(n,this._result)},O.prototype._makeResult=function(t,e,i){return i},O.prototype._willSettleAt=function(t,e){var i=this;I(t,void 0,function(t){i._settledAt(we,e,t)},function(t){i._settledAt(Ce,e,t)})};var Pe=x,Ae=M,Ne=P,Le=A,Re="rsvp_"+Ie()+"-",De=0,ke=R;R.cast=Ne,R.all=Pe,R.race=Ae,R.resolve=Ne,R.reject=Le,R.prototype={constructor:R,_guidKey:Re,_onerror:function(t){ge.trigger("error",t)},then:function(t,e,i){var n=this,s=n._state;if(s===we&&!t||s===Ce&&!e)return ge.instrument&&Ee("chained",this,this),this;n._onerror=null;var o=new this.constructor(l,i),r=n._result;if(ge.instrument&&Ee("chained",n,o),s){var a=arguments[s-1];ge.async(function(){S(s,o,a,r)})}else I(n,o,t,e);return o},"catch":function(t,e){return this.then(null,t,e)},"finally":function(t,e){var i=this.constructor;return this.then(function(e){return i.resolve(t()).then(function(){return e})},function(e){return i.resolve(t()).then(function(){throw e})},e)}};var Fe=new D,Be=new D,ze=$,He=W;G.prototype=Te(Me.prototype),G.prototype._superConstructor=Me,G.prototype._makeResult=C,G.prototype._validationError=function(){return Error("allSettled must be called with an array")};var $e=Z,Ve=j,Ue=X;X.prototype=Te(Me.prototype),X.prototype._superConstructor=Me,X.prototype._init=function(){this._result={}},X.prototype._validateInput=function(t){return t&&"object"==typeof t},X.prototype._validationError=function(){return Error("Promise.hash must be called with an object")},X.prototype._enumerate=function(){var t=this.promise,e=this._input,i=[];for(var n in e)t._state===Se&&e.hasOwnProperty(n)&&i.push({position:n,entry:e[n]});var s=i.length;this._remaining=s;for(var o,r=0;t._state===Se&&s>r;r++)o=i[r],this._eachEntry(o.entry,o.position)};var qe=K;Y.prototype=Te(Ue.prototype),Y.prototype._superConstructor=Me,Y.prototype._makeResult=C,Y.prototype._validationError=function(){return Error("hashSettled must be called with an object")};var We,Ge=Q,Ze=J,je=te,Xe=ee,Ke=ie,Ye=ne,Qe=se,Je=0,ti=oe,ei="undefined"!=typeof window?window:void 0,ii=ei||{},ni=ii.MutationObserver||ii.WebKitMutationObserver,si="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,oi=Array(1e3);if(We="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?re():ni?he():si?ce():void 0===ei&&"function"==typeof require?pe():le(),ge.async=ti,"undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var ri=window.__PROMISE_INSTRUMENTATION__;i("instrument",!0);for(var ai in ri)ri.hasOwnProperty(ai)&&fe(ai,ri[ai])}var hi={race:Ve,Promise:ke,allSettled:$e,hash:qe,hashSettled:Ge,denodeify:ze,on:fe,off:me,map:Xe,filter:Qe,resolve:Ke,reject:Ye,all:He,rethrow:Ze,defer:je,EventTarget:_e,configure:i,async:de};"function"==typeof define&&define.amd?define(function(){return hi}):"undefined"!=typeof module&&module.exports?module.exports=hi:this!==void 0&&(this.RSVP=hi)}).call(this),function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;e.length>i&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var i=(new Date).getTime(),n=Math.max(0,16-(i-t)),s=window.setTimeout(function(){e(i+n)},n);return t=i+n,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),function(){Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),i=this,n=function(){},s=function(){return i.apply(this instanceof n&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,s.prototype=new n,s})}(),function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){var i;if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),s=n.length>>>0;if(0===s)return-1;var o=+e||0;if(1/0===Math.abs(o)&&(o=0),o>=s)return-1;for(i=Math.max(o>=0?o:s-Math.abs(o),0);s>i;){if(i in n&&n[i]===t)return i;i++}return-1})}(),Object.prototype.watch||function(t,e){t=t||Object.prototype;var i=function i(t,e,i,n){var s=Object.getOwnPropertyDescriptor(t,e),o=s.get,r=s.set;if(!s.configurable||void 0===s.value&&!s.set||s.writable===!1)return!1;var a=s.value;o=void 0!==s.value?function(){return a}:s.get;var h;if(!r||r&&!r._watchers){var c=function(t){if(a===t)return a;for(var i=a,n=0;c._watchers.length>n;n++){var s=c._watchers[n],o=s.func.call(s.scope,e,i,t);s.mutate&&(t=o)}return a=t};if(c._watchers=[],r){var l={func:function(t,e,i){r(i)},scope:t,mutate:!0};c._watchers.push(l)}h=c}h||(h=r);var u="function"==typeof i?{func:i}:i;return u.scope=n||t,h._watchers.push(u),Object.defineProperty(t,e,{get:o,set:h,configurable:!0,enumerable:s.enumerable}),u.scope},n=function n(t,e,i){var n=Object.getOwnPropertyDescriptor(t,e);if(!(e&&n&&n.set&&n.set._watchers&&0!==n.set._watchers.length))return!1;if(!i)return n.set._watchers=[],!0;for(var s=n.set._watchers,o=0;s.length>o;){if(s[o].func===i)return s.splice(o,1).scope;++o}return!1},s=function(){if(!e&&t.hasOwnProperty("watch")||t.hasOwnProperty("unwatch")||t.hasOwnProperty("getWatchers")||t.hasOwnProperty("getMutators"))throw Error("DataWatch is overriding a previously declared method.");var s={writable:!1,enumerable:!1,configurable:!0};s.value=function(t,e,n){if(t instanceof Array)for(var s in t)Object.watch.apply(this,[t[s],e,n]);else i.apply(this,[this,t,e,n])},Object.defineProperty(t,"watch",s),s.value=function(t,e){n.apply(this,[this,t,e])},Object.defineProperty(t,"unwatch",s)};return s(),t}(),function(t){function e(){function t(t){return i(t)&&(c.splice(n,1),l.splice(n,1)),n>-1}function e(t,e){return i(t)?l[n]:e}function i(t){if(t!==s(t))throw new TypeError("not a non-null object");return n=a.call(c,t),n>-1}function h(t,e){i(t)?l[n]=e:l[c.push(t)-1]=e}var c=[],l=[];return r(o,{"delete":{value:t},get:{value:e},has:{value:i},set:{value:h}})}function i(){}if(!window.WeakMap){var n,s=t.Object,o=e.prototype,r=s.create||function r(t,e){var n=new i;return n["delete"]=e["delete"].value,n.get=e.get.value,n.has=e.has.value,n.set=e.set.value,n},a=[].indexOf||function a(t){for(n=this.length;n--&&this[n]!==t;);return n};e.prototype=i.prototype=o=e(),"defineProperty"in s?s.defineProperty(t,"WeakMap",{value:e}):t.WeakMap=e}}(window),window.Promise=window.Promise||RSVP.Promise,Object.defineProperty(Array.prototype,"remove",{writable:!1,enumerable:!1,configurable:!0,value:function(t,e){var i=this.slice((e||t)+1||this.length);return this.length=0>t?this.length+t:t,this.push.apply(this,i)}}),function(t){function e(t,i){3===arguments.length&&arguments[2]===!0&&(t=n(t));for(var s in i)i[s]&&i[s].constructor&&i[s].constructor===Object?(t[s]=t[s]||{},"object"!=typeof t[s]?t[s]=i[s]:e(t[s],i[s])):t[s]=i[s];return t}function i(){for(var t={},i=0,n=arguments.length;n>i;i++)t=e(t,arguments[i]);return t}function n(e){var i,s,o=null;if("object"!=typeof e||null===e||void 0===e||e===t)return e;if(e instanceof Array)for(o=[],i=0,s=e.length;s>i;i++)o[i]=n(e[i]);else if(e instanceof Date)o=new Date(e.getTime());else if(e instanceof Object){o={};for(i in e)e.hasOwnProperty(i)&&(o[i]=n(e[i]));o.__proto__=e.__proto__}return o}function s(t,e){function i(t){return t&&"object"==typeof t&&"number"==typeof t.length}if(typeof t!=typeof e)return!1;switch(typeof t){case"number":case"string":case"boolean":case"undefined":return t===e;case"object":if(null===t)return t===e;if(i(t)!==i(e))return!1;if(i(t)){if(t.length!==e.length)return!1;for(var n=0,o=t.length;o>n;n++)if(!s(t[n],e[n]))return!1;return!0}var r=Object.keys(t),a=Object.keys(e);if(r.length!==a.length)return!1;for(var n=0,o=r.length;o>n;n++)if(!e.hasOwnProperty(r[n]))return!1;for(var n=0,o=r.length;o>n;n++)if(!s(t[r[n]],e[r[n]]))return!1;return!0;default:return t===e}}function o(i,n,s){var o;if("string"==typeof i){o=i.split("."),s=s||t;for(var r=0,a=o.length;a>r;r++){if(s[o[r]]=s[o[r]]||{},r==o.length-1){if("object"!=typeof n){s[o[r]]=n;break}s[o[r]]=e(s[o[r]],n)}s=s[o[r]]}}}function r(){return"2.0.0"}function a(){return"20150102-4ccdd3bbef56c56d5b7975adabc48dbf0f39476e"}o("caph",{namespace:o,extend:e,mixin:i,clone:n,equal:s,getVersion:r,getRevision:a})}(this),function(){function t(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}caph.namespace("caph",{once:t})}(this),function(){"use strict";var t=Object.prototype,e=t.hasOwnProperty;caph.namespace("caph",{isFunction:function(t){return"function"==typeof t},isNumber:function(t){return"number"==typeof t},isString:function(t){return"string"==typeof t},isBoolean:function(t){return"boolean"==typeof t},isRegExp:function(t){return t instanceof RegExp},isArray:function(t){return t instanceof Array},isObjectInArray:function(t,e){return-1!==t.indexOf(e)},isObject:function(t){return t instanceof Object},isNull:function(t){return null===t},isUndefined:function(t){return void 0===t},isEmpty:function(t){if(null==t)return!0;if(caph.isArray(t)||caph.isString(t)||caph.isArguments(t))return 0===t.length;for(var e in t)if(caph.has(t,e))return!1;return!0},has:function(t,i){return null!=t&&e.call(t,i)},isArguments:function(t){return caph.has(t,"callee")},isBlank:function(t){return caph.isNull(t)||caph.isUndefined(t)||""===t},isHTMLElement:function(t){return t instanceof HTMLElement}})}(this),function(t){function e(e,n){if(h[e])throw Error(e+" is already used by another.");var s,o,a=r.exec(e);a?(s=i(a[1]),o=a[2]):(s=t,o=e),s[o]=n,h[e]=!0}function i(e){var i=c[e];if(i)return i;var n,s,o,r=t,a=e.split(".");for(n=0,s=a.length;s>n;n++)o=a[n],r=r[o]=r[o]||{};return c[e]=r}function n(t){var i,n,s=t.$namespace,o=t.$extends,r=t.$statics;if(i=o?o._extend(t):BaseClass._extend(t),r)for(n in r)r.hasOwnProperty(n)&&(i[n]=r[n]);return s&&e(s,i),i}var s=!1,o=/\B\$super\b/,r=/(.*)\.(.*)/,a=/^\$(?:namespace|extends|mixins|statics)$/;BaseClass=function(){},BaseClass._mixins=[],BaseClass._extend=function(t){function e(){var t=this.$constructor,e=this.constructor._mixins;if(!s){if(e)for(var i=0,n=e.length;n>i;i++){var o=e[i];for(var r in o)o.hasOwnProperty(r)&&void 0===this[r]&&(this[r]=o[r])}t&&t.apply(this,arguments)}}var i=this.prototype;s=!0;var n=new this;s=!1;var r=[];this._mixins.length>0&&(r=r.concat(this._mixins)),t.$mixins&&t.$mixins.length>0&&(r=r.concat(t.$mixins));for(var h in t)a.test(h)||(n[h]="function"==typeof t[h]&&"function"==typeof i[h]&&o.test(t[h])?function(t,e){return function(){var n=this.$super;this.$super=i[t];var s=e.apply(this,arguments);return this.$super=n,s}}(h,t[h]):t[h]);return e.prototype=n,e.prototype.constructor=e,e._mixins=r,e._extend=arguments.callee,e};var h={},c={};return t.$class=n}(this),function(){"use strict";var t={},e=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFE\u0590-\u05FF\uFB1D-\uFB4F]/;caph.namespace("caph",{toCamelCase:function(e){var i=t[e];return i?i:(i=e.toLowerCase().replace(/-(.)/gi,function(t,e,i){return 0===i?e:e.toUpperCase()}),i&&(t[e]=i),i)},capitalize:function(t){return t?t.charAt(0).toUpperCase()+t.substr(1):t},escapeHTML:function(t){return t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&#39;"):t},isRTL:function(t){return e.test(t)}})}(this),function(window){"use strict";caph.namespace("caph",{xhr:function(t,e){if(!t)return new Promise(function(){});var i={method:"get",async:!0,parameter:null,type:"XML",header:null,timeout:0};if(caph.extend(i,e),"JSONP"===i.type)return ajaxUtil.jsonp(t,e.parameter,e.jsonpCharset,e.jsonpCallback);if(i.async===!1)return ajaxUtil.synchronous(t,i.parameter,i.method,i.type,i.header);var n=new caph.xhr.Request(t,i.parameter,i.method,i.type,i.timeout);return n.setRequestHeader(i.header),n.request()}}),$class({$namespace:"caph.xhr.RequestQueue",$constructor:function(){this.queue=[]},push:function(t){t._sequence=ajaxUtil.getRequestSequence(),this.queue.push(t)},pop:function(){return this.queue.length>0?this.queue.shift():null}}),$class({$namespace:"caph.xhr.RequestProcessor",$constructor:function(){this.queue=new caph.xhr.RequestQueue,this.busy=!1,this.request=null,this.xhr=null},process:function(t){return this.queue.push(t),new Promise(function(e,i){t._resolve=e,t._reject=i,setTimeout(this.doRequest.bind(this),0)}.bind(this))},clear:function(){this.busy=!1,this.request=null,this.xhr=null},doRequest:function(){if(this.busy!==!0&&(this.clear(),this.request=this.queue.pop(),this.request)){this.xhr=ajaxUtil.createXHR();var t=ajaxUtil.encodeUrl(this.request.getUrl()),e=ajaxUtil.encodeParameter(this.request.getParameter()),i=this.request.getMethod();this.xhr.open(i,ajaxUtil.getRequestUrl(ajaxUtil.getRequestUrl(t,e,i),"_requestSequence="+this.request._sequence,i),!0),this.xhr.onreadystatechange=function(){if(4===this.xhr.readyState){var t=new caph.xhr.Response(this.xhr,this.request.getType());t.isSuccess()?this.request._resolve(t):this.request._reject(t),this.clear(),setTimeout(this.doRequest.bind(this),0)}}.bind(this),this.xhr.timeout=this.request.getTimeout(),ajaxUtil.setRequestHeader(this.xhr,this.request.getRequestHeader(),i),this.busy=!0,this.xhr.send("post"===i?e:"")}}}),$class({$namespace:"caph.xhr.Request",$constructor:function(t,e,i,n,s){this.url=t||null,this.parameter=e||null,this.method=i||"get",this.type=n||"XML",this.timeout=caph.isBlank(s)?0:s,this.requestHeader=null,this._sequence=null,this._requestProcessorIndex=null,this._resolve=null,this._reject=null},getUrl:function(){return this.url},getParameter:function(){return this.parameter},getMethod:function(){return this.method},getType:function(){return this.type},getTimeout:function(){return this.timeout},setRequestHeader:function(t){t&&(this.requestHeader=t)},getRequestHeader:function(){return this.requestHeader},request:function(){return ajaxUtil.perform(this)}}),$class({$namespace:"caph.xhr.Response",$constructor:function(t,e){if(this.xhr=t,this.type=e,this.value=null,this.isSuccess())switch(e.toUpperCase()){case"JSON":this.value=this.getJSON();break;case"XML":this.value=this.getXML();break;case"HTML":this.value=this.getText();break;case"TEXT":this.value=this.getText()}},isSuccess:function(){return void 0===this.xhr.status||0===this.xhr.status||this.xhr.status>=200&&300>this.xhr.status},getType:function(){return this.type},getJSON:function(){if("undefined"!=typeof JSON)try{return JSON.parse(this.getText())}catch(e){return console.log(e),null}try{return eval("("+this.getText()+")")}catch(e){return console.log(e),null}},getXML:function(){return this.xhr.responseXML},getText:function(t){return t===!0?caph.escapeHTML(this.xhr.responseText):this.xhr.responseText},getStatus:function(){return this.xhr.status},getStatusText:function(){return this.xhr.statusText},getHeader:function(t){return this.xhr.getResponseHeader(t)}});var ajaxUtil={requestSequence:0,maxRequestSequence:1e7,requestProcessor:[],maxRequestProcessor:6,requestProcessorIndex:0,progIds:["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],progId:null,getRequestSequence:function(){return this.requestSequence++%this.maxRequestSequence},createActiveXObject:function(){return new ActiveXObject(this.progId)},createXMLHttpRequest:function(){return new XMLHttpRequest},encodeUrl:function(t){var e=t.indexOf("?");return 0>e?t:t.substring(0,e)+"?"+this.encodeParameter(t.substring(e+1))},encodeParameter:function(t){var e=[];if(caph.isString(t)){for(var i=t.split("&"),n=0,s=i.length;s>n;n++){var o=i[n].split("=");e.push(encodeURIComponent(o[0])+"="+(o[1]?encodeURIComponent(o[1]):""))}return e.join("&")}if(caph.isObject(t)){for(var r in t)if(t.hasOwnProperty(r)){var a=t[r];e.push(encodeURIComponent(r)+"="+(caph.isBlank(a)?"":encodeURIComponent(a)))}return e.join("&")}return""},getRequestUrl:function(t,e,i){return"get"===i&&e?t+(t.match(/\?/)?"&":"?")+e:t},setRequestHeader:function(t,e,i){if(e&&caph.isObject(e))for(var n in e)e.hasOwnProperty(n)&&t.setRequestHeader(n,e[n]);"post"===i&&t.setRequestHeader("Content-type","application/x-www-form-urlencoded")},synchronous:function(t,e,i,n,s){var o=this.createXHR();return t=this.encodeUrl(t),e=this.encodeParameter(e),o.open(i,this.getRequestUrl(t,e,i),!1),this.setRequestHeader(o,s,i),o.send("post"===i?e:null),new caph.xhr.Response(o,n)},jsonp:function(t,e,i,n){var s="_caph_callback_"+(new Date).getTime()+"_"+Math.floor(1e12*Math.random());t=this.encodeUrl(t),e=this.encodeParameter(e);var o=document.createElement("script");return o.type="text/javascript",i&&(o.charset=i),o.src=this.getRequestUrl(this.getRequestUrl(t,e,"get"),(n||"_callback")+"="+s,"get"),new Promise(function(t,e){window[s]=function(i){try{t(i)}catch(n){e(i)}finally{o.parentNode.removeChild(o);try{window[s]=void 0}catch(n){console.log(n)}}};var i=caph.dom.getElement("head");i?i.append(o):document.body.appendChild(o)})},init:function(){var t,e;if(window.ActiveXObject){for(t=0,e=this.progIds.length;e>t;t++)try{var i=new ActiveXObject(this.progIds[t]);if(i){this.progId=this.progIds[t];break}}catch(n){console.log(n)}this.createXHR=this.createActiveXObject}else window.XMLHttpRequest&&(this.createXHR=this.createXMLHttpRequest);for(t=0,e=this.maxRequestProcessor;e>t;t++)this.requestProcessor.push(new caph.xhr.RequestProcessor);return this},perform:function(t){return t._requestProcessorIndex=this.requestProcessorIndex++%this.maxRequestProcessor,this.requestProcessor[t._requestProcessorIndex].process(t)}}.init()}(this),function(){"use strict";function t(t,i,n,s,o){if(!t||!i)throw Error("INVALID DATA : KEY - VALUE");if(void 0===n)n=0;else if(isNaN(n))throw Error("INVALID DATA :EXHOURS");o=e(o),s=e(s);var r=[encodeURIComponent(t)+"="+encodeURIComponent(i)];n&&r.push("expires="+new Date((new Date).getTime()+1e3*60*60*n).toUTCString()),s&&r.push("domain="+s),o&&r.push("path="+o),document.cookie=r.join(";")}function e(t){if("string"!=typeof t)return"";var e=t.indexOf(";");return-1!=e&&(t=t.substring(0,e)),t}function i(t){for(var e=encodeURIComponent(t),i=document.cookie.split(";"),n=0,s=i.length;s>n;n++){var o=i[n].split("=");if(o[0]=o[0].replace(/^\s*/,""),o[0]===e)return decodeURIComponent(o[1]);if(o[0]===t)return o[1]}return null}function n(e,i,n){t(e,e,-1,i,n)}caph.namespace("caph.cookie",{set:t,get:i,remove:n})}(this),function(t){"use strict";function e(t,e,i){var n,s;return(n=l.exec(t))?(s=n[1])?c.id(s):(s=n[2])?c["class"](s,e,i):n[3]?c.tag(t,e,i):void 0:c.query(t,e,i)}function i(t){return void 0===t||null===t?r:t instanceof caph.dom.Element?t.firstElement:t}function n(t){return t?new caph.dom.Element([t]):null}function s(t,e){return t.length>0?e===!0?new caph.dom.Element([t[0]]):new caph.dom.Element(t):null}function o(t,n,s){var o=arguments.length;if(1>o)return null;if("string"==typeof t){if(2===o){var r=typeof arguments[1];"boolean"===r?n=arguments[1]:"undefined"!==r&&(s=arguments[1],n=!1)}return e(t,n,i(s))}return null}var r=t.document,a=r.getElementsByClassName?!0:!1,h=r.querySelector&&r.querySelectorAll?!0:!1,c={id:function(t){return n(r.getElementById(t))},"class":function(t,e,i){return s(i.getElementsByClassName(t),e)},tag:function(t,e,i){return s(i.getElementsByTagName(t),e)},query:function(t,e,i){return e===!0?n(i.querySelector(t)):s(i.querySelectorAll(t))}};a||(c["class"]=function(t,e,i){for(var n=[],o=i.getElementsByTagName("*"),r=0,a=o.length;a>r;r++)(" "+o[r].className+" ").indexOf(" "+t+" ")>-1&&n.push(o[r]);return s(n,e)}),h||(c.query=function(){});var l=/^(?:#([\w-]+)|\.([\w-]+)|(\w+))$/;caph.namespace("caph.dom",{getElement:o})}(this),function(t){"use strict";var e={abort:{type:"Event",bubble:!1},error:{type:"Event",bubble:!1},load:{type:"Event",bubble:!1},unload:{type:"Event",bubble:!1},select:{type:"Event",bubble:!0},focus:{type:"UIEvent",bubble:!1},blur:{type:"UIEvent",bubble:!1},focusin:{type:"UIEvent",bubble:!0},focusout:{type:"UIEvent",bubble:!0},resize:{type:"UIEvent",bubble:!1},scroll:{type:"UIEvent",bubble:!1},click:{type:"MouseEvent",bubble:!0},dblclick:{type:"MouseEvent",bubble:!0},mousedown:{type:"MouseEvent",bubble:!0},mousemove:{type:"MouseEvent",bubble:!0},mouseout:{type:"MouseEvent",bubble:!0},mouseup:{type:"MouseEvent",bubble:!0},mouseover:{type:"MouseEvent",bubble:!0},mousewheel:{type:"MouseEvent",bubble:!0},mouseenter:{type:"MouseEvent",bubble:!1},mouseleave:{type:"MouseEvent",bubble:!1},wheel:{type:"MouseEvent",bubble:!0},beforeinput:{type:"TextEvent",bubble:!0},input:{type:"TextEvent",bubble:!0},keydown:{type:"KeyboardEvent",bubble:!0},keyup:{type:"KeyboardEvent",bubble:!0}},i={keyboardEventProperties:{key:!0,code:!0,location:!0,ctrlKey:!0,shiftKey:!0,altKey:!0,metaKey:!0,repeat:!0,locale:!0,detail:!0,keyCode:!0,charCode:!0,which:!0,"char":!0},attachEvent:function(t,e,i){t.attachEvent("on"+e,i)},addEventListener:function(t,e,i,n){t.addEventListener(e,i,n)},on:function(t,e,i,n){this.addEventListener(t,e,i,n||!1)},bind:function(t,e,i,n,s){var o=function(t){"function"==typeof s?s(t.target||t.srcElement)===!0&&i(t):i(t)};return this.on(t,e,o,n||!1),{element:t,type:e,listener:o,capture:n||!1}},detachEvent:function(t,e,i){t.detachEvent("on"+e,i)},removeEventListener:function(t,e,i,n){t.removeEventListener(e,i,n)},off:function(t,e,i,n){this.removeEventListener(t,e,i,n||!1)},unbind:function(t){caph.isObject(t)&&this.off(t.element,t.type,t.listener,t.capture||!1)},fireEvent:function(t,e,i){t.fireEvent("on"+e,document.createEventObject(i))},dispatchEvent:function(t,i,n){var s,o=e[i];switch(o=o&&o.type,this.modifyEventProperties(n),o){case"Event":s=document.createEvent(o),s.initEvent(i,n.bubbles,n.cancelable);break;case"UIEvent":s=document.createEvent(o),s.initUIEvent(i,n.bubbles,n.cancelable,n.view,n.detail);break;case"MouseEvent":s=document.createEvent(o),s.initMouseEvent(i,n.bubbles,n.cancelable,n.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget);break;case"TextEvent":s=document.createEvent(o),s.initTextEvent(i,n.bubbles,n.cancelable,n.view,n.data);break;case"KeyboardEvent":s=document.createEvent(o),this.modifyKeyboardEventProperties(n),this.initKeyboarEvent(s,i,n),this.modifyKeyboardEvent(s,n);break;default:s=document.createEvent("CustomEvent"),s.initCustomEvent(i,n.bubbles,n.cancelable,n.detail)}t.dispatchEvent(s)},initKeyboarEvent:function(t,e,i){t.initKeyboardEvent(e,i.bubbles,i.cancelable,i.view,i.key,i.location,i.modifiersList,i.repeat,i.locale)},initKeyboarEventWebkit1:function(t,e,i){t.initKeyboardEvent(e,i.bubbles,i.cancelable,i.view,i.key,i.location,i.ctrlKey,i.shiftKey,i.altKey,i.metaKey,i.altGraphKey)},initKeyboarEventWebkit2:function(t,e,i){t.initKeyboardEvent(e,i.bubbles,i.cancelable,i.view,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode)},initKeyboarEventWebkit3:function(t,e,i){t.initKeyboardEvent(e,i.bubbles,i.cancelable,i.view,i.key,i.location,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.altGraphKey)},initKeyboarEventIE:function(t,e,i){t.initKeyboardEvent(e,i.bubbles,i.cancelable,i.view,i.key,i.location,i.modifiersList,i.repeat,i.locale)},modifyEventProperties:function(t){caph.isBlank(t.bubbles)&&(t.bubbles=!0),caph.isBlank(t.cancelable)&&(t.cancelable=!0),caph.isBlank(t.key)&&(t.key=""),caph.isBlank(t.char)&&(t.char="")},modifyKeyboardEventProperties:function(t){var e=this.getModifiersList(t);e&&(t.modifiersList=e),!t.key&&t.keyIdentifier&&(t.key=t.keyIdentifier),!t.location&&t.keyLocation&&(t.location=t.keyLocation),t.key&&!t.keyCode&&(t.keyCode=t.key.charCodeAt(0)),t.char&&!t.charCode&&(t.charCode=t.char.charCodeAt(0)),t.which||(t.which=t.keyCode)
},getModifiersList:function(t){var e=[];return t.ctrlKey&&e.push("Control"),t.shiftKey&&e.push("Shift"),t.altKey&&e.push("Alt"),t.metaKey&&e.push("Meta"),t.altGraphKey&&e.push("AltGraph"),e.length>0?e.join(" "):null},modifyKeyboardEvent:function(t,e){for(var i in e)if(this.keyboardEventProperties[i]&&t[i]!==e[i])try{delete t[i],Object.defineProperty(t,i,{value:e[i]})}catch(t){}},trigger:function(t,e,i){this.dispatchEvent(t,e,i||{})},init:function(){switch(!document.addEventListener&&document.attachEvent&&(this.on=this.attachEvent),!document.removeEventListener&&document.detachEvent&&(this.off=this.detachEvent),!document.dispatchEvent&&document.fireEvent&&(this.trigger=this.fireEvent),this.getInitKeyboardEventType()){case 1:this.initKeyboarEvent=this.initKeyboarEventWebkit1;break;case 2:this.initKeyboarEvent=this.initKeyboarEventWebkit2;break;case 3:this.initKeyboarEvent=this.initKeyboarEventWebkit3;break;case 4:this.initKeyboarEvent=this.initKeyboarEventIE}},getInitKeyboardEventType:function(){var e=document.createEvent("KeyboardEvent");try{return e.initKeyboardEvent("keydown",!1,!1,t,"+",3,!0,!1,!0,!1,!1),"+"===(e.keyIdentifier||e.key)&&3===(e.keyLocation||e.location)&&(e.ctrlKey?e.altKey?1:3:e.shiftKey?2:4)||9}catch(e){return 0}}};i.init();var n={add:function(t,e,n,s,o){if(!t)return null;4===arguments.length&&"function"==typeof s&&(o=s,s=!1);var r=[];if(caph.isArray(t)||t instanceof HTMLCollection){for(var a=0,h=t.length;h>a;a++)r.push(i.bind(t[a],e,n,s,o));return r}return t instanceof caph.dom.Element?o?t.delegate(e,n,o):t.bind(e,n,s):i.bind(t,e,n,s,o)},remove:function(t){if(caph.isArray(t))for(var e=0,n=t.length;n>e;e++)i.unbind(t[e]);else t instanceof caph.dom.Element?t.unbind():i.unbind(t)},fire:function(t,e,n){if(caph.isArray(t)||t instanceof HTMLCollection)for(var s=0,o=t.length;o>s;s++)i.trigger(t[s],e,n);else t instanceof caph.dom.Element?t.trigger(e,n):i.trigger(t,e,n)}};Object.defineProperty(n,"DEFAULT_EVENT_TYPE",{value:e,configurable:!1,enumerable:!0,writable:!1}),caph.namespace("caph.dom",{event:n}),$class({$namespace:"caph.dom.event.HandleManager",$constructor:function(){this.handle={}},get:function(t){return this.handle[t]},set:function(t,e){if(e){var i=this.handle[t]||[];i.push(e),this.handle[t]=i}},remove:function(t){this.handle[t]=null},types:function(){var t=[];for(var e in this.handle)this.handle.hasOwnProperty(e)&&t.push(e);return t}})}(this),function(t){function e(t,e,i){var n=!0;return t.length===e.length?(t.each(function(t,s){return i(t,s,e)?void 0:(n=!1,!1)}),n):!1}function i(t,e){var i=t.get(e);if(i){for(var n=0,s=i.length;s>n;n++)caph.dom.event.remove(i[n]);t.remove(e)}}function n(t){return caph.isNumber(t)?t:"auto"===t?0:1*t.replace("px","")}function s(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1}function o(t){return t&&t==t.window}function r(t){return t&&9===t.nodeType}function a(t){return o(t)?t:r(t)?t.defaultView||t.parentWindow:!1}function h(t,e){return t&&t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}function c(t){return t.length>0?new caph.dom.Element(t):null}function l(e){for(var i=t.document.documentElement,n=e.offsetParent||i;n&&!h(n,"html")&&"static"===caph.dom._style.get(n,"position");)n=n.offsetParent;return new caph.dom.Element(n||i)}function u(t,e){return"string"==typeof e?f(t,e):e instanceof caph.dom.Element?d(t,e.$):e}function p(t,e){return"string"==typeof e?f(t,e).firstChild:e instanceof caph.dom.Element?e.firstElement:e}function d(t,e){var i=m(t);if(i){for(var n=0,s=e.length;s>n;n++)i.appendChild(e[n]);return i}return null}function f(t,e){var i,n,s,o=_(t);if(o){if(o.innerHTML=e,n=o.childNodes,s=m(t),n&&s)for(var r=0,a=n.length;a>r;r++)i=n[r],1===i.nodeType&&s.appendChild(i.cloneNode(!0));return s}return null}function m(t){return t&&t.ownerDocument?t.ownerDocument.createDocumentFragment():null}function _(t){return t&&t.ownerDocument?t.ownerDocument.createElement("div"):null}function g(t,e){if(!t)return!1;for(var i=0,n=t.length;n>i;i++)if(t[i]==e)return!0;return!1}function v(t,e){var i=caph.dom.getElement(t,e);return i?i.get():null}caph.namespace("caph.dom._css",{addClass:function(t,e){t.className=caph.isArray(e)?(t.className+" "+e.join(" ")).trim():(t.className+" "+e).trim()},removeClass:function(t,e){var i=" "+t.className+" ";if(caph.isArray(e))for(var n=0,s=e.length;s>n;n++)i=i.replace(" "+e[n]+" "," ");else i=i.replace(" "+e+" "," ");t.className=i.trim()},hasClass:function(t,e){var i=" "+t.className+" ";if(!caph.isArray(e))return i.indexOf(" "+e+" ")>-1;for(var n=0,s=e.length;s>n;n++)if(i.indexOf(" "+e[n]+" ")>-1)return!0;return!1}}),caph.namespace("caph.dom._style",{get:function(t,e){var i,n=caph.toCamelCase(e);return i=t.style[n],i?i:document.defaultView&&document.defaultView.getComputedStyle&&(i=document.defaultView.getComputedStyle(t,null).getPropertyValue(e))?i:t.currentStyle&&(i=t.currentStyle[n])?i:"opacity"===e&&t.style.filter&&(i=t.style.filter.match(/alpha\(opacity=(.*)\)/),i[1])?1*i[1]/100:null},set:function(t,e,i){t.style[caph.toCamelCase(e)]=i,"opacity"===e&&t.style.filter&&(t.style.filter="alpha(opacity="+100*i+")")}}),$class({$namespace:"caph.dom.Element",$constructor:function(t){this.$=t instanceof caph.dom.Element?t.$:"string"==typeof t?caph.dom.Element.createElement(t):t.length?t:[t],this.length=this.$.length,this.firstElement=this.$[0]},$statics:{createElement:function(t){var e=document.createElement("div");e.innerHTML=t;var i=e.childNodes,n=[];if(i){for(var s=0,o=i.length;o>s;s++)1===i[s].nodeType&&n.push(i[s].cloneNode(!0));return n}return null}},addClass:function(t){return this.each(function(e,i){caph.dom._css.addClass(i,t)})},removeClass:function(t){return this.each(function(e,i){caph.dom._css.removeClass(i,t)})},hasClass:function(t){var e=!1;return this.each(function(i,n){return caph.dom._css.hasClass(n,t)?(e=!0,!1):void 0}),e},toggleClass:function(t){return this.hasClass(t)?this.removeClass(t):this.addClass(t)},attr:function(t,e){if(void 0===e){if("string"==typeof t)return this.firstElement.getAttribute(t);for(var i in t)t.hasOwnProperty(i)&&this.each(function(e,n){n.setAttribute(i,t[i])});return this}return this.each(function(i,n){n.setAttribute(t,e)})},removeAttr:function(t){return caph.isArray(t)?this.each(function(e,i){for(var n=0,s=t.length;s>n;n++)i.removeAttribute(t[n])}):this.each(function(e,i){i.removeAttribute(t)})},text:function(t){return void 0===t?this.map(function(t,e){return e.innerText}).join(""):this.each(function(e,i){i.innerText=t})},html:function(t){return void 0===t?this.firstElement.innerHTML:this.each(function(e,i){i.innerHTML=t})},outerHtml:function(){if(this.length>1){var t=[];return this.each(function(e,i){t.push(i.outerHTML)}),t}return this.firstElement.outerHTML},style:function(t,e){if(void 0===e){if("string"==typeof t)return caph.dom._style.get(this.firstElement,t);for(var i in t)t.hasOwnProperty(i)&&this.each(function(e,n){caph.dom._style.set(n,i,t[i])});return this}return this.each(function(i,n){caph.dom._style.set(n,t,e)})},show:function(t){return this.style("display",t?t:"block")},hide:function(){return this.style("display","none")},toggle:function(t){var e=this.style("display");return"none"===e?this.style("display",t?t:"block"):this.style("display","none")},width:function(t){return void 0===t?n(this.style("width"))||this.firstElement.offsetWidth:this.style("width",t+"px")},height:function(t){return void 0===t?n(this.style("height"))||this.firstElement.offsetHeight:this.style("height",t+"px")},innerWidth:function(){return this.width()+n(this.style("padding-left"))+n(this.style("padding-right"))},innerHeight:function(){return this.height()+n(this.style("padding-top"))+n(this.style("padding-bottom"))},outerWidth:function(t){var e=this.innerWidth()+n(this.style("border-left-width"))+n(this.style("border-right-width"));return t?e+n(this.style("margin-left"))+n(this.style("margin-right")):e},outerHeight:function(t){var e=this.innerHeight()+n(this.style("border-top-width"))+n(this.style("border-bottom-width"));return t?e+n(this.style("margin-top"))+n(this.style("margin-bottom")):e},padding:function(){return{left:n(this.style("padding-left")),right:n(this.style("padding-right")),top:n(this.style("padding-top")),bottom:n(this.style("padding-bottom"))}},border:function(){return{left:n(this.style("border-left-width")),right:n(this.style("border-right-width")),top:n(this.style("border-top-width")),bottom:n(this.style("border-bottom-width"))}},margin:function(){return{left:n(this.style("margin-left")),right:n(this.style("margin-right")),top:n(this.style("margin-top")),bottom:n(this.style("margin-bottom"))}},offset:function(t){if("object"==typeof t)return this.each(function(e,i){var s,o,r,a=new caph.dom.Element(i),h=a.style("position");"static"===h&&a.style("position","relative");var c=a.offset(),l=a.style("top"),u=a.style("left");"absolute"!==h&&"fixed"!==h||"auto"!==l&&"auto"!==u?(o=n(l),r=n(u)):(s=a.position(),o=s.top,r=s.left),"number"==typeof t.top&&a.style("top",t.top-c.top+o),"number"==typeof t.left&&a.style("left",t.left-c.left+r)});var e={top:0,left:0},i=this.firstElement.ownerDocument;if(i){var o=i.documentElement;if(!s(o,this.firstElement))return e;try{e=this.firstElement.getBoundingClientRect()}catch(r){e={top:0,left:0}}var h=a(i);return{top:e.top+(h.pageYOffset||o.scrollTop)-(o.clientTop||0),left:e.left+(h.pageXOffset||o.scrollLeft)-(o.clientLeft||0)}}},position:function(){var t,e,i={top:0,left:0};if("fixed"===this.style("position"))try{t=this.firstElement.getBoundingClientRect()}catch(s){t={top:0,left:0}}else t=this.offset(),e=l(this.firstElement),e.isNodeName("html")||(i=e.offset()),i.top+=n(e.style("border-top-width")),i.left+=n(e.style("border-left-width"));return{top:t.top-i.top-n(this.style("margin-top")),left:t.left-i.left-n(this.style("margin-left"))}},scrollLeft:function(t){return void 0===t?this.firstElement.scrollLeft:this.each(function(e,i){i.scrollLeft=t})},scrollTop:function(t){return void 0===t?this.firstElement.scrollTop:this.each(function(e,i){i.scrollTop=t})},prepend:function(t){return t=u(this.firstElement,t),this.each(function(e,i){i.insertBefore(t,i.firstChild)})},append:function(t){return t=u(this.firstElement,t),this.each(function(e,i){i.appendChild(t)})},before:function(t){return t=u(this.firstElement,t),this.each(function(e,i){var n=i.parentNode;n&&n.insertBefore(t,i)})},after:function(t){return t=u(this.firstElement,t),this.each(function(e,i){var n=new caph.dom.Element(i),s=i.parentNode;if(s){var o=n.next();o?s.insertBefore(t,o.firstElement):s.insertBefore(t,i)}})},wrap:function(t){return t=p(this.firstElement,t),this.each(function(e,i){var n=i.parentNode;n&&n.insertBefore(t,i),t.appendChild(i)})},unwrap:function(){return this.each(function(t,e){var i=new caph.dom.Element(e).parent();i&&(i.before(i.firstChild()),i.remove())})},remove:function(){this.each(function(t,e){var i=e.parentNode;i&&i.removeChild(e)})},clone:function(){var t=[];return this.each(function(e,i){t.push(i.cloneNode(!0))}),c(t)},each:function(t){if("function"!=typeof t)return this;for(var e=0;this.length>e&&t.call(this.$[e],e,this.$[e])!==!1;e++);return this.firstElement=this.$[0],this},eq:function(t){return t>-1&&this.length>t?new caph.dom.Element(this.$[t]):null},get:function(t){return void 0===t?this.$:t>-1&&this.length>t?this.$[t]:null},slice:function(t,e){(void 0===t||0>t)&&(t=0),(void 0===e||e>this.length)&&(e=this.length);for(var i=[],n=t;e>n;n++)i.push(this.$[n]);return c(i)},first:function(){return new caph.dom.Element(this.$[0])},last:function(){return new caph.dom.Element(this.$[this.length-1])},map:function(t){var e=[];return this.each(function(i,n){var s=t(i,n);s&&e.push(s)}),e},parent:function(t){var e=[],i=caph.isFunction(t),n=caph.isString(t);return this.each(function(s,o){var r=o.parentNode;r&&!g(e,r)&&(i?t(r)&&e.push(r):n?g(v(t,r.parentNode),r)&&e.push(r):e.push(r))}),c(e)},firstChild:function(){var t=[];return this.each(function(e,i){for(var n=i.firstElementChild||i.firstChild;n;){if(1===n.nodeType){t.push(n);break}n=n.nextSibling}}),c(t)},children:function(t){var e,i=[];if(caph.isString(t))return this.find(t);var n=caph.isFunction(t);return this.each(function(s,o){var r=o.childNodes;if(r)for(var a=0,h=r.length;h>a;a++)e=r[a],1===e.nodeType&&(n?t(e)&&i.push(e):i.push(e))}),c(i)},prev:function(t){var e=[],i=caph.isFunction(t),n=caph.isString(t);return this.each(function(s,o){do if(o=o.previousSibling,o&&1===o.nodeType){i?t(o)&&e.push(o):n?g(v(t,o.parentNode),o)&&e.push(o):e.push(o);break}while(o)}),c(e)},next:function(t){var e=[],i=caph.isFunction(t),n=caph.isString(t);return this.each(function(s,o){do if(o=o.nextSibling,o&&1===o.nodeType){i?t(o)&&e.push(o):n?g(v(t,o.parentNode),o)&&e.push(o):e.push(o);break}while(o)}),c(e)},siblings:function(t){var e=[],i=caph.isString(t),n=caph.isFunction(t);return this.each(function(s,o){var r=new caph.dom.Element(o).parent();r&&(i?r.find(t,function(t){t!=o&&e.push(t)}):r.children(function(i){return i==o?!1:n?t(i)?(e.push(i),!0):!1:(e.push(i),!0)}))}),c(e)},bind:function(t,e,i){return this.each(function(n,s){s.eventHandleManager||(s.eventHandleManager=new caph.dom.event.HandleManager),s.eventHandleManager.set(t,caph.dom.event.add(s,t,e,i))})},unbind:function(t){return void 0===t?this.each(function(t,e){e.eventHandleManager.types().forEach(function(t){i(e.eventHandleManager,t)})}):this.each(function(e,n){i(n.eventHandleManager,t)})},delegate:function(t,e,i){return caph.isString(i)?(this.find(i).each(function(i,n){n.eventHandleManager||(n.eventHandleManager=new caph.dom.event.HandleManager),n.eventHandleManager.set(t,caph.dom.event.add(n,t,e))}),this):this.each(function(n,s){s.eventHandleManager||(s.eventHandleManager=new caph.dom.event.HandleManager),s.eventHandleManager.set(t,caph.dom.event.add(s,t,e,i))})},undelegate:function(t,e){return t=caph.isBlank(t)?void 0:t,caph.isString(e)?(this.find(e).unbind(t),this):this.unbind(t)},trigger:function(t,e){return this.each(function(i,n){caph.dom.event.fire(n,t,e)})},find:function(t,e){var i=[],n=caph.isFunction(e);return this.each(function(s,o){var r=caph.dom.getElement(t,o);if(r)for(var a=0,h=r.length;h>a;a++){var c=r.$[a];n?e(c)&&i.push(c):i.push(c)}}),c(i)},equal:function(t){return t instanceof caph.dom.Element?e(this,t,function(t,e,i){return e==i.get(t)}):t.length?e(this,t,function(t,e,i){return e==i[t]}):this.length>1?!1:this.firstElement==t},isNodeName:function(t){return h(this.firstElement,t)},transform:function(){return new caph.animation.Transform(this.firstElement)}})}(this),function(t){"use strict";var e=new caph.dom.event.HandleManager;caph.namespace("caph.window",{attr:function(e,i){return void 0===i?t[e]:(t[e]=i,this)},removeAttr:function(e){return t[e]=null,this},width:function(){return t.innerWidth||t.document.documentElement.clientWidth||t.document.body.clientWidth},height:function(){return t.innerHeight||t.document.documentElement.clientHeight||t.document.body.clientHeight},outerWidth:function(){return t.outerWidth||this.width()},outerHeight:function(){return t.outerHeight||this.height()},scrollLeft:function(e){return void 0===e?t.pageXOffset||t.document.documentElement.scrollLeft:(t.scrollTo(e,t.pageYOffset||t.document.documentElement.scrollTop),this)},scrollTop:function(e){return void 0===e?t.pageYOffset||t.document.documentElement.scrollTop:(t.scrollTo(t.pageXOffset||t.document.documentElement.scrollLeft,e),this)},bind:function(i,n,s){return e.set(i,caph.dom.event.add(t,i,n,s)),this},unbind:function(t){var i=e.get(t);if(i){for(var n=0,s=i.length;s>n;n++)caph.dom.event.remove(i[n]);e.remove(t)}return this},trigger:function(e,i){return caph.dom.event.fire(t,e,i),this}})}(this),function(t){"use strict";var e=new caph.dom.event.HandleManager;caph.namespace("caph.document",{attr:function(e,i){return void 0===i?t.document[e]:(t.document[e]=i,this)},removeAttr:function(e){return t.document[e]=null,this},width:function(){return Math.max(t.document.body.offsetWidth,t.document.documentElement.offsetWidth,t.document.body.clientWidth)},height:function(){return Math.max(t.document.body.offsetHeight,t.document.documentElement.offsetHeight,t.document.body.clientHeight)},outerWidth:function(){return Math.max(t.document.body.scrollWidth,t.document.documentElement.scrollWidth)},outerHeight:function(){return Math.max(t.document.body.scrollHeight,t.document.documentElement.scrollHeight)},scrollLeft:function(e){return void 0===e?t.document.documentElement.scrollLeft:(t.document.documentElement.scrollLeft=e,this)},scrollTop:function(e){return void 0===e?t.document.documentElement.scrollTop:(t.document.documentElement.scrollTop=e,this)},bind:function(i,n,s){return e.set(i,caph.dom.event.add(t.document,i,n,s)),this},unbind:function(t){var i=e.get(t);if(i){for(var n=0,s=i.length;s>n;n++)caph.dom.event.remove(i[n]);e.remove(t)}return this},trigger:function(e,i){return caph.dom.event.fire(t.document,e,i),this}})}(this),function(){"use strict";var t={code:!0,type:!0,ctrl:!0,alt:!0,shift:!0,meta:!0},e={409:"power",10072:"source",10143:"hdmi",48:"n0",49:"n1",50:"n2",51:"n3",52:"n4",53:"n5",54:"n6",55:"n7",56:"n8",57:"n9",10200:"ttxMix",10190:"preCh",449:"mute",10073:"chList",447:"voldown",448:"volup",427:"chDown",428:"chUp",10071:"home",10133:"menu",458:"guide",10135:"tools",457:"info",37:"left",38:"up",39:"right",40:"down",13:"enter",10009:"return",10182:"exit",403:"red",404:"green",405:"yellow",406:"blue",412:"rewind",19:"pause",417:"ff",416:"rec",415:"play",413:"stop"};caph.namespace("caph.event.key",{setKeyMap:function(i){if(!caph.isEmpty(i)){var n;for(var s in i)if(t[n=i[s]])throw Error('IllegalArgumentError: The "'+n+'" is reserved. Please use another one.');e=caph.clone(i)}return this},getKeyMap:function(){return caph.clone(e)},getType:function(t){var i=e[t];return caph.isString(i)?i:"unknown"}})}(this),function(){"use strict";function t(t,e,i,n){caph.isBlank(i)||(caph.isBlank(n)?Object.defineProperty(t,e,{value:i}):Object.defineProperty(t,e,{value:i,configurable:caph.isBlank(n.configurable)?!0:n.configurable,enumerable:caph.isBlank(n.enumerable)?!0:n.enumerable,writable:caph.isBlank(n.writable)?!0:n.writable}))}function e(e,i,n){if(!caph.isBlank(e[i]))throw Error('IllegalStateError: The "'+i+'" property of "caph.event.Message" cannot be changed.');t(e,i,n,{configurable:!1,writable:!1})}$class({$namespace:"caph.event.Message",$constructor:function(e){if(caph.isBlank(e))throw Error('IllegalArgumentError: The "caph.event.Message" requires an object as the constructor parameter.');if(caph.isBlank(e.type)||!caph.isString(e.type))throw Error('IllegalArgumentError: The "caph.event.Message" constructor parameter object requires a string "type" property.');t(this,"type",e.type.toLowerCase(),{configurable:!1,writable:!1}),t(this,"source",e.target||e.srcElement||e.source,{configurable:!1,writable:!1}),t(this,"related",e.relatedTarget||e.related,{configurable:!1,writable:!1}),t(this,"bubbles",caph.isBlank(e.bubbles)?!0:e.bubbles,{configurable:!1,writable:!1}),t(this,"timeStamp",e.timeStamp||(new Date).getTime(),{configurable:!1,writable:!1}),this.detail=caph.clone(e.detail),this._propagationStopped=!1,e instanceof Event?t(this,"_event",e,{configurable:!1,enumerable:!1,writable:!1}):e._event instanceof Event&&t(this,"_event",e._event,{configurable:!1,enumerable:!1,writable:!1})},getType:function(){return this.type},setSource:function(t){e(this,"source",t)},getSource:function(){return this.source},setRelated:function(t){e(this,"related",t)},getRelated:function(){return this.related},isBubbles:function(){return this.bubbles},getTimeStamp:function(){return this.timeStamp},setDetail:function(t){this.detail=caph.clone(t)},getDetail:function(){return this.detail},stopPropagation:function(){this._propagationStopped=!0,this._event&&this._event.stopPropagation()},isPropagationStopped:function(){return this._propagationStopped},preventDefault:function(){this._event&&(this._event.preventDefault(),this._event.returnValue=!1)},key:function(){var t,e,i,n={};return(t=this.detail)&&(n.code=e=t.keyCode||t.which||t.charCode,n.type=i=caph.event.key.getType(e),n.ctrl=t.ctrlKey,n.alt=t.altKey,n.shift=t.shiftKey,n.meta=t.metaKey,n[i]=!0),n},mouse:function(){var t={},e=this.detail;return e&&(t.left=e.which?0===e.button:!!(1&e.button),t.middle=e.which?1===e.button:!!(4&e.button),t.right=e.which?2===e.button:!!(2&e.button),t.ctrl=e.ctrlKey,t.alt=e.altKey,t.shift=e.shiftKey,t.meta=e.metaKey,t.wheelDelta=e.wheelDelta?e.wheelDelta/120:e.detail?-e.detail/3:0,t.screenX=e.screenX,t.screenY=e.screenY,t.clientX=e.clientX,t.clientY=e.clientY,t.offsetX=e.offsetX,t.offsetY=e.offsetY,t.pageX=e.pageX,t.pageY=e.pageY),t}})}(this),function(){"use strict";function t(t){var e;return(e=n.exec(t))?e[0]:"custom"}function e(e){var i=t(e);switch(i){case"key":return["charCode","keyCode","keyIdentifier","keyLocation","location","which","ctrlKey","shiftKey","altGraphKey","altKey","metaKey","repeat","locale","key","code","char"];case"mouse":case"click":case"wheel":return["screenX","screenY","clientX","clientY","offsetX","offsetY","pageX","pageY","ctrlKey","shiftKey","altKey","metaKey","button","which","wheelDelta","detail","deltaMode","deltaX","deltaY","deltaZ"];case"input":return["data"];default:return null}}var i=null,n=/(?:^(?:key|mouse))|(?:(?:click|input)$)|(?:^wheel$)/;$class({$namespace:"caph.event.Normalizer",$constructor:function(){i?console.warn('Use "caph.event.Normalizer.getInstance()" instead of "new caph.event.Normalizer()".'):i=this},$statics:{getInstance:function(){return null===i&&(i=new caph.event.Normalizer),i}},toMessage:function(t){var i,n,s=new caph.event.Message(t),o=e(s.getType());if(o){i={};for(var r=0,a=o.length;a>r;r++)n=o[r],i[n]=t[n];s.setDetail(i)}else s.setDetail(t.detail);return s},createFrom:function(t,e){var i={type:t.type,source:t.source,related:t.related,bubbles:t.bubbles,timeStamp:t.timeStamp,detail:t.detail,_event:t._event};return caph.isObject(e)&&caph.extend(i,e),new caph.event.Message(i)}})}(this),function(){"use strict";$class({$namespace:"caph.math.Vector3",$constructor:function(t,e,i){t instanceof caph.math.Vector3?this.set(t.x,t.y,t.z):(this.x=t||0,this.y=e||0,this.z=i||0)},set:function(t,e,i){return this.x=void 0==t?this.x:t,this.y=void 0==e?this.y:e,this.z=void 0==i?this.z:i,this},get:function(){return[this.x,this.y,this.z]},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z;return t instanceof caph.math.Matrix4&&(t=t.get()),this.x=t[0]*e+t[4]*i+t[8]*n+t[12],this.y=t[1]*e+t[5]*i+t[9]*n+t[13],this.z=t[2]*e+t[6]*i+t[10]*n+t[14],this},clone:function(){return new caph.math.Vector3(this.x,this.y,this.z)},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},distance:function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return Math.sqrt(e*e+i*i+n*n)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},cross:function(t){var e=this.x,i=this.y,n=this.z;return this.x=i*t.z-n*t.y,this.y=n*t.x-e*t.z,this.z=e*t.y-i*t.x,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},normalize:function(){var t=this.length();return 0===t&&(t=1),this.multiplyScalar(1/t),this}})}(this),function(){"use strict";$class({$namespace:"caph.math.Vector4",$constructor:function(t,e,i,n){t instanceof caph.math.Vector4?this.set(t.x,t.y,t.z,t.w):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0)},set:function(t,e,i,n){return this.x=void 0===t?this.x:t,this.y=void 0===e?this.y:e,this.z=void 0===i?this.z:i,this.w=void 0===n?this.w:n,this},get:function(){return[this.x,this.y,this.z,this.w]},applyMatrix4:function(t){var e=[],i=4,n=4,s=1,o=this.get();t instanceof caph.math.Matrix4&&(t=t.get());for(var r=0;i>r;r++)for(var a=0;s>a;a++){e[r*s+a]=0;for(var h=0;n>h;h++)e[r*s+a]+=t[r*n+h]*o[h*s+a]}return this.x=e[0],this.y=e[1],this.z=e[2],this.w=e[3],this},clone:function(){return new caph.math.Vector4(this.x,this.y,this.z,this.w)},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},distance:function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z,s=this.w-t.w;return Math.sqrt(e*e+i*i+n*n+s*s)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},normalize:function(){var t=this.length();return 0===t&&(t=1),this.multiplyScalar(1/t),this},toVector3:function(){return new caph.math.Vector3(this.x,this.y,this.z)}})}(this),function(){"use strict";function t(t,e,i){return[1,0,0,0,0,1,0,0,0,0,1,0,t,e,i,1]}function e(t,e,i){return[t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1]}function i(t,e,i){var n=l*t,s=l*e,o=l*i,r=Math.sin(s),a=Math.sin(n),h=Math.sin(o),c=r*h,u=Math.cos(s),p=Math.cos(n),d=Math.cos(o),f=u*h,m=d*a;return[u*d+a*c,m*r-f,p*r,0,p*h,p*d,-a,0,f*a-d*r,c+u*m,u*p,0,0,0,0,1]}function n(t){var e=l*t,i=Math.sin(e),n=Math.cos(e);return[1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1]}function s(t){var e=l*t,i=Math.sin(e),n=Math.cos(e);return[n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1]}function o(t){var e=l*t,i=Math.sin(e),n=Math.cos(e);return[n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1]}function r(t,e,i,n){var s=new caph.math.Vector3(t,e,i).normalize(),o=l*n,r=Math.cos(o),a=Math.sin(o),h=1-r;return[s.x*s.x*h+r,s.x*s.y*h+s.z*a,s.x*s.z*h-s.y*a,0,s.y*s.x*h-s.z*a,s.y*s.y*h+r,s.y*s.z*h+s.x*a,0,s.z*s.x*h+s.y*a,s.z*s.y*h-s.x*a,s.z*s.z*h+r,0,0,0,0,1]}function a(t,e){return[1,Math.tan(e*l),0,0,Math.tan(t*l),1,0,0,0,0,1,0,0,0,0,1]}function h(t,e){var i=[],n=t[0],s=t[4],o=t[8],r=t[12],a=t[1],h=t[5],c=t[9],l=t[13],u=t[2],p=t[6],d=t[10],f=t[14],m=t[3],_=t[7],g=t[11],v=t[15],y=e[0],I=e[4],T=e[8],b=e[12],E=e[1],S=e[5],w=e[9],C=e[13],O=e[2],x=e[6],M=e[10],P=e[14],A=e[3],N=e[7],L=e[11],R=e[15];return i[0]=n*y+s*E+o*O+r*A,i[4]=n*I+s*S+o*x+r*N,i[8]=n*T+s*w+o*M+r*L,i[12]=n*b+s*C+o*P+r*R,i[1]=a*y+h*E+c*O+l*A,i[5]=a*I+h*S+c*x+l*N,i[9]=a*T+h*w+c*M+l*L,i[13]=a*b+h*C+c*P+l*R,i[2]=u*y+p*E+d*O+f*A,i[6]=u*I+p*S+d*x+f*N,i[10]=u*T+p*w+d*M+f*L,i[14]=u*b+p*C+d*P+f*R,i[3]=m*y+_*E+g*O+v*A,i[7]=m*I+_*S+g*x+v*N,i[11]=m*T+_*w+g*M+v*L,i[15]=m*b+_*C+g*P+v*R,i}function c(t,e){var i=e[0],n=e[1],s=e[2],o=e[3],r=e[4],a=e[5],h=e[6],c=e[7],l=e[8],u=e[9],p=e[10],d=e[11],f=[1,0,0,0,0,1,0,0,0,0,1,0,t[12]+e[12],t[13]+e[13],t[14]+e[14],1],m=t[0],_=t[1],g=t[2];return f[0]=m*i+_*r+g*l,f[1]=m*n+_*a+g*u,f[2]=m*s+_*h+g*p,f[3]=m*o+_*c+g*d,m=t[4],_=t[5],g=t[6],f[4]=m*i+_*r+g*l,f[5]=m*n+_*a+g*u,f[6]=m*s+_*h+g*p,f[7]=m*o+_*c+g*d,m=t[8],_=t[9],g=t[10],f[8]=m*i+_*r+g*l,f[9]=m*n+_*a+g*u,f[10]=m*s+_*h+g*p,f[11]=m*o+_*c+g*d,f}var l=Math.PI/180;$class({$namespace:"caph.math.Matrix4",$constructor:function(t){caph.isBlank(t)?this.identity():this.set(t)},$statics:{translate:function(e,i,n){return new caph.math.Matrix4(t(e,i,n))},scale:function(t,i,n){return new caph.math.Matrix4(e(t,i,n))},rotateXYZ:function(t,e,n){return new caph.math.Matrix4(i(t,e,n))},rotateX:function(t){return new caph.math.Matrix4(n(t))},rotateY:function(t){return new caph.math.Matrix4(s(t))},rotateZ:function(t){return new caph.math.Matrix4(o(t))},rotateAxis:function(t,e,i,n){return new caph.math.Matrix4(r(t,e,i,n))},skewXY:function(t,e){return new caph.math.Matrix4(a(t,e))},multiply:function(t,e){return t instanceof caph.math.Matrix4&&(t=t.get()),e instanceof caph.math.Matrix4&&(e=e.get()),new caph.math.Matrix4(c(t,e))},multiplyMatrix:function(t,e){return t instanceof caph.math.Matrix4&&(t=t.get()),e instanceof caph.math.Matrix4&&(e=e.get()),new caph.math.Matrix4(h(t,e))}},set:function(t){return caph.isArray(t)&&16===t.length&&(this.matrix=t),this},get:function(){return this.matrix},clone:function(){return new caph.math.Matrix4(this.get().slice(0))},identity:function(){return this.set([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},multiply:function(t){return this.set(c(this.get(),t instanceof caph.math.Matrix4?t.get():t))},multiplyMatrix:function(t){return this.set(h(this.get(),t instanceof caph.math.Matrix4?t.get():t))},translate:function(e,i,n){return this.set(t(e,i,n))},transpose:function(){for(var t=[],e=4,i=0;this.matrix.length>i;i++)t.push(this.matrix[i%e*e+Math.floor(i/e)]);return this.set(t)},scale:function(t,i,n){return this.set(e(t,i,n))},rotateXYZ:function(t,e,n){return this.set(i(t,e,n))},rotateX:function(t){return this.set(n(t))},rotateY:function(t){return this.set(s(t))},rotateZ:function(t){return this.set(o(t))},rotateAxis:function(t,e,i,n){return this.set(r(t,e,i,n))},skewXY:function(t,e){return this.set(a(t,e))}})}(this),function(){"use strict";function t(t){var e=caph.dom._style.get(t,"transform")||caph.dom._style.get(t,"-webkit-transform"),n=i.exec(e);return n&&17===n.length?new caph.math.Matrix4(n.slice(1).map(function(t){return 1*t})):null}function e(t){return 1*caph.dom._style.get(t,"opacity")}var i=/matrix3d\s*\(\s*([\d\.\+\-e]+)\s*,\s*([\d\.\+\-e]+)\s*,\s*([\d\.\+\-e]+)\s*,\s*([\d\.\+\-e]+)\s*,\s*([\d\.\+\-e]+)\s*,\s*([\d\.\+\-e]+)\s*,\s*([\d\.\+\-e]+)\s*,\s*([\d\.\+\-e]+)\s*,\s*([\d\.\+\-e]+)\s*,\s*([\d\.\+\-e]+)\s*,\s*([\d\.\+\-e]+)\s*,\s*([\d\.\+\-e]+)\s*,\s*([\d\.\+\-e]+)\s*,\s*([\d\.\+\-e]+)\s*,\s*([\d\.\+\-e]+)\s*,\s*([\d\.\+\-e]+)\s*\)/;caph.namespace("caph.animation.util",{getCurrentMatrix:function(e){return e?e._caphCurrentMatrix||t(e)||new caph.math.Matrix4:new caph.math.Matrix4},getCurrentOpacity:function(t){return t?t._caphCurrentOpacity||e(t):1},setCurrentMatrix:function(t,e){t&&e&&(t._caphCurrentMatrix=e)},setCurrentOpacity:function(t,e){t&&!caph.isBlank(e)&&(t._caphCurrentOpacity=e)},initCurrentMatrix:function(t){t&&(t._caphCurrentMatrix=null)},initCurrentOpacity:function(t){t&&(t._caphCurrentOpacity=null)}})}(this),function(){"use strict";function t(t,e,i,n){return["cubic-bezier("+t+","+e+","+i+","+n+")",function(t){var i=1-t,s=3*i,o=t*t,r=o*t,a=s*t*i,h=s*o;return a*e+h*n+r}]}var e=/cubic-bezier\s*\(\s*([\d\.]+)\s*,\s*([\d\.]+)\s*,\s*([\d\.]+)\s*,\s*([\d\.]+)\s*\)/;caph.namespace("caph.animation.ease",{linear:["linear",function(t){return t}],cubicBezier:t,ease:t(.25,.1,.25,1),easeOut:t(0,0,.58,1),easeInOut:t(.42,0,.58,1),easeIn:t(.42,0,1,1),sineIn:t(.47,0,.745,.715),sineOut:t(.39,.575,.565,1),sineInOut:t(.445,.05,.55,.95),quadIn:t(.55,.085,.68,.53),quadOut:t(.25,.46,.45,.94),quadInOut:t(.455,.03,.515,.955),cubicIn:t(.55,.055,.675,.19),cubicOut:t(.215,.61,.355,1),cubicInOut:t(.645,.045,.355,1),quartIn:t(.895,.03,.685,.22),quartOut:t(.165,.84,.44,1),quartInOut:t(.77,0,.175,1),quintIn:t(.755,.05,.855,.06),quintOut:t(.23,1,.32,1),quintInOut:t(.86,0,.07,1),expoIn:t(.95,.05,.795,.035),expoOut:t(.19,1,.22,1),expoInOut:t(1,0,0,1),circIn:t(.6,.04,.98,.335),circOut:t(.075,.82,.165,1),circInOut:t(.785,.135,.15,.86),backIn:t(.6,-.28,.735,.045),backOut:t(.175,.885,.32,1.275),backInOut:t(.68,-.55,.265,1.55),add:function(t,e){return this[t]=[null,e],this},match:function(t){return this[t]||this[caph.toCamelCase(t)]},normalize:function(t){var i;if(caph.isString(t)){if(i=e.exec(t.toLowerCase()))return this.cubicBezier(i[1],i[2],i[3],i[4]);if(i=this.match(t))return i}else{if(caph.isFunction(t))return[null,t];if(caph.isArray(t)&&2===t.length&&caph.isFunction(t[1]))return t}return this.linear}}),caph.animation.ease.add("bounceOut",function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}),caph.animation.ease.add("bounceIn",function(t){return 1-caph.animation.ease.bounceOut[1](1-t)}),caph.animation.ease.add("bounceInOut",function(t){return.5>t?.5*caph.animation.ease.bounceIn[1](2*t):.5*caph.animation.ease.bounceOut[1](2*t-1)+.5});var i=2*Math.PI,n=.3/i*Math.asin(1);caph.animation.ease.add("elasticIn",function(t){return 0===t||1===t?t:-(Math.pow(2,10*(t-=1))*Math.sin((t-n)*i/.3))
}),caph.animation.ease.add("elasticOut",function(t){return 0===t||1===t?t:Math.pow(2,-10*t)*Math.sin((t-n)*i/.3)+1}),caph.animation.ease.add("elasticInOut",function(t){return 1>(t*=2)?-.5*Math.pow(2,10*(t-=1))*Math.sin((t-n)*i/.3):.5*Math.pow(2,-10*(t-=1))*Math.sin((t-n)*i/.3)+1})}(this),function(){"use strict";caph.namespace("caph.animation.transition",{bypass:function(){var t=new caph.math.Matrix4;return function(){return t}},moveCubicBezier:function(t,e,i,n,s,o,r,a,h){return function(c){var l=1-c,u=3*l,p=c*c,d=u*l,f=u*c;return caph.math.Matrix4.translate((d*t+f*n+p*r)*c,(d*e+f*s+p*a)*c,(d*i+f*o+p*h)*c)}},move:function(t,e,i){return function(n){return caph.math.Matrix4.translate(t*n,e*n,i*n)}},scale:function(t,e,i){return function(n){return caph.math.Matrix4.scale(1+(t-1)*n,1+(e-1)*n,1+(i-1)*n)}},skewXY:function(t,e){return function(i){return caph.math.Matrix4.skewXY(t*i,e*i)}},rotateXYZ:function(t,e,i){return function(n){return caph.math.Matrix4.rotateXYZ(t*n,e*n,i*n)}},rotateX:function(t){return function(e){return caph.math.Matrix4.rotateX(t*e)}},rotateY:function(t){return function(e){return caph.math.Matrix4.rotateY(t*e)}},rotateZ:function(t){return function(e){return caph.math.Matrix4.rotateZ(t*e)}},rotateAxis:function(t,e,i,n){return function(s){return caph.math.Matrix4.rotateAxis(t,e,i,n*s)}},opacity:function(t,e){return function(i){return t+(e-t)*i}},flicker:function(t,e){return function(i){return 1>i&&i>0?t+(e-t)*Math.random():1}},fadeInOutIn:function(t,e){return function(i){var n,s;return.5>i?(n=e,s=t):(i-=.5,n=t,s=e),n+2*(s-n)*i}},fadeOutInOut:function(t,e){return function(i){var n,s;return.5>i?(n=t,s=e):(i-=.5,n=e,s=t),n+2*(s-n)*i}}})}(this),function(){"use strict";var t={transition:caph.animation.transition.bypass(),ease:caph.animation.ease.linear,opacity:null,delay:0,duration:.1,callback:null,asyncCallback:!1,multiply:!0,useTransform:!1};$class({$namespace:"caph.animation.Timeline",$constructor:function(t){this.initialMatrix=new caph.math.Matrix4,this.initialOpacity=null,this.currentMatrix=this.initialMatrix,this.currentOpacity=this.initialOpacity,this.timeline=[],this.currentTimeline=null,this.timelineIndex=[],this.setSeekInterval(caph.isBlank(t)?500:t),this.setStartTime(0),this.totalDuration=0},setSeekInterval:function(t){return this.seekInterval=t,this},getSeekInterval:function(){return this.seekInterval},add:function(e){var i,n=this.timeline.length;return e=caph.mixin(t,e),e.ease=caph.animation.ease.normalize(e.ease),e._startTime=this.totalDuration,e._endTime=e._startTime+e.duration+e.delay,caph.isBlank(i=e.opacity)||(caph.isNumber(i)?this.currentOpacity=i:caph.isFunction(i)&&(this.currentOpacity=i(1))),this.timeline.push(e),this._calculateTimeline(n),this._createTimelineIndex(e._startTime,e._endTime,n),this.totalDuration=e._endTime,this.currentMatrix=e._finalMatrix,this},seek:function(t){var e=this._getTimelineByTime(t-this.getStartTime()),i=!1;if(this.currentTimeline!==e&&(this._onAnimationEnd(this.currentTimeline),this.currentTimeline=e,i=!0),e){var n=e._progress,s=e.ease[1](n),o={progress:n,_change:i};if(1===n?this._onAnimationEnd(e):e.finish&&(e.finish=!1),caph.isFunction(e.transition)){var r=e.transition(s);o.matrix=e.multiply?caph.math.Matrix4.multiply(e._initialMatrix,r):r}return o.opacity=e.opacity,o}return null},getTotalDuration:function(){return this.totalDuration},setStartTime:function(t){return this.startTime=t,this},getStartTime:function(){return this.startTime},clear:function(){return this.timeline=[],this.currentTimeline=null,this.timelineIndex=[],this},_createTimelineIndex:function(t,e,i){for(var n=this._getIndexOfTimelineIndexByTime(t),s=this._getIndexOfTimelineIndexByTime(e);s>=n;n++)caph.isArray(this.timelineIndex[n])?this.timelineIndex[n].push(i):this.timelineIndex[n]=[i];return this},_getIndexOfTimelineIndexByTime:function(t){return Math.floor(t/this.getSeekInterval())},_calculateTimeline:function(t){var e=this.timeline[t];if(t>0){var i=this.timeline[t-1];e._initialMatrix=i._finalMatrix,e._initialOpacity=i._finalOpacity}else e._initialMatrix=this.initialMatrix,e._initialOpacity=this.initialOpacity;return e._finalMatrix=caph.isFunction(e.transition)?e.multiply?caph.math.Matrix4.multiply(e._initialMatrix,e.transition(1)):e.transition(1):e._initialMatrix,e._finalOpacity=caph.isFunction(e.opacity)?e.opacity(1):caph.isNumber(e.opacity)?e.opacity:e._initialOpacity,this},_getTimelineByTime:function(t){if(t>=0&&this.totalDuration>=t){var e=this.timelineIndex[this._getIndexOfTimelineIndexByTime(t)];if(e)for(var i=0,n=e.length;n>i;i++){var s=this.timeline[e[i]];if(t>=s._startTime&&s._endTime>=t)return s._progress=s.duration?(t-s._startTime-s.delay)/s.duration:1,s._progress=s._progress>1?1:0>s._progress?0:s._progress,s}}return null},_onAnimationEnd:function(t){t&&caph.isFunction(t.callback)&&!t.finish&&(t.finish=!0,t.asyncCallback?setTimeout(function(t){return function(){t()}}(t.callback),0):t.callback())}})}(this),function(t){"use strict";function e(t,e){var i=t.id;if(caph.isBlank(i)&&(t.id=i="_caph_timeline_"+t.tagName+"_"+Date.now()+"_"+1e3*Math.random()),caph.isArray(e)||(e=[e]),this.timelines[i])this.timelines[i]=this.timelines[i].concat(e);else{var n=caph.animation.util.getCurrentMatrix(t),s=caph.animation.util.getCurrentOpacity(t);this.matrixMap[i]={element:t,initialMatrix:n,initialOpacity:s,startMatrix:n,startOpacity:s,nextMatrix:n,nextOpacity:s},this.timelines[i]=e}}t.requestAnimationFrame=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame,$class({$namespace:"caph.animation.Player",$constructor:function(){this.timelines={},this.matrixMap={},this.playing=!1,this.totalDuration=0,this.direction=caph.animation.Player.FORWARD,this.speed=1,this.repeat=1,this._currentRepeat=1,this._onfinish=null},$statics:{FORWARD:0,REVERSE:1,INFINITE:-1},add:function(t,i){var n=this;return t instanceof caph.dom.Element?t.each(function(t,s){e.call(n,s,i)}):e.call(n,t,i),this},setSpeed:function(t){return this.speed=t,this},setRepeat:function(t){return this.repeat=t,this._currentRepeat=t,this},onfinish:function(t){return caph.isFunction(t)&&(this._onfinish=t),this},isPlaying:function(){return this.playing},play:function(t){return this.playing||(this.playing=!0,this.startTime=performance.now(),this.direction=t||caph.animation.Player.FORWARD,this.pauseTime=null,this._currentRepeat=this.repeat,this._startAnimation()),this},stop:function(){return this.playing&&(this.playing=!1,this.pauseTime=performance.now()-(this.startTime||0),this.pauseDirection=this.direction,this._applyAnimation(this.pauseTime)),this},seek:function(t){return this.stop(),this.direction=caph.animation.Player.FORWARD,this._calculateTotalDuration(),this._applyAnimation(this.totalDuration*(t>1?1:0>t?0:t)),this},resume:function(){return this.playing||(this.playing=!0,this.startTime=performance.now()-(this.pauseTime||0),this.direction=this.pauseDirection||caph.animation.Player.FORWARD,this._startAnimation()),this},clear:function(){return this.seek(0),this._initElement(),this.timelines={},this.matrixMap={},this.totalDuration=0,this},_applyAnimation:function(t){var e=!1;this.direction===caph.animation.Player.REVERSE&&(t=this.totalDuration-t);for(var i in this.timelines){var n=this.matrixMap[i],s=this._seekAnimationById(i,t,n.startOpacity);s&&(s.matrix&&this._setTransformMatrix(n.element,n.nextMatrix=caph.math.Matrix4.multiply(n.startMatrix,s.matrix)),s.change?n.startOpacity=n.nextOpacity:caph.isBlank(s.opacity)||this._setOpacity(n.element,n.nextOpacity=s.opacity),t===this.totalDuration&&(this._setCurrentAnimation(n.element,n.nextMatrix,n.nextOpacity),n.startOpacity=n.nextOpacity),s.playing&&(e=!0))}return e},_setTransformMatrix:function(t,e){var i=this._getTransformMatrix(e.get());caph.dom._style.set(t,"transform",i),caph.dom._style.set(t,"-webkit-transform",i)},_getTransformMatrix:function(t){var e=[];return t.forEach(function(t){e.push(1e-6>Math.abs(t)?0:t)}),"matrix3d("+e.join(", ")+")"},_setOpacity:function(t,e){caph.dom._style.set(t,"opacity",e)},_setCurrentAnimation:function(t,e,i){caph.animation.util.setCurrentMatrix(t,e),caph.animation.util.setCurrentOpacity(t,i)},_seekAnimationById:function(t,e,i){var n,s=this.timelines[t],o=!1,r=!1;if(s)for(var a=new caph.math.Matrix4,h=null,c=0,l=s.length;l>c;c++){var u=s[c].getTotalDuration();u>e?(n=s[c].seek(e),this.direction===caph.animation.Player.FORWARD?o=!0:this.direction===caph.animation.Player.REVERSE&&e>0&&(o=!0)):n=s[c].seek(u),n&&(r=n._change,n.matrix&&a.multiply(n.matrix),caph.isBlank(n.opacity)||(caph.isNull(h)&&(h=1),caph.isNumber(n.opacity)?h*=caph.animation.transition.opacity(i,n.opacity)(n.progress):caph.isFunction(n.opacity)&&(h=n.opacity(n.progress))))}return{matrix:a,opacity:h,playing:o,change:r}},_startAnimation:function(){this._calculateTotalDuration(),t.requestAnimationFrame(this._step.bind(this))},_calculateTotalDuration:function(){for(var t in this.timelines)for(var e=this.timelines[t],i=0,n=e.length;n>i;i++){var s=e[i].getTotalDuration();s>this.totalDuration&&(this.totalDuration=s)}},_step:function(){if(this.playing){var e=(performance.now()-this.startTime)*this.speed;this._applyAnimation(e)?t.requestAnimationFrame(this._step.bind(this)):(this._calculateTotalDuration(),e>this.totalDuration&&this._applyAnimation(this.totalDuration),this.pauseTime=null,this.repeat===caph.animation.Player.INFINITE||--this._currentRepeat>0?(this.startTime=performance.now(),this._startAnimation()):(this.playing=!1,this._currentRepeat=this.repeat,this._onfinish&&this._onfinish()))}},_initElement:function(){for(var t in this.matrixMap)if(this.matrixMap.hasOwnProperty(t)){var e=this.matrixMap[t],i=e.element,n=e.initialMatrix,s=e.initialOpacity;this._setTransformMatrix(i,n),this._setOpacity(i,s),this._setCurrentAnimation(i,n,s)}}})}(this),function(){"use strict";$class({$namespace:"caph.animation.Transform",$constructor:function(t){this.element=t,this.multiply=!0,this._initVariables(),this._initAnimation()},setEase:function(t){return caph.isBlank(t)||(this._ease=t),this},setOpacity:function(t){return caph.isBlank(t)||(this._opacity=t),this},setDuration:function(t){return caph.isBlank(t)||(this._duration=.1>t?.1:t),this},setMultiply:function(t){return this._addToTimeline(),this.multiply=t,this},rotate:function(t,e,i,n,s,o){return this._addAnimation(caph.animation.transition.rotateXYZ(t,e,i),n,s,o)},rotateX:function(t,e,i,n){return this._addAnimation(caph.animation.transition.rotateX(t),e,i,n)},rotateY:function(t,e,i,n){return this._addAnimation(caph.animation.transition.rotateY(t),e,i,n)},rotateZ:function(t,e,i,n){return this._addAnimation(caph.animation.transition.rotateZ(t),e,i,n)},rotateAxis:function(t,e,i,n,s,o,r){return this._addAnimation(caph.animation.transition.rotateAxis(t,e,i,n),s,o,r)},move:function(t,e,i,n,s,o){return this._addAnimation(caph.animation.transition.move(t,e,i),n,s,o)},scale:function(t,e,i,n,s,o){return this._addAnimation(caph.animation.transition.scale(t,e,i),n,s,o)},skewXY:function(t,e,i,n,s){return this._addAnimation(caph.animation.transition.skewXY(t,e),i,n,s)},opacity:function(t,e,i){var n=new caph.math.Matrix4;return this._addAnimation(function(){return n},e,i,t)},delay:function(t){return caph.isBlank(t)||(this._addToTimeline(),this._delay+=t),this},callback:function(t,e){return caph.isFunction(t)&&(this._callback=t,this._asyncCallback=caph.isBlank(e)?!1:e,this._addToTimeline(!0)),this},set:function(){return this._addToTimeline(!0),this._initPlayer().seek(1),this},start:function(t){this._addToTimeline(!0);var e=this._initPlayer();return e.isPlaying()||e.setRepeat(caph.isBlank(t)?1:t).play(),this},stop:function(){return this._initPlayer().stop(),this},resume:function(){return this._initPlayer().resume(),this},clear:function(){return this._initPlayer().clear(),this._initVariables(),this._initAnimation(),this},_initVariables:function(){this.timeline=[new caph.animation.Timeline],this.player=null},_initAnimation:function(){this._transition=caph.animation.transition.bypass(),this._ease=caph.animation.ease.linear,this._opacity=null,this._delay=0,this._duration=.1,this._callback=null,this._asyncCallback=!1,this._begin=!1},_addAnimation:function(t,e,i,n){return this._addToTimeline(),this._transition=t,this.setEase(i),this.setOpacity(n),this.setDuration(e),this._begin=!0,this},_addToTimeline:function(t){return(this._begin||t)&&(this.timeline[0].add({transition:this._transition,ease:this._ease,opacity:this._opacity,delay:this._delay,duration:this._duration,callback:this._callback,asyncCallback:this._asyncCallback,multiply:this.multiply}),this._initAnimation()),this},_initPlayer:function(){return this.player||(this.player=new caph.animation.Player,this.player.add(this.element,this.timeline)),this.player}})}(this),function(t){"use strict";function e(t){var e,i=new XMLHttpRequest;return"string"==typeof o.path?(e=o.path+t.split(".").join("/")+".js",i.open("GET",e,!1),i.onerror=function(){console.error(i.statusText)},i.send(null),""!=i.response?i.response:void 0):void 0}function i(t,e){for(var i=t.split("."),s=0,o=i.length;o>s&&void 0!==e[i[s]];s++){if(s==i.length-1)return n[t]=e[i[s]],n[t];e=e[i[s]]}return void 0}var n={},s={},o={};s=function(t,r){var a,h,c,l;return"string"!=typeof t?void 0:n[t]?n[t]:(r=r||s._baseNamespace,a=i(t,r),void 0==a?o.path&&(h=e(t),void 0!=h)?(c=document.getElementsByTagName("head")[0],l=document.createElement("script"),l.setAttribute("type","text/javascript"),l.innerHTML=h,c.appendChild(l),a=i(t,r)):void 0:a)},s._baseNamespace=t.caph,s.config=function(t){t&&(o.path=t.path||"/")},caph.namespace("caph",{require:s})}(this),function(){"use strict";caph.namespace("caph.pattern",{singleton:function(t,e){var i={};return e=e||"getInstance",i[e]=function(){return void 0===this._singleton&&(this._singleton=new t),this._singleton},i}})}(),function(){$class({$namespace:"caph.pattern.PubSub",$constructor:function(){this.listeners=[]},on:function(t,e){var i;return this.listeners[t]||(this.listeners[t]=[]),i=this.listeners[t].indexOf(e),-1===i&&(i=this.listeners[t].push(e)-1),{fire:function(e){this.listeners[t][i]&&this.listeners[t][i](e)}.bind(this)}},off:function(t,e){var i;this.listeners[t]&&(i=this.listeners[t].indexOf(e),-1!==i&&this.listeners[t].splice(i,1))},fire:function(t,e){if(this.listeners[t])for(var i in this.listeners[t])this.listeners[t][i](e,t)}})}(),function(t){var e=caph.require("pattern.PubSub"),i=$class({$extends:e,$constructor:function(){this.$super(),this.isRunning=!1,this.lastTimeStamp=null,this.fps=null},$statics:{Topic:{UPDATE:"looper.update"}},on:function(t){return this.$super(i.Topic.UPDATE,t)},off:function(t){return this.$super(i.Topic.UPDATE,t)},_run:function(){if(this.isRunning===!1){var e=this;this.lastTimeStamp=t.performance.now(),function i(n){e._tick(n),t.requestAnimationFrame(i)}(this.lastTimeStamp),this.isRunning=!0}},_tick:function(t){var e=t-this.lastTimeStamp;this.fire(i.Topic.UPDATE,e),this.lastTimeStamp=t}});caph.namespace("caph.util",{Looper:{getInstance:function(){return void 0===this._looper&&(this._looper=new i,this._looper._run()),this._looper}}})}(this),function(){var t=$class({$namespace:"caph.collection.Map",$constructor:function(){this._mapKeyValue=new WeakMap,this._mapValueKey=new WeakMap},set:function(t,e){if(!t||!e)throw Error("null or undefined can't be a key or a value.");if("object"!=typeof t)throw Error("key should be an object.");return this._mapKeyValue.set(t,e),this._mapValueKey.set(e,t),e},get:function(t){if(!t)throw Error("null or undefined can't be a key.");if("object"!=typeof t)throw Error("key should be an object.");return this._mapKeyValue.get(t)},getKeyByValue:function(t){return this._mapValueKey.get(t)},"delete":function(t){var e;if("object"!=typeof t)throw Error("key should be an object.");e=this._mapKeyValue.get(t),this._mapKeyValue.delete(t),this._mapValueKey.delete(e)}});t.prototype._shared={id:1}}(this),function(){var t=$class({$namespace:"caph.collection.TreeNode",$constructor:function(){this._parent=null,this._children=[]},destroy:function(){var t;if(null!=this._parent){var e=this._parent._children.indexOf(this);e>=0&&this._parent._children.splice(e,1)}for(;t=this._children.pop();)t.destroy();this._parent=null,this._children=[]},addChild:function(e,i){var n,s=[].concat(e);if(!(e instanceof t||caph.isArray(e)))throw Error("the given node, "+e+", is invalid");for(var o=0,r=s.length;r>o;o++){if(n=s[o],n._parent&&n._parent==this._parent)return this;null!=n._parent&&n._parent.removeChild(n),this._children.push(n),n._parent=this,i&&i.callback&&i.callback(n)}return this},_insertBefore:function(e,i,n){var s,o=this._children.indexOf(i),r=[].concat(e);if(caph.isBlank(i)&&(this.addChild(e),o=0,r=[]),0>o)throw Error("The second argument is not a child of "+this+" node.");for(var a=0,h=r.length;h>a;a++)s=r[a],s instanceof t&&(null!==s._parent&&s._parent.removeChild(s),o=this._children.indexOf(i),this._children.splice(o,0,s),s._parent=this,n&&n.callback&&n.callback(s,i));return this},_nextSibling:function(){var t,e,i=null;return null!==this._parent&&(t=this._parent._children,e=t.indexOf(this),e!==t.length-1&&(i=t[e+1])),i},addTo:function(e){if(!(e instanceof t||caph.isArray(e)))throw Error("the given node, "+e+", is invalid");return e.addChild(this),this},removeChild:function(e,i){var n,s=[].concat(e);if(!e instanceof t)throw Error("the given node, "+e+", is invalid");for(var o=0,r=s.length;r>o;o++)if(n=s[o],i&&i.destroy===!0)n.destroy();else{var a=this._children.indexOf(n);a>=0&&(this._children.splice(a,1),n._parent=null,i&&i.callback&&i.callback(n))}return this},removeFromParent:function(){return null!=this._parent&&this._parent.removeChild(this,{destroy:!1}),this},getParent:function(){return this._parent},getChildren:function(){return this._children},getSiblings:function(){var t=[];if(null!=this._parent)for(var e=0;this._parent._children.length>e;e++)this._parent._children[e]!==this&&t.push(this._parent._children[e]);return t},getRoot:function(){var t,e=this;do t=e.getParent(),e=t?t:e;while(t);return e},hasChild:function(){return 0!==this._children.length}})}(this),function(){"use strict";$class({$namespace:"caph.storage.LocalStorage",$constructor:function(){this._prefix=null},remove:function(t){localStorage.removeItem(this._buildItemKey(t))},clearAll:function(){localStorage.clear()},get:function(t){var e=localStorage.getItem(this._buildItemKey(t));return e?e:!1},set:function(t,e){localStorage.setItem(this._buildItemKey(t),e)},getPrefix:function(){return this._prefix},setPrefix:function(t){this._prefix=t},_buildItemKey:function(t){return void 0===this._prefix||null===this._prefix?t:this._prefix+"."+t}})}(this),function(){"use strict";var t=null,e=["ko","en","bg","hr","cs","da","nl","fi","fr","de","el","hu","it","no","pl","pt","ro","ru","sr","sk","es","sv","tr","hi","et","lv","lt","ar","fa","th","he","id","vi","ur","af","zu","xh","yo","ig","ha","sw","am","ta","lt","lv","sl","sq","uk","kk","mk","ms","cy","gd","es_US","en_GB","fr_US","pt_US","zh-CN","zh-HK","zh-TW"],i="/nls/";$class({$namespace:"caph.base.resource.Language",$constructor:function(){if(t)throw Error(_this.errorMessage("SINGLE_INSTANCE"));t=this},$statics:{getInstance:function(){return null===t&&(t=new caph.base.resource.Language),t}},getSupportLanguageCodeSet:function(){var t=this._supportLanguageCodeSet;return caph.isArray(t)&&0==t.length&&(t=void 0),t},setCurrentLanguageCode:function(t){if(!this._contains(e,t))throw Error(this._errorMessage("NOT_ISO_CODE"));if(!this._contains(this._supportLanguageCodeSet,t))throw Error(this._errorMessage("NOT_SET_SUPPORT"));this._currentLanguageCode=t,this._removeLanguageMessage()},getCurrentLanguageCode:function(){return this._currentLanguageCode},isUseLanguage:function(){return this.getCurrentLanguageCode()?!0:!1},setLanguage:function(t,e){this._setSupportLanguageCodeSet(t),this.setCurrentLanguageCode(e),this._removeLanguageMessage()},getMessage:function(){if(!this.isUseLanguage)return{};if(!this._supportLanguageCodeSet)throw Error(this._errorMessage("BLANK_SET_SUPPORT"));if(!this._currentLanguageCode)throw Error(this._errorMessage("BLANK_THIS_LANGUAGE"));if(!this._languageMessage){var t=i+this.getCurrentLanguageCode()+".json",e=this._getXHR(t);if(null===e)throw Error(this._errorMessage("NOT_READ_NLS"));this._languageMessage=JSON.parse(e)}return this._languageMessage},_setSupportLanguageCodeSet:function(t){if(!caph.isArray(t))throw Error(this._errorMessage("MUST_ARRAY"));if(!this._contains(e,t))throw Error(this._errorMessage("NOT_ISO_CODE"));this._supportLanguageCodeSet=t,this._removeLanguageMessage("SUPPORT_SET")},_removeLanguageMessage:function(t){"SUPPORT_SET"==t&&(this._currentLanguageCode=void 0),this._languageMessage=void 0},_getXHR:function(t){var e=new XMLHttpRequest;if(t+="?t="+(new Date).getTime(),e.open("GET",t,!1),e.send(null),404===e.status)throw Error(this._errorMessage("NOT_READ_NLS"));if(4===e.readyState){if(e.responseText.length>0)return e.responseText;throw Error(this._errorMessage("NOT_READ_NLS"))}throw Error(this._errorMessage("NOT_READ_NLS"))},_contains:function(t,e){if(caph.isBlank(t)||caph.isBlank(e))return!1;if(!caph.isArray(e))return t.indexOf(e)>-1;for(var i=0;e.length>i;i++)if(-1==t.indexOf(e[i]))return!1;return!0},_errorMessage:function(t){switch(t){case"SINGLE_INSTANCE":return'IllegalStateError: The "caph.base.resource.Language" must exist only one instance. Use "caph.base.resource.Language.getInstance()" instead of "new caph.base.resource.Language()".';case"NOT_ISO_CODE":return"IllegalArgumentError: Must value is ISO_CODE.";case"NOT_SET_SUPPORT":return"IllegalArgumentError: Must value is _setSupportLanguageCodeSet.";case"MUST_ARRAY":return"IllegalArgumentError: Must type of argument is Array.";case"NOT_READ_NLS":return"Can't read language resource file.";case"BLANK_SET_SUPPORT":return"Blank SET_SUPPORT";case"BLANK_THIS_LANGUAGE":return"Blank THIS_LANGUAGE"}}})}(this),function(t){"use strict";function e(t){var e,i,n,o,r,a=[],h={},c={};for(var l in t)if((e=s.exec(l))&&(i=e[1])){if(i=i.toLowerCase(),n="on"+i,o="on"+caph.capitalize(i),r="_on"+i,l!==n&&l!==o&&l!==r)throw Error('IllegalEventHandlerNameError: The event handler name must be "'+n+'" or "'+o+'" or "'+r+'".');if(l=l.toLowerCase(),h[l])throw Error('DuplicateEventHandlerNameError: The "'+l+'" event handler is duplicated.');h[l]=!0,c[i]||(c[i]=!0,a.push(i))}return a}function i(t,e,i){if(!e._isEventObserver)throw Error('IllegalArgumentError: The "observer" parameter must be an array of the objects or an object which mixins the "caph.module.mixins.event.Observer".');if(i instanceof caph.event.Message)t.sendTo(e,i);else{if(!caph.isObject(i))throw Error('IllegalArgumentError: The "message" parameter must be an instance of "caph.event.Message" or an object.');t.sendTo(e,new caph.event.Message(i))}}var n=null,s=/^_?on([\w]+)$/,o=caph.dom.event.DEFAULT_EVENT_TYPE;$class({$namespace:"caph.module.event.Manager",$constructor:function(){if(n)throw Error('IllegalStateError: The "caph.module.event.Manager" must exist only one instance. Use "caph.module.event.Manager.getInstance()" instead of "new caph.module.event.Manager()".');this._mediator=new caph.module.event.Mediator,this._eventHandleManager=new caph.dom.event.HandleManager;for(var e in o)o.hasOwnProperty(e)&&("resize"===e||o[e].bubble)&&(this._mediator.addSubject(new caph.module.event.Subject(e)),this._eventHandleManager.set(e,caph.dom.event.add(t,e,function(t){this._sendDOMEvent(caph.event.Normalizer.getInstance().toMessage(t))}.bind(this))));n=this},$statics:{getInstance:function(){return null===n&&(n=new caph.module.event.Manager),n}},addSubject:function(t){return this._mediator.addSubject(new caph.module.event.Subject(t)),this},addObserver:function(t){if(!t._isEventObserver)throw Error('IllegalArgumentError: The "observer" parameter must mixin the "caph.module.mixins.event.Observer".');for(var i=e(t),n=0,s=i.length;s>n;n++)this._mediator.addObserver(i[n],t);return this},removeObserver:function(t,e){if(!t._isEventObserver)throw Error('IllegalArgumentError: The "observer" parameter must mixin the "caph.module.mixins.event.Observer".');if(e){if(!caph.isArray(e))throw Error('IllegalArgumentError: The "types" parameter must be an array of string.');for(var i=0,n=e.length;n>i;i++)this._mediator.removeObserver(e[i],t)}else{var o,r;for(var a in t)(o=s.exec(a))&&(r=o[1])&&this._mediator.removeObserver(r.toLowerCase(),t)}return this},send:function(t){if(t instanceof caph.event.Message)this._mediator.send(t);else{if(!caph.isObject(t))throw Error('IllegalArgumentError: The "message" parameter must be an instance of "caph.event.Message" or an object.');this._mediator.send(new caph.event.Message(t))}return this},sendTo:function(t,e){if(caph.isArray(t))for(var n=0,s=t.length;s>n;n++)i(this._mediator,t[n],e);else i(this._mediator,t,e);return this},_sendDOMEvent:function(t){this._mediator._sendDOMEvent(t)}})}(this),function(){"use strict";$class({$namespace:"caph.module.event.Mediator",$constructor:function(t){if(this._subjects={},t){if(!caph.isArray(t))throw Error('IllegalArgumentError: The "subjects" parameter must be an array of instance of "caph.module.event.Subject".');for(var e=0,i=t.length;i>e;e++)this.addSubject(t[e])}},addSubject:function(t){if(!(t instanceof caph.module.event.Subject))throw Error('IllegalArgumentError: The "subject" parameter must be an instance of "caph.module.event.Subject".');var e=t.getType();return this._subjects[e]||(this._subjects[e]=t),this},addObserver:function(t,e){var i=this._subjects[t];return i?i.add(e):(this.addSubject(new caph.module.event.Subject(t)),this._subjects[t].add(e)),this},removeObserver:function(t,e){var i=this._subjects[t];return i&&i.remove(e),this},send:function(t){var e=this._subjects[t.getType()];return e&&e.notify(t),this},sendTo:function(t,e){var i=this._subjects[e.getType()];return i&&i.notifyTo(t,e),this},_sendDOMEvent:function(t){var e=this._subjects[t.getType()];e&&e._notifyDOMEvent(t)}})}(this),function(){"use strict";function t(t){return t.isPropagationStopped()?!1:this._isEventObserver?this._handleMessage(t):!0}function e(i){if(t.call(this,i)){var n=this.getParent();n&&e.call(n,i)}}function i(e){if(t.call(this,e)){var s=this.getChildren();if(s&&caph.isArray(s)&&s.length>0)for(var o=0,r=s.length;r>o;o++)s[o]&&i.call(s[o],n.getInstance().createFrom(e))}}var n=caph.require("event.Normalizer");caph.namespace("caph.module.mixins.event",{Observer:{getParent:function(){return null},getChildren:function(){return null},_eventObserverId:null,_isEventObserver:!0,_receiveMessage:function(t){t.isBubbles()?e.call(this,t):i.call(this,t)},_handleMessage:function(t){var e=t.getType(),i=this["on"+e]||this["on"+caph.capitalize(e)],n=this["_on"+e];return caph.isFunction(i)&&i.call(this,t),caph.isFunction(n)&&n.call(this,t),!t.isPropagationStopped()}}})}(this),function(){"use strict";var t=caph.require("ui.base.component.Surface"),e=caph.require("event.Normalizer"),i=/[A-Z]/;$class({$namespace:"caph.module.event.Subject",$constructor:function(t){if(!t||!caph.isString(t))throw Error('IllegalArgumentError: The "caph.module.event.Subject" requires a string value representing subject type as the constructor parameter.');if(i.test(t))throw Error('IllegalArgumentError: The "type" parameter must be a lowercase string.');this._type=t,this._observers=[],this._observerIndexMap={}},getType:function(){return this._type},add:function(t){var e=t._eventObserverId;return e||(e=t._eventObserverId="observer_"+(new Date).getTime()+"_"+Math.floor(1e5*Math.random())),this._observerIndexMap[e]?void 0:(this._observerIndexMap[e]={index:this._observers.length},this._observers.push(t),this)},remove:function(t){var e,i=t._eventObserverId;return i&&(e=this._observerIndexMap[i])&&(this._observers[e.index]=null,this._observerIndexMap[i]=null),this},notify:function(t){return this._observers.forEach(function(e){e&&e._handleMessage(t)}),this},notifyTo:function(t,e){var i,n=t._eventObserverId;return n&&(i=this._observerIndexMap[n])&&this._observers[i.index]._receiveMessage(e),this},_notifyDOMEvent:function(i){"resize"===i.type?this._observers.forEach(function(n){return n instanceof t?(n._receiveMessage(e.getInstance().createFrom(i)),!1):void 0}):this._observers.forEach(function(t){return t&&t._receiveMessage(i),i.isPropagationStopped()?!1:void 0})}})}(this),function(){"use strict";caph.namespace("caph.module.mixins.focus",{Focusable:{_isTypeOfFocusable:!0,_isFocusable:!1,_isFocusContainer:!1,_isActive:!0,_sendDomEvent:!0,_level:0,_defaultNextFocus:void 0,_useKeyEvent:!0,_useMouseEvent:!0,NONE:null,DEFAULT:"default",focusable:function(t){return arguments.length?(this._isFocusable=t,this):this._isFocusable},focus:function(){caph.require("module.focus.Manager").getInstance().focus(this)},blur:function(){caph.require("module.focus.Manager").getInstance().blur(this)},focusContainer:function(t){return arguments.length?(this._isFocusContainer=t,this):this._isFocusContainer},active:function(t){return arguments.length?(this._isActive=t,this):this._isActive},domEvent:function(t){return arguments.length?(this._sendDomEvent=t,this):this._sendDomEvent},level:function(t){return arguments.length?(this._level=t,this):this._level},keyEvent:function(t){return arguments.length?(this._useKeyEvent=t,this):this._useKeyEvent},mouseEvent:function(t){return arguments.length?(this._useMouseEvent=t,this):this._useMouseEvent},_getDefaultNextFocus:function(t){if(void 0===t||t!==caph.module.focus.Manager.Buttons.UP&&t!==caph.module.focus.Manager.Buttons.DOWN&&t!==caph.module.focus.Manager.Buttons.LEFT&&t!==caph.module.focus.Manager.Buttons.RIGHT)throw Error("IllegalStateError: No correct button given.");return void 0===this._defaultNextFocus?void 0:this._defaultNextFocus[t]===caph.module.mixins.focus.Focusable.NONE?this:this._defaultNextFocus[t]},_setDefaultNextFocus:function(t,e){var i;if(void 0===t||t!==caph.module.focus.Manager.Buttons.UP&&t!==caph.module.focus.Manager.Buttons.DOWN&&t!==caph.module.focus.Manager.Buttons.LEFT&&t!==caph.module.focus.Manager.Buttons.RIGHT)throw Error("IllegalStateError: No correct button given.");void 0===this._defaultNextFocus&&(this._defaultNextFocus={}),i=e===caph.module.mixins.focus.Focusable.DEFAULT?void 0:e,this._defaultNextFocus[t]=i},defaultNextFocus:function(t,e){if(void 0===e){if(caph.isString(t))return this._getDefaultNextFocus(t);for(var i in t)t.hasOwnProperty(i)&&this._setDefaultNextFocus(i,t[i]);return this}return this._setDefaultNextFocus(t,e),this},_hasParentRootNode:function(){for(var t=caph.require("module.focus.Manager").getInstance().getRootNode(),e=this;e;){if(e===t)return!0;e=e.getParent()}return!1},_isFrozen:function(){for(var t=(caph.require("module.focus.Manager").getInstance().getRootNode(),this);t;){if(t._isActive===!1)return!0;t=t.getParent()}return!1}}})}(this),function(){"use strict";var t=caph.require("math.Vector3");$class({$namespace:"caph.module.focus._Finder",$constructor:function(){this._componentAABB=new WeakMap,this._componentPriorities={LOW:1,MIDDLE:2,HIGH:3,INTERSECTION:4},this._distanceCalculationType={REGULAR:1,INTERSECTION:2},this._configurations={useHighPriority:!0,useMiddlePriority:!1,useLowPriority:!1,highPriorityAngle:45}},_getNextFocusableComponent:function(t,e,i){var n,s;return t.getParent()?t instanceof caph.module.renderer.View?(this._componentAABB=new WeakMap,n=this._getComponentsAndDistanceCalculationType(t,e,i),0===n.components.length?t:(s=this._getClosestComponent(t,i,n),s.focusable()?s:this._getClosestComponentInContainer(t,e,i,s))):t:t},_hasEnoughPriority:function(t,e,i){var n=!0;return this._configurations.useHighPriority&&(n=n&&this._isHighPriority(t,e,i)),this._configurations.useMiddlePriority&&(n=n&&this._isMiddlePriority(t,e,i)),this._configurations.useLowPriority&&(n=n&&this._isLowPriority(t,e,i)),n},_getComponentsAndDistanceCalculationType:function(t,e,i){var n,s;return n=this._getFilteredComponentsAndContainersByPriority(t,e,i,this._componentPriorities.INTERSECTION),s=this._distanceCalculationType.INTERSECTION,0!==n.length?this._combineComponentsAndDistanceCalculationType(n,s):(s=this._distanceCalculationType.REGULAR,this._configurations.useHighPriority&&(n=this._getFilteredComponentsAndContainersByPriority(t,e,i,this._componentPriorities.HIGH),0!==n.length)?this._combineComponentsAndDistanceCalculationType(n,s):this._configurations.useMiddlePriority&&(n=this._getFilteredComponentsAndContainersByPriority(t,e,i,this._componentPriorities.MIDDLE),0!==n.length)?this._combineComponentsAndDistanceCalculationType(n,s):this._configurations.useLowPriority&&(n=this._getFilteredComponentsAndContainersByPriority(t,e,i,this._componentPriorities.LOW),0!==n.length)?this._combineComponentsAndDistanceCalculationType(n,s):this._combineComponentsAndDistanceCalculationType(n,s))
},_getFilteredComponentsAndContainersByPriority:function(t,e,i,n){var s,o=t.getSiblings(),r=this._getFilteredComponents(e,o),a=this._getFilteredContainers(e,o);switch(n){case this._componentPriorities.INTERSECTION:s=this._getIntersectionPriorityComponents(t,i,r);break;case this._componentPriorities.HIGH:s=this._getHighPriorityComponents(t,i,r).concat(this._getPriorityContainers(t,i,a));break;case this._componentPriorities.MIDDLE:s=this._getMiddlePriorityComponents(t,i,r);break;case this._componentPriorities.LOW:s=this._getLowPriorityComponents(t,i,r);break;default:throw Error("IllegalStateError: No correct component priority given.")}return 0!==s.length?s:(t=t.getParent(),null===t.getParent()?s:this._getFilteredComponentsAndContainersByPriority(t,e,i,n))},_getIntersectionPriorityComponents:function(t,e,i){for(var n=[],s=0,o=i.length;o>s;s++)this._isIntersectionPriority(t,e,i[s])&&n.push(i[s]);return n},_isIntersectionPriority:function(t,e,i){var n=this._getComponentAbsoluteAABB(t),s=this._getComponentAbsoluteAABB(i);return this._areEnoughIntersected(n,e,s)},_getPriorityContainers:function(t,e,i){for(var n=[],s=0,o=i.length;o>s;s++)this._isPriorityContainer(t,e,i[s])&&n.push(i[s]);return n},_isPriorityContainer:function(t,e,i){var n=this._getComponentAbsoluteAABB(t),s=this._getComponentAbsoluteAABB(i);return this._isOnTheSide(n,e,s)},_getHighPriorityComponents:function(t,e,i){for(var n=[],s=0,o=i.length;o>s;s++)this._isHighPriority(t,e,i[s])&&n.push(i[s]);return n},_isHighPriority:function(t,e,i){var n=this._getComponentAbsoluteAABB(t),s=this._getComponentAbsoluteAABB(i);return!this._areIntersected(n,s)&&(this._isOnTheSide(n,e,s)||this._isCorrectQuarter(n,e,s))},_getMiddlePriorityComponents:function(t,e,i){for(var n=[],s=0,o=i.length;o>s;s++)this._isMiddlePriority(t,e,i[s])&&n.push(i[s]);return n},_isMiddlePriority:function(t,e,i){var n=this._getComponentAbsoluteAABB(t),s=this._getComponentAbsoluteAABB(i),o=!this._areIntersected(n,s);if(e===caph.module.focus.Manager.Buttons.LEFT)return o&&s.center.x<=n.topLeft.x;if(e===caph.module.focus.Manager.Buttons.RIGHT)return o&&n.bottomRight.x<=s.center.x;if(e===caph.module.focus.Manager.Buttons.UP)return o&&s.center.y<=n.topLeft.y;if(e===caph.module.focus.Manager.Buttons.DOWN)return o&&n.bottomRight.y<=s.center.y;throw Error("IllegalStateError: No correct button given.")},_getLowPriorityComponents:function(t,e,i){for(var n=[],s=0,o=i.length;o>s;s++)this._isLowPriority(t,e,i[s])&&n.push(i[s]);return n},_isLowPriority:function(t,e,i){var n=this._getComponentAbsoluteAABB(t),s=this._getComponentAbsoluteAABB(i),o=!this._areIntersected(n,s);if(e===caph.module.focus.Manager.Buttons.LEFT)return o&&s.topLeft.x<n.topLeft.x;if(e===caph.module.focus.Manager.Buttons.RIGHT)return o&&n.bottomRight.x<s.bottomRight.x;if(e===caph.module.focus.Manager.Buttons.UP)return o&&s.topLeft.y<n.topLeft.y;if(e===caph.module.focus.Manager.Buttons.DOWN)return o&&n.bottomRight.y<s.bottomRight.y;throw Error("IllegalStateError: No correct button given.")},_isOnTheSide:function(t,e,i){var n,s,o,r,a,h,c,l=this._isCorrectSide(t,e,i);if(e===caph.module.focus.Manager.Buttons.LEFT||e===caph.module.focus.Manager.Buttons.RIGHT)s=Math.max(t.topLeft.y,i.topLeft.y),o=Math.min(t.bottomRight.y,i.bottomRight.y),h=Math.min(t.bottomRight.y-t.topLeft.y,i.bottomRight.y-i.topLeft.y),n=o-s>h/2;else{if(e!==caph.module.focus.Manager.Buttons.UP&&e!==caph.module.focus.Manager.Buttons.DOWN)throw Error("IllegalStateError: No correct button given.");a=Math.max(t.topLeft.x,i.topLeft.x),r=Math.min(t.bottomRight.x,i.bottomRight.x),c=Math.min(t.bottomRight.x-t.topLeft.x,i.bottomRight.x-i.topLeft.x),n=r-a>c/2}return l&&n},_isCorrectQuarter:function(t,e,i){var n,s,o,r,a,h=this._isCorrectSide(t,e,i);if(e===caph.module.focus.Manager.Buttons.LEFT||e===caph.module.focus.Manager.Buttons.RIGHT){if(t.center.x===i.center.x)return!1;n=Math.abs(t.center.y-i.center.y),o=Math.abs(t.topLeft.y-t.bottomRight.y)/2,e===caph.module.focus.Manager.Buttons.LEFT?s=Math.abs(t.topLeft.x+o-i.center.x):e===caph.module.focus.Manager.Buttons.RIGHT&&(s=Math.abs(t.bottomRight.x-o-i.center.x)),a=n/s}else{if(e!==caph.module.focus.Manager.Buttons.UP&&e!==caph.module.focus.Manager.Buttons.DOWN)throw Error("IllegalStateError: No correct button given.");if(t.center.y===i.center.y)return!1;s=Math.abs(t.center.x-i.center.x),r=Math.abs(t.topLeft.x-t.bottomRight.x)/2,e===caph.module.focus.Manager.Buttons.UP?n=Math.abs(t.topLeft.y+r-i.center.y):e===caph.module.focus.Manager.Buttons.DOWN&&(n=Math.abs(t.bottomRight.y-r-i.center.y)),a=s/n}return h&&this._getAngle(a)<=this._configurations.highPriorityAngle},_getAngle:function(t){return 180*Math.atan(t)/Math.PI},_isCorrectSide:function(t,e,i){if(e===caph.module.focus.Manager.Buttons.LEFT)return t.topLeft.x>i.topLeft.x;if(e===caph.module.focus.Manager.Buttons.RIGHT)return t.bottomRight.x<i.bottomRight.x;if(e===caph.module.focus.Manager.Buttons.UP)return t.topLeft.y>i.topLeft.y;if(e===caph.module.focus.Manager.Buttons.DOWN)return t.bottomRight.y<i.bottomRight.y;throw Error("IllegalStateError: No correct button given.")},_getFilteredComponents:function(t,e){for(var i=[],n=0,s=e.length;s>n;n++)this._isFocusable(t,e[n])&&i.push(e[n]);return i},_getFilteredContainers:function(t,e){for(var i=[],n=0,s=e.length;s>n;n++)this._isNotFocusableContainer(e[n])&&this._hasFocusableChildren(t,e[n])&&i.push(e[n]);return i},_hasFocusableChildren:function(t,e){for(var i=e.getChildren(),n=0,s=i.length;s>n;n++)if(this._isFocusable(t,i[n])||this._isNotFocusableContainer(i[n])&&this._hasFocusableChildren(t,i[n]))return!0;return!1},_isFocusable:function(t,e){return e._isTypeOfFocusable&&e.keyEvent()&&e.visibility()&&e.focusable()&&e.active()&&(e.level()===t||-1===e.level())},_isNotFocusableContainer:function(t){return t._isTypeOfFocusable&&t.keyEvent()&&t.visibility()&&!t.focusable()&&t.active()},_getClosestComponent:function(t,e,i){var n,s,o,r=null,a=Number.MAX_VALUE,h=this._getComponentAbsoluteAABB(t);switch(i.distanceCalculationType){case this._distanceCalculationType.INTERSECTION:o=this._getIntersectionDistance;break;case this._distanceCalculationType.REGULAR:o=this._getRegularDistance;break;default:throw Error("IllegalStateError: No correct distance calculation type given.")}for(var c=0,l=i.components.length;l>c;c++)s=this._getComponentAbsoluteAABB(i.components[c]),a>(n=o(h,e,s))&&(a=n,r=i.components[c]);return r},_getClosestComponentInContainer:function(t,e,i,n){var s=this._getFilteredComponents(e,n.getChildren()),o=this._getFilteredContainers(e,n.getChildren()),r=this._combineComponentsAndDistanceCalculationType(s.concat(o),this._distanceCalculationType.REGULAR),a=this._getClosestComponent(t,i,r);return a.focusable()?a:this._getClosestComponentInContainer(t,e,i,a)},_areEnoughIntersected:function(t,e,i){var n=this._getIntersectionX(t,i),s=this._getIntersectionY(t,i),o=n>0&&s>0,r=this._isCorrectSide(t,e,i);switch(e){case caph.module.focus.Manager.Buttons.LEFT:case caph.module.focus.Manager.Buttons.RIGHT:o=o&&n>s;break;case caph.module.focus.Manager.Buttons.UP:case caph.module.focus.Manager.Buttons.DOWN:o=o&&s>n;break;default:throw Error("IllegalStateError: No correct button given.")}return r&&o},_areIntersected:function(t,e){return this._getIntersectionX(t,e)>0&&this._getIntersectionY(t,e)>0},_getIntersectionX:function(t,e){return Math.min(t.bottomRight.x,e.bottomRight.x)-Math.max(t.topLeft.x,e.topLeft.x)},_getIntersectionY:function(t,e){return Math.min(t.bottomRight.y,e.bottomRight.y)-Math.max(t.topLeft.y,e.topLeft.y)},_getRegularDistance:function(e,i,n){var s,o,r,a;if(i===caph.module.focus.Manager.Buttons.LEFT||i===caph.module.focus.Manager.Buttons.RIGHT)o=e.center.y,a=n.center.y,i===caph.module.focus.Manager.Buttons.LEFT?(s=e.topLeft.x,r=n.bottomRight.x):i===caph.module.focus.Manager.Buttons.RIGHT&&(s=e.bottomRight.x,r=n.topLeft.x);else{if(i!==caph.module.focus.Manager.Buttons.UP&&i!==caph.module.focus.Manager.Buttons.DOWN)throw Error("IllegalStateError: No correct button given.");s=e.center.x,r=n.center.x,i===caph.module.focus.Manager.Buttons.UP?(o=e.topLeft.y,a=n.bottomRight.y):i===caph.module.focus.Manager.Buttons.DOWN&&(o=e.bottomRight.y,a=n.topLeft.y)}return new t(s,o,0).distance(new t(r,a,0))},_getIntersectionDistance:function(t,e,i){if(e===caph.module.focus.Manager.Buttons.LEFT)return t.topLeft.x-i.bottomRight.x;if(e===caph.module.focus.Manager.Buttons.RIGHT)return i.topLeft.x-t.bottomRight.x;if(e===caph.module.focus.Manager.Buttons.UP)return t.topLeft.y-i.bottomRight.y;if(e===caph.module.focus.Manager.Buttons.DOWN)return i.topLeft.y-t.bottomRight.y;throw Error("IllegalStateError: No correct button given.")},_getComponentAbsoluteAABB:function(e){var i,n,s,o=this._componentAABB.get(e),r=e.position();return void 0!==o?o:(i=e._getAABB(),o={topLeft:new t(i.topLeft[0],i.topLeft[1],0),bottomRight:new t(i.bottomRight[0],i.bottomRight[1],0),center:new t(i.center[0],i.center[1],0)},n=e.offset(),s=new t(n[0]-r[0],n[1]-r[1],n[2]-r[2]),o.topLeft.add(s),o.bottomRight.add(s),o.center.add(s),this._componentAABB.set(e,o),o)},_combineComponentsAndDistanceCalculationType:function(t,e){return{components:t,distanceCalculationType:e}},_setConfigurations:function(t){void 0===t&&(t={}),caph.isBoolean(t.useHighPriority)&&(this._configurations.useHighPriority=t.useHighPriority),caph.isBoolean(t.useMiddlePriority)&&(this._configurations.useMiddlePriority=t.useMiddlePriority),caph.isBoolean(t.useLowPriority)&&(this._configurations.useLowPriority=t.useLowPriority),caph.isNumber(t.highPriorityAngle)&&(this._configurations.highPriorityAngle=t.highPriorityAngle)}})}(this),function(){"use strict";var t=caph.require("module.event.Manager");caph.require("ui.base.component.Surface");var e=caph.require("event.Message"),i=caph.require("module.focus._Finder"),n=null,s=null,o=null,r=null,a=null,h=null,c=null,l=null,u=0,p=new WeakMap;$class({$namespace:"caph.module.focus.Manager",$mixins:[caph.module.mixins.event.Observer],$constructor:function(){if(n)throw Error('IllegalStateError: The "caph.module.focus.Manager" must exist only one instance. Use "caph.module.focus.Manager.getInstance()" instead of "new caph.module.focus.Manager()".');if(r=new i,s=t.getInstance(),!s)throw Error('IllegalStateError: The "caph.module.event.Manager" is not loaded.');s.addObserver(this),o=caph.module.renderer._VDomLookUpTable.getInstance(),n=this},$statics:{getInstance:function(){return null===n&&(n=new caph.module.focus.Manager),n},Buttons:{ENTER:"enter",UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right"}},setRootNode:function(t){t instanceof caph.collection.TreeNode&&(a=t)},getRootNode:function(){return a},setFocusLevel:function(t){u!==t&&(u=t,this.reset())},getFocusLevel:function(){return u},getCurrentFocus:function(){return c},getLastFocus:function(){return h},reset:function(){this.focus(null),h=null},onkeydown:function(t){var i,n,o,p,d,f,m,_;if(t.stopPropagation(),null===c){if(null===h)return this._initializeFocus(a),void 0;if(h.keyEvent())return this.focus(h,"key"),void 0;c=h}else{if(i=new e(this._getEventMessageForVDom(t,{source:c})),s.sendTo(c,i),!c||i.isPropagationStopped()===!0)return;if(n=this._getButton(t),n===caph.module.focus.Manager.Buttons.LEFT||n===caph.module.focus.Manager.Buttons.RIGHT||n===caph.module.focus.Manager.Buttons.UP||n===caph.module.focus.Manager.Buttons.DOWN)o=c.defaultNextFocus(n),void 0===o&&(d=r._getNextFocusableComponent(c,u,n),p=this._getCachedFocus(d.getParent(),n),o=this._needGetCachedFocus(c,n,p)?p:d,this._needSetCachedFocus(c,n,d)&&this._setCachedFocus(n,c)),this.focus(o,"key"),l=n;else if(f=c.getChildren(),m=f.length,n===caph.module.focus.Manager.Buttons.ENTER&&c.focusContainer()===!0&&m>0)if(p=this._getCachedFocus(c,l),void 0!==p)this.focus(p,"key");else for(_=0;m>_&&!this._initializeFocus(f[_]);)_++}},onkeyup:function(t){var i;t.stopPropagation(),null!==c&&(i=new e(this._getEventMessageForVDom(t,{source:c})),s.sendTo(c,i))},onclick:function(t){this._sendMouseEvent(t,!0)},ondblclick:function(t){this._sendMouseEvent(t,!0)},onwheel:function(t){this._sendMouseEvent(t,!0)},onmousedown:function(t){this._sendMouseEvent(t,!0)},onmouseup:function(t){this._sendMouseEvent(t,!0)},onmousemove:function(t){this._sendMouseEvent(t,!0)},onmouseover:function(t){this._sendMouseEvent(t,!0)},onmouseout:function(t){this._sendMouseEvent(t,!1)},_sendMouseEvent:function(t,i){var n,o=this._getFocusableByDOM(t.source);t.stopPropagation(),i===!0&&o!==c&&(!o||o&&o.mouseEvent())&&this.focus(o,"mouse"),null!==o&&(n=new e(this._getEventMessageForVDom(t)),s.sendTo(o,n))},onfocus:function(t){t.stopPropagation()},onblur:function(t){t.stopPropagation()},focus:function(t,e){var i,n;return c===t?!1:null===t?(this.blur(c),c=t,!0):null===t||t.level()!==u&&-1!==t.level()||t._hasParentRootNode()!==!0||t._isFrozen()!==!1?!1:(this.blur(c),c=t,i=this._makeFocusCustomEvent(t,"focus",e),s.sendTo(t,i),t.domEvent()&&(n=o.getDom(t),n&&n.focus()),!0)},blur:function(t){var e,i;c===t&&(null!==c&&(e=this._makeFocusCustomEvent(c,"blur"),s.sendTo(c,e),t.domEvent()&&(i=o.getDom(c),i&&i.blur())),h=c,c=null)},setFocusFinderConfigurations:function(t,e){var i;void 0===e?r._setConfigurations(t):(i={},i[t]=e,r._setConfigurations(i))},_initializeFocus:function(t){var e,i;if(!t)return!1;if(!t instanceof caph.collection.TreeNode)return!1;if(t._isTypeOfFocusable&&t.active()===!1)return!1;if(t._isTypeOfFocusable&&t.keyEvent()&&t.focusable()&&(t.level()===u||-1===t.level()))return this.focus(t,"key"),!0;if(t.hasChild()===!1)return!1;i=t.getChildren();for(var n=0,s=i.length;s>n;n++)if(e=i[n],this._initializeFocus(e)===!0)return!0},_makeFocusCustomEvent:function(t,i,n){var s={type:i,bubbles:"true",source:t,detail:{}};return n&&(s.detail.method=n),new e(s)},_getFocusableByDOM:function(t){var e=o.getVDom(t);if(!e)return null;for(;!e._isTypeOfFocusable||!e.focusable()||e.level()!==u&&-1!==e.level()||e._hasParentRootNode()!==!0||e._isFrozen()!==!1;){if(null===e.getParent())return null;e=e.getParent()}return e},_getEventMessageForVDom:function(t,i){return i=i||{},t?new e({_event:t._event,type:i.type||t.type,source:i.source||o.getVDom(t.source),bubbles:i.bubbles||t.bubbles||!0,timeStamp:i.timeStamp||t.timeStamp,detail:i.detail||t.detail}):null},_getButton:function(t){return t.key().enter?caph.module.focus.Manager.Buttons.ENTER:t.key().left?caph.module.focus.Manager.Buttons.LEFT:t.key().right?caph.module.focus.Manager.Buttons.RIGHT:t.key().up?caph.module.focus.Manager.Buttons.UP:t.key().down?caph.module.focus.Manager.Buttons.DOWN:void 0},_getOppositeButton:function(t){if(t===caph.module.focus.Manager.Buttons.LEFT)return caph.module.focus.Manager.Buttons.RIGHT;if(t===caph.module.focus.Manager.Buttons.RIGHT)return caph.module.focus.Manager.Buttons.LEFT;if(t===caph.module.focus.Manager.Buttons.UP)return caph.module.focus.Manager.Buttons.DOWN;if(t===caph.module.focus.Manager.Buttons.DOWN)return caph.module.focus.Manager.Buttons.UP;throw Error("IllegalStateError: No correct button given.")},_needGetCachedFocus:function(t,e,i){return void 0===i?!1:t.getParent()===i.getParent()?!1:r._hasEnoughPriority(t,e,i)},_needSetCachedFocus:function(t,e,i){for(var n=i;n=n.getParent();)if(n===t.getParent())return!1;return!0},_getCachedFocus:function(t,e){var i,n;return i=p.get(t),void 0===i?void 0:(n=i[e],void 0===n?void 0:n.keyEvent()?n:void 0)},_setCachedFocus:function(t,e){var i=p.get(e.getParent());void 0!==i?i[this._getOppositeButton(t)]=e:(i={},i[this._getOppositeButton(t)]=e,p.set(e.getParent(),i))}})}(this),function(){var t={PRE_RENDER:0,RENDER:1,POST_RENDER:2};Object.freeze(t),caph.namespace("caph.module.renderer._Constant",t)}(),function(){"use strict";var t=caph.require("collection.Map"),e=$class({$constructor:function(){this._map=new t},getDom:function(t){return this._map.get(t)},getVDom:function(t){for(var e;void 0===e&&"HTML"!==t.tagName&&void 0!=t;)e=this._map.getKeyByValue(t),t=t.parentNode;return e},_set:function(t,e){return this._map.set(t,e)},_delete:function(t){return this._map.delete(t)}});caph.namespace("caph.module.renderer._VDomLookUpTable",caph.pattern.singleton(e))}(this),function(t){"use strict";var e=caph.require("module.renderer._Constant"),i=i||{},n=20,s=-1,o={NONE:0,PRERENDER:1,RENDER:2,POSTRENDER:4},r={FRAME:!1},a=$class({$constructor:function(){i.mountedVDomList=[],i.preRenderTaskQueue=[],i.renderTaskQueue=[],i.postRenderTaskQueue=[],i.dirtyVDomList=[],i.currentTickTask=null,i.lastTimeStamp=null,i.frameRequestedReasonBits=o.NONE,i.currentRequestedFrameID=s,i.rendererTick=a.prototype.tick.bind(this)},tick:function(t){var e,a;r.FRAME&&(a=i.currentRequestedFrameID),i.currentRequestedFrameID=s,i.frameRequestedReasonBits=o.NONE,null===i.lastTimeStamp&&(i.lastTimeStamp=t),e=t-i.lastTimeStamp,e>=n&&(e=n),r.FRAME&&console.debug("*\nstart  :",a,i.currentRequestedFrameID),this._preRender(e),this._render(e),this._postRender(e),r.FRAME&&console.debug("end    :",a,i.currentRequestedFrameID),i.lastTimeStamp=i.frameRequestedReasonBits===o.NONE?null:t},_requestUpcomingFrameUpdate:function(e){void 0===this._isTerminated&&i.frameRequestedReasonBits===o.NONE&&(i.currentRequestedFrameID=t.requestAnimationFrame(i.rendererTick),r.FRAME&&console.debug("request:",i.currentRequestedFrameID)),i.frameRequestedReasonBits|=e},_cancelUpcomingFrameUpdate:function(){i.currentRequestedFrameID!==s&&(t.cancelAnimationFrame(i.currentRequestedFrameID),i.currentRequestedFrameID=s)},_updateDirtyObject:function(){var e,n;for(n=this._getUpdateNeededVDomList();e=n.shift();)e.update();i.frameRequestedReasonBits&o.RENDER&&(i.frameRequestedReasonBits^=o.RENDER,i.frameRequestedReasonBits===o.NONE&&(r.FRAME&&console.debug("cancel :",i.currentRequestedFrameID),t.cancelAnimationFrame(i.currentRequestedFrameID),i.currentRequestedFrameID=s))},_preRender:function(t){var e,n;if(i.currentTickTask=this._preRender,i.preRenderTaskQueue.length)for(n=i.preRenderTaskQueue.splice(0);e=n.shift();)e.thisArg?e.callback.call(e.thisArg,t):e.callback(t);i.currentTickTask=null},_render:function(){var t;for(i.currentTickTask=this._render;t=i.renderTaskQueue.shift();)t.thisArg?t.callback.call(t.thisArg):t.callback();this._updateDirtyObject(),i.currentTickTask=null},_postRender:function(){var t,e;if(i.currentTickTask=this._postRender,i.postRenderTaskQueue.length){for(e=i.postRenderTaskQueue.splice(0);t=e.shift();)t.thisArg?t.callback.call(t.thisArg):t.callback();this._updateDirtyObject()}i.currentTickTask=null},_addUpdateNeededVDom:function(t){i.currentTickTask!==this._render&&-1===i.dirtyVDomList.indexOf(t)&&(i.dirtyVDomList.push(t),this._requestUpcomingFrameUpdate(o.RENDER))},_addRenderQueue:function(t,n,s){switch(t){case e.PRE_RENDER:this._renderTaskCallback(i.preRenderTaskQueue,o.PRERENDER,n,s);break;case e.RENDER:this._renderTaskCallback(i.renderTaskQueue,o.RENDER,n,s);break;case e.POST_RENDER:this._renderTaskCallback(i.postRenderTaskQueue,o.POSTRENDER,n,s);break;default:}},_renderTaskCallback:function(t,e,i,n){for(var s=t.length,o=!1,r=0;s>r;r++)if(i===t[r].callback&&t[r].thisArg&&t[r].thisArg===n){o=!0;break}if(o===!1){var a={callback:i,thisArg:n};t.push(a),this._requestUpcomingFrameUpdate(e)}},_terminate:function(){var t;this._isTerminated=!0,this._cancelUpcomingFrameUpdate();for(var e=0,n=i.mountedVDomList.length;n>e;e++)t=i.mountedVDomList[e].vdom,t.destroy();i.mountedVDomList=void 0,i.preRenderTaskQueue=void 0,i.renderTaskQueue=void 0,i.postRenderTaskQueue=void 0,i.dirtyVDomList=void 0,i.frameRequestedReasonBits=void 0,i.currentRequestedFrameID=void 0,i.rendererTick=void 0},_getUpdateNeededVDomList:function(){return i.dirtyVDomList},_mount:function(t,n){var s,o;return t instanceof caph.module.renderer.VDom&&("string"==typeof n?s=document.getElementById(n):"function"==typeof n?s=n():n instanceof HTMLElement&&(s=n),o={vdom:t,dom:s||document.body},i.mountedVDomList.push(o),this._addRenderQueue(e.RENDER,this._callbackUpdateMountedVDomList,this)),this},_callbackUpdateMountedVDomList:function(){for(var t,e,n=0,s=i.mountedVDomList.length;s>n;n++)t=i.mountedVDomList[n].vdom,e=i.mountedVDomList[n].dom,t&&void 0===t._isMounted&&(t.update(),t._mount(e))},_unmount:function(t){var e=null;if(t instanceof caph.module.renderer.VDom&&t._isMounted&&t._isMounted())for(var n=0,s=i.mountedVDomList.length;s>n;n++)if(i.mountedVDomList[n].vdom===t)return e=i.mountedVDomList[n],i.mountedVDomList.splice(n,1),t._unmount(e.dom),this}});caph.namespace("caph.module.renderer.VDomRenderer",caph.pattern.singleton(a))}(this),function(t){"use strict";function e(t,e){switch(e){default:(-1!=["width","height","lineHeight","top","right","bottom","left"].indexOf(e)||-1!=e.search("padding")||-1!=e.search("border")||-1!=e.search("margin"))&&"number"==typeof t[e]&&(t[e]+="px")}return t[e]}function i(t,e){switch(e){case"innerHTML":"string"==typeof t[e]&&(t[e]=t[e].replace(/(<(iframe|script).*?>.*?<\/(iframe|script)>)|(<link.*?>)/g,function(){return""}));break;default:}return t[e]}function n(){}function s(e){var i,o,r,a=void 0;if(("object"!=typeof this||this===t)&&(a=this),void 0===a)if(this instanceof Array){for(r=[],i=0,o=this.length;o>i;i++)r[i]=s.call(this[i],e);a=r}else if(this instanceof Object){if(void 0===e&&(e=new WeakMap),r=e.get(this),null==r){r=new n,e.set(this,r);for(i in this)this.hasOwnProperty(i)&&(r[i]=s.call(this[i],e));r.__proto__=this.__proto__}a=r}return a}var o=caph.require("collection.TreeNode"),r=caph.require("module.renderer._VDomLookUpTable"),a=caph.require("module.renderer.VDomRenderer"),h=caph.require("module.renderer._Constant"),c=caph.require("pattern.PubSub"),l={DOM_NOT_CREATED:0,DOM_CREATED:1,DOM_BEING_RENDERED:2},u={TREE:"tree",CLASS:"class",STYLE:"style",ATTRIBUTE:"attribute"},p={TREE_UPDATED:"vdom.tree.update",TREE_INSERT_BEFORE:"insertBefore",TREE_REMOVE:"remove",TREE_ADD:"add"},d=r.getInstance(),f=a.getInstance();Object.freeze(l),Object.freeze(u),Object.freeze(p);var m=$class({$namespace:"caph.module.renderer.VDom",$extends:o,$constructor:function(t){this.$super(),this._reset(this._handlingDeprecated(t))},_reset:function(t){return t=t||{},this._tag=t.tagName||"div",this._classList=[],this._removedClassList=[],this._domProperty={},this._domProperty.style={},this._dirtyMark={},this._publisher=new c,this._addTreeUpdateListener(_.bind(this)),this._resetRenderStatus(),this._parseOption(t),this},_handlingDeprecated:function(t){var e,i,n,s;return t=t||{},e=t.dom||t,i=t.class||e.className,n=t.tag||e.tagName,s=t.children||e.children,i&&(e.className=i),n&&(e.tagName=n,e.tag&&delete e.tag),s&&(e.children=s),e},_addTreeUpdateListener:function(t){return this._publisher.on(p.TREE_UPDATED,t),this},_removeTreeUpdateListener:function(t){return this._publisher.off(p.TREE_UPDATED,t),this},_parseOption:function(t){var e,i,n,s;if(n=t,s=t.className,i=t.children,n instanceof HTMLElement?(d._set(this,n),this._setRenderState(l.DOM_CREATED)):(n.tagName&&delete n.tagName,this.setProperty(n)),s&&this.addClass(s),i)for(var o=0,r=i.length;r>o;o++)e=new m(i[o]),this.addChild(e);return this},_resetRenderStatus:function(){return this._setRenderState(l.DOM_NOT_CREATED),this._setDirty(u.CLASS,!0),this._setDirty(u.STYLE,!0),this._setDirty(u.ATTRIBUTE,!0),this._setDirty(u.TREE,!0),this},setProperty:function(t){var e,i=arguments[1];for(e in t)"style"===e?this.setStyle(t.style,i):(i&&"function"==typeof i.attrFilter&&i.attrFilter(t,e),void 0!==t[e]&&(this._domProperty[e]=t[e]),this._setDirty(u.ATTRIBUTE,!0));return this},setStyle:function(t){var e,i=arguments[1];for(e in t)i&&"function"==typeof i.styleFilter&&i.styleFilter(t,e),void 0!==t[e]&&(this._domProperty.style[e]=t[e]);return this._setDirty(u.STYLE,!0),this},getProperty:function(t){if(t&&"string"==typeof t){if(this._domProperty[t]&&"value"!=t)return this._domProperty[t];var e=d.getDom(this);return e?e[t]:void 0}},getStyle:function(e){var i=this._domProperty.style;if(e&&"string"==typeof e){if(i[e])return i[e];var n=d.getDom(this);return n?t.getComputedStyle(n,null).getPropertyValue(e):void 0}},addClass:function(t){var e;if(!t||"string"!=typeof t)throw Error("the given classname, "+t+", is invalid");e=t.trim().replace(/ +/g," ").split(" ");for(var i=0,n=e.length;n>i;i++)0>this._classList.indexOf(e[i])&&this._classList.push(e[i]);return this._setDirty(u.CLASS,!0),this},removeClass:function(t){var e,i;if(!t||"string"!=typeof t)throw Error("the given classname, "+t+", is invalid");e=t.trim().replace(/ +/g," ").split(" ");for(var n=0,s=e.length;s>n;n++)i=this._classList.indexOf(e[n]),i>=0&&(this._removedClassList.push(this._classList[i]),this._classList.splice(i,1),this._setDirty(u.CLASS,!0));return this},hasClass:function(t){var e=t.trim().replace(/ +/g," ").split(" ");if(0>=e.length)return!1;for(var i=0,n=e.length;n>i;i++)if(0>this._classList.indexOf(e[i]))return!1;return!0},toggleClass:function(t){return this.hasClass(t)?this.removeClass(t):this.addClass(t),this},addChild:function(t){return this.$super(t,{callback:function(t){this._publisher.fire(p.TREE_UPDATED,{status:p.TREE_ADD,child:t})}.bind(this)})},_insertBefore:function(t,e){return this.$super(t,e,{callback:function(t,e){this._publisher.fire(p.TREE_UPDATED,{status:p.TREE_INSERT_BEFORE,child:t,baseChild:e})}.bind(this)})},removeChild:function(t,e){for(var i,n=[].concat(t),s=0,o=n.length;o>s;s++)i=n[s],this._renderState>=l.DOM_CREATED&&this.getChildren().indexOf(i)>=0&&d.getDom(this).removeChild(d.getDom(i));return this.$super(t,{callback:function(t){this._publisher.fire(p.TREE_UPDATED,{status:p.TREE_REMOVE,child:t}),e&&e.callback&&e.callback(t)}.bind(this)})},_clone:function(){var t;return t=s.call(this),t._resetRenderStatus(),t},destroy:function(){var t;this.$super(),this._renderState>=l.DOM_CREATED&&(t=d.getDom(this),this._isMounted&&this._isMounted()?this.unmount():t.parentNode&&t.parentNode.removeChild(t),d._delete(this)),this._reset()},update:function(){var t=d.getDom(this);if(void 0===t){t=document.createElement(this._tag),d._set(this,t),this._setRenderState(l.DOM_CREATED);for(var e=0,i=this._children.length;i>e;e++)this._children[e].update(),t.appendChild(d.getDom(this._children[e]))}return this._applyProperties(t,this),this._applyClasses(t,this),this},_preRender:function(){},_postRender:function(){},requestPreRender:function(t){return t?f._addRenderQueue(h.PRE_RENDER,t):this._preRender&&f._addRenderQueue(h.PRE_RENDER,this._preRender,this),this},requestPostRender:function(t){return t?f._addRenderQueue(h.POST_RENDER,t):this._postRender&&f._addRenderQueue(h.POST_RENDER,this._postRender,this),this},mount:function(t){var e=this;return this.requestPreRender(function(){a.getInstance()._mount(e,t)}),this},_mount:function(t){var e;t instanceof HTMLElement&&(e=d.getDom(this),e&&t.appendChild(e),this._isMounted=function(){return!0})},unmount:function(){var t=this;a.getInstance()._unmount(t)},_unmount:function(t){var e;return t instanceof HTMLElement&&(e=d.getDom(this),e&&t.removeChild(e),this._isMounted=void 0),this},_applyClasses:function(t,e){var i,n;if(this._getDirty(u.CLASS)){for(n in this._removedClassList)t.classList.remove(this._removedClassList[n]);this._removedClassList=[],i=e._getClassList();for(var s=0,o=i.length;o>s;s++)t.classList.add(i[s])}this._setDirty(u.CLASS,!1)},_applyProperties:function(t,e){var n,s,o;if(this._getDirty(u.STYLE)&&(this._patchObject(t,"style",e._domProperty.style),this._setDirty(u.STYLE,!1)),this._getDirty(u.ATTRIBUTE)){for(o in e._domProperty)e._domProperty.hasOwnProperty(o)&&(n=e._domProperty[o],s=typeof n,"function"===s?t[o]=n.bind(this):"string"===s||"number"===s||"boolean"===s?"role"===o||"title"===o?t.setAttribute(o,n):t[o]=i(e._domProperty,o):"style"!==o&&n instanceof Object&&this._patchObject(t,n,e._domProperty[o]));this._setDirty(u.ATTRIBUTE,!1)}},_patchObject:function(t,i,n){var s,o,r="style"===i||"dataset"===i?"":void 0;if("style"===i)for(s in n)n.hasOwnProperty(s)&&(o=e(n,s),t[i][s]=void 0===o?r:o);else if("dataset"===i)for(s in n)n.hasOwnProperty(s)&&(o=n[s],t[i][s]=void 0===o?r:o)},_setRenderState:function(t){this._renderState=t},_setDirty:function(t,e,i){var n;this._dirtyMark[t]={state:e},e&&this._renderState>=l.DOM_CREATED&&(n=i&&i.node||this,f._addUpdateNeededVDom(n))},_getDirty:function(t){return this._dirtyMark[t].state},_getClassList:function(){return this._classList}}),_=function(t){var e,i,n,s=t.child,o=t.baseChild;if(this._renderState>=l.DOM_CREATED)switch(i=d.getDom(s),e=d.getDom(this),void 0===i&&(s.update(),i=d.getDom(s)),t.status){case p.TREE_ADD:e.appendChild(i);break;case p.TREE_INSERT_BEFORE:n=d.getDom(o),void 0===n&&(o.update(),n=d.getDom(o)),e.insertBefore(i,n);break;case p.TREE_REMOVE:break;default:}}}(this),function(){"use strict";var t=caph.require("module.renderer.VDom"),e=caph.require("math.Vector3"),i=caph.require("math.Vector4"),n=$class({$namespace:"caph.module.renderer.View",$extends:t,$constructor:function(t){var e={};t&&(t.dom&&(e.dom=t.dom),t.class&&(e.class=t.class),t.tag&&(e.tag=t.tag),t.children&&(e.children=t.children)),this.$super(e),this._position=[null,null,null],this._rotation=[null,null,null],this._scale=[null,null],this._skew=[null,null],this._positionOrigin=[null,null],this._rotationOrigin=[null,null],this._offsetPosition=null,this.__initialize()},__initialize:function(){this._initializeStyle(),this._addTreeUpdateListener(function(t){t.child instanceof n&&t.child._invalidateOffset()}.bind(this))},_initializeStyle:function(){this.addClass("caph-view")},setProperty:function(t){return arguments[1]&&arguments[1].verbose===!1?this.$super.apply(this,arguments):this.$super(t,s)},setStyle:function(t){return arguments[1]&&arguments[1].verbose===!1?this.$super.apply(this,arguments):this.$super(t,s)},size:function(t,e){if(arguments.length){var i,n,s={};return n=t instanceof Array?[t[0],t[1]]:[t,e],i=n.every(function(t,e,i){var n=!1;return"number"==typeof t?(i[e]=t+"px",n=!0):"string"==typeof t&&-1===t.indexOf("%")?n=!0:void 0===t?n=!0:null===t&&(i[e]="",n=!0),n}),i&&(void 0!==n[0]&&(s.width=n[0]),void 0!==n[1]&&(s.height=n[1]),this.setStyle(s,{verbose:!1})),this}var o,r;return o=(o=this.getStyle("width"))?o.split("px")[0]:o,r=(r=this.getStyle("height"))?r.split("px")[0]:r,[parseInt(o,10),parseInt(r,10)]},position:function(){return this._setter.call(this._position,arguments,this)?(null!==this._offsetPosition&&(this._invalidateOffset(),this._invalidateDescendantOffset()),this):[this._position[0],this._position[1],this._position[2]]},translate:function(t,e,i){var n,s,o;return n=caph.isNumber(t)?this._position[0]+t:this._position[0],s=caph.isNumber(e)?this._position[1]+e:this._position[1],o=caph.isNumber(i)?this._position[2]+i:this._position[2],this.position(n,s,o),this},rotate:function(){return this._setter.call(this._rotation,arguments,this)?this:[this._rotation[0],this._rotation[1],this._rotation[2]]},scale:function(){return this._setter.call(this._scale,arguments,this)?this:[this._scale[0],this._scale[1]]},skew:function(){return this._setter.call(this._skew,arguments,this)?this:[this._skew[0],this._skew[1]]},opacity:function(t){return arguments.length?(this.setStyle({opacity:t},{verbose:!1}),this):Number(this.getStyle("opacity"))},visibility:function(t){return arguments.length?(t===!0?this.setStyle({visibility:"visible"},{verbose:!1}):t===!1&&this.setStyle({visibility:"hidden"},{verbose:!1}),this):"visible"===this.getStyle("visibility")?!0:!1},x:function(t){return arguments.length?(this.position(t),this):this._position[0]},y:function(t){return arguments.length?(this.position(void 0,t),this):this._position[1]},z:function(t){return arguments.length?(this.position(void 0,void 0,t),this):this._position[2]},rotateX:function(t){return arguments.length?(this.rotate(t),this):this._rotation[0]},rotateY:function(t){return arguments.length?(this.rotate(void 0,t),this):this._rotation[1]},rotateZ:function(t){return arguments.length?(this.rotate(void 0,void 0,t),this):this._rotation[2]},positionOrigin:function(){return this._setter.call(this._positionOrigin,arguments,this)?this:[this._positionOrigin[0],this._positionOrigin[1]]},rotationOrigin:function(){return this._setter.call(this._rotationOrigin,arguments,this)?this:[this._rotationOrigin[0],this._rotationOrigin[1]]
},offset:function(t,e,i){var n,s;return arguments.length?(n=caph.isArray(t)?t:[t,e,i],s=this.getParent()._getOffsetPosition(),this._position[0]=caph.isNumber(n[0])?n[0]-s[0]:this._position[0],this._position[1]=caph.isNumber(n[1])?n[1]-s[1]:this._position[1],this._position[2]=caph.isNumber(n[2])?n[2]-s[2]:this._position[2],this):this._getOffsetPosition()},_invalidateOffset:function(){this._offsetPosition=null},_invalidateDescendantOffset:function(){for(var t=this.getChildren(),e=0,i=t.length;i>e;e++)t[e]._invalidateOffset(),t[e]._invalidateDescendantOffset()},_getOffsetPosition:function(){var t,e;return null==this._offsetPosition&&(e=this.getParent(),t=e?e._getOffsetPosition():[0,0,0],this._offsetPosition=[],this._offsetPosition[0]=this._position[0]+t[0],this._offsetPosition[1]=this._position[1]+t[1],this._offsetPosition[2]=this._position[2]+t[2]),[this._offsetPosition[0],this._offsetPosition[1],this._offsetPosition[2]]},_setTransformFromMatrix:function(t){function e(t){return 1e-6>Math.abs(t)?0:t}function i(t){return Math.min(Math.max(t,-1),1)}function n(t){return Math.round(100*t)/100}if(!t instanceof caph.math.Matrix4)throw Error("argument should be an caph.math.Matrix4");var s=t.clone(),o=s.get();this._position[0]=o[12],this._position[1]=o[13],this._position[2]=o[14];var r=new caph.math.Vector3;this._scale[0]=n(r.set(o[0],o[1],o[2]).length()),this._scale[1]=n(r.set(o[4],o[5],o[6]).length());var a=1/(this._scale[0]||1),h=1/(this._scale[1]||1);o[0]*=a,o[1]*=a,o[2]*=a,o[4]*=h,o[5]*=h,o[6]*=h;var c=[];c[1]=Math.asin(i(o[8])),.99999>Math.abs(o[8])?(c[0]=e(Math.atan2(-o[9],o[10])),c[2]=e(Math.atan2(-o[4],o[0]))):(c[0]=Math.atan2(o[6],o[5]),c[2]=0),this._rotation[0]=n(180*c[0]/Math.PI),this._rotation[1]=n(180*c[1]/Math.PI),this._rotation[2]=n(180*c[2]/Math.PI)},_getMatrixFromTransform:function(){var t,e,i,n=new caph.math.Matrix4,s=n.matrix;t=this._rotation[0]*Math.PI/180||0,e=this._rotation[1]*Math.PI/180||0,i=this._rotation[2]*Math.PI/180||0;var o=Math.cos(t),r=Math.sin(t),a=Math.cos(e),h=Math.sin(e),c=Math.cos(i),l=Math.sin(i),u=o*c,p=o*l,d=r*c,f=r*l;return s[0]=a*c,s[4]=-a*l,s[8]=h,s[1]=p+d*h,s[5]=u-f*h,s[9]=-r*a,s[2]=f-u*h,s[6]=d+p*h,s[10]=o*a,s[0]*=this._scale[0]||1,s[4]*=this._scale[1]||1,s[1]*=this._scale[0]||1,s[5]*=this._scale[1]||1,s[2]*=this._scale[0]||1,s[6]*=this._scale[1]||1,s[3]*=this._scale[0]||1,s[7]*=this._scale[1]||1,s[12]=this._position[0]||0,s[13]=this._position[1]||0,s[14]=this._position[2]||0,s[15]=1,n},update:function(){return this._setTransform(),this.$super()},_getTransformOriginString:function(){var t="";return(null!=this._rotationOrigin[0]||null!=this._rotationOrigin[1])&&(t=100*this._rotationOrigin[0]+"% "+100*this._rotationOrigin[1]+"%"),t},_getTransformString:function(){var t="";return(null!=this._positionOrigin[0]||null!=this._positionOrigin[1])&&(t+="translate(-"+100*this._positionOrigin[0]+"%, -"+100*this._positionOrigin[1]+"%) "),t+=null==this._position[0]?"":"translateX("+this._position[0]+"px) ",t+=null==this._position[1]?"":"translateY("+this._position[1]+"px) ",t+=null==this._position[2]?"":"translateZ("+this._position[2]+"px) ",t+=null==this._rotation[0]?"":"rotateX("+this._rotation[0]+"deg) ",t+=null==this._rotation[1]?"":"rotateY("+this._rotation[1]+"deg) ",t+=null==this._rotation[2]?"":"rotateZ("+this._rotation[2]+"deg) ",t+=null==this._scale[0]?"":"scaleX("+this._scale[0]+") ",t+=null==this._scale[1]?"":"scaleY("+this._scale[1]+") ",t+=null==this._skew[0]?"":"skewX("+this._skew[0]+"deg) ",t+=null==this._skew[1]?"":"skewY("+this._skew[1]+"deg) "},_setTransform:function(){var t;this._isTransformValid===!1&&(t=this._getTransformOriginString(),""!==t&&this.setStyle({WebkitTransformOrigin:t},{verbose:!1}),this.setStyle({WebkitTransform:this._getTransformString()},{verbose:!1}),this._isTransformValid=!0)},_invalidTransform:function(){this._isTransformValid=!1,this.setStyle({WebkitTransform:"invalid"},{verbose:!1})},_matrix:function(t){return arguments.length?(this._setTransformFromMatrix(t),this._invalidTransform(),this):this._getMatrixFromTransform()},_setter:function(){var t=[];if(arguments[0].length){t=caph.isArray(arguments[0][0])?arguments[0][0]:arguments[0];for(var e=0,i=t.length;i>e;e++)(caph.isNumber(t[e])||caph.isNull(t[e]))&&(this[e]=t[e]);return arguments[1]._invalidTransform(),!0}return!1},_getAABB:function(){for(var t=this._getVertexes(),e=this.position(),i=this.size(),n=t[0].x,s=t[0].x,o=t[0].y,r=t[0].y,a=e[0]+i[0]/2,h=e[1]+i[1]/2,c=1,l=t.length;l>c;c++)n>t[c].x&&(n=t[c].x),t[c].x>s&&(s=t[c].x),o>t[c].y&&(o=t[c].y),t[c].y>r&&(r=t[c].y);return{topLeft:[n,o],bottomRight:[s,r],center:[a,h]}},_getVertexes:function(){for(var t=this._matrix().transpose(),n=this.size(),s=new e(n[0]/2,n[1]/2,0),o=[new i(-n[0]/2,-n[1]/2,0,1),new i(n[0]/2,-n[1]/2,0,1),new i(n[0]/2,n[1]/2,0,1),new i(-n[0]/2,n[1]/2,0,1)],r=[],a=0,h=o.length;h>a;a++)r.push(o[a].applyMatrix4(t).toVector3().add(s));return r}}),s={_guideMessage:{},_parse:function(t){var e=[].slice.call(arguments,1),i=0;return t.replace(/%s/g,function(){return e[i++]})},setGuide:function(){for(var t,e=arguments[0],i=1,n=arguments.length;n>i;i++)t=arguments[i],this._guideMessage[t]=this._parse(e,t)},attrFilter:function(t,e){this._guideMessage[e]&&(console.warn(""+this._guideMessage[e]),delete this._guideMessage[e])},styleFilter:function(t,e){this._guideMessage[e]&&(console.warn(""+this._guideMessage[e]),delete this._guideMessage[e])}},o="It is deprecated to set '%s' directly. Please use 'View.position(), translate(), size()' and so on, instead.";s.setGuide(o,"left","top","bottom","right"),s.setGuide(o,"webkitTransform","WebkitTransform"),s.setGuide("For more performance, using ClassList via add/remove/has/toggleClass, or else constructor's corresponding option is recommended.","className")}(this),function(){"use strict";var t,e=caph.require("module.renderer.VDomRenderer");$class({$namespace:"caph.module.renderer.RenderEngine",$constructor:function(){return void 0!==t?this:(t=this,this._renderer=null,this._isRunning=!1,this._option={},void 0)},run:function(t){return t=t||{},"complete"===document.readyState?this._run(t):document.addEventListener("DOMContentLoaded",function(){this._run(t)}.bind(this),!1),this},_terminate:function(){this._renderer._terminate()},_create:function(){return this._renderer=e.getInstance(),this},_initialize:function(){return this},_run:function(t){this._isRunning===!1&&(caph.extend(this._option,t),this._create(),this._initialize(),this._isRunning=!0)}})}(this),function(){"use strict";var t=caph.require("module.event.Manager");$class({$namespace:"caph.ui.base.Component",$extends:caph.module.renderer.View,$mixins:[caph.module.mixins.event.Observer,caph.module.mixins.focus.Focusable],$constructor:function(t){this.$super(t),t&&t.dom instanceof Object&&(t.dom=void 0),this._initialize(),this.setOption(t||{})},_initialize:function(){this._option={},this._accessibility={},this.addClass("caph-component"),t.getInstance().addObserver(this)},setOption:function(t){void 0===t&&(t={}),t.dom instanceof Object&&this.setProperty(t.dom),t.size instanceof Array&&this.size(t.size),t.position instanceof Array&&this.position(t.position[0],t.position[1],t.position[2]),"boolean"==typeof t.enabled?this.setEnable(t.enabled):"boolean"!=typeof this._option.enabled&&this.setEnable(!0),t.on&&this.on(t.on),t.accessibility&&(this._accessibility.role=t.accessibility.role||this._accessibility.role,this._accessibility.title=t.accessibility.title||this._accessibility.title,this.setARIA(this._accessibility))},on:function(e){for(var i in e)if(e.hasOwnProperty(i)){if(i!==i.toLowerCase())throw Error("The message handler type must be a lowercase string.");this["_on"+i]=e[i]}return t.getInstance().addObserver(this),this},off:function(e){if(caph.isArray(e)){for(var i=0,n=e.length;n>i;i++)this["_on"+e[i].toLowerCase()]=null;t.getInstance().removeObserver(this,e)}else this["_on"+e.toLowerCase()]=null,t.getInstance().removeObserver(this,[e])},innerHTML:function(t){return arguments.length&&this.setProperty({innerHTML:t}),this.getProperty("innerHTML")},setARIA:function(t){return"string"==typeof t?this._accessibility.title=t||this._accessibility.title:t instanceof Object&&(this._accessibility.role=t.role||this._accessibility.role,this._accessibility.title=t.title||this._accessibility.role),this.setProperty(this._accessibility),this},getARIA:function(){return this._accessibility},setEnable:function(e){this._option.enabled!==e&&(this._option.enabled=e,e===!0?t.getInstance().addObserver(this):t.getInstance().removeObserver(this,["click","mousedown","mouseup","keydown","keyup","dblclick"]))},isEnable:function(){return this._option.enabled},_postRender:function(){t.getInstance().sendTo(this,{type:"postrender"})},_clone:function(){var e=this.$super();return e._eventObserverId=null,t.getInstance().addObserver(e),e._children.length>0&&this._recursivelyRender(e._children),e},_recursivelyRender:function(e){for(var i=e.length,n=0;i>n;n++)e[n]._eventObserverId&&(e[n]._eventObserverId=null,t.getInstance().addObserver(e[n]),e[n].__initialize()),e[n]._children.length>0&&this._recursivelyRender(e[n]._children)}})}(this),function(){"use strict";var t=/^\d+%|\d+\.\d+%$/;caph.namespace("caph.ui.base.layout.util",{isPercent:function(e){return t.test(e)},getPxArray:function(t,e){var i=[].concat(t);return i[0]=this.getPxValue(t[0],e[0]),i[1]=this.getPxValue(t[1],e[1]),i},getPxValue:function(t,e){return this.isPercent(t)&&!isNaN(e)?.01*e*t.split("%")[0]:t},isExistSize:function(t){return caph.isArray(t)&&2===t.length?!isNaN(t[0])&&!isNaN(t[1]):!1}})}(this),function(){"use strict";var t=caph.require("ui.base.Component"),e=caph.require("collection.Map"),i=caph.require("module.event.Manager"),n=caph.ui.base.layout.util;$class({$namespace:"caph.ui.base.Layout",$extends:t,$constructor:function(t){this.$super(t),this._map=new e},addChild:function(t,e){if(caph.isBlank(e))return this.$super(t);if(!(t instanceof caph.module.renderer.View))throw Error("the 1st param should be an instance of caph.module.renderer.View.");this._beforeAddChild(t,e),this.$super(t),this._map.set(t,e);var i=this.size();return n.isExistSize(i)&&(this._setChildSizePosition(t,e,i),this._setChildSizePositionByLayout(t,e,i)),this},size:function(t,e){if(arguments.length>0){var n=this.$super(),s=caph.isArray(t)?t:[t,e];return(n[0]!==s[0]||n[1]!==s[1])&&(this.$super(t,e),caph.isEmpty(this.getChildren())||i.getInstance().sendTo(this,{type:"resize",bubbles:!1})),this}return this.$super()},onresize:function(t){t.stopPropagation();var e=this.size();if(n.isExistSize(e)){var i=this.getChildren();caph.isEmpty(i)||(i.forEach(function(t){var i=this._map.get(t);i&&this._setChildSizePosition(t,i,e)},this),this._setChildSizePositionByLayout(null,null,e))}},_setChildSizePosition:function(t,e,i){e.size&&t.size(n.getPxArray(e.size,i)),e.position&&t.position(n.getPxArray(e.position,i))},_beforeAddChild:function(){},_setChildSizePositionByLayout:function(){}})}(this),function(){"use strict";var t=caph.require("ui.base.Layout"),e=caph.require("ui.base.layout.util");$class({$namespace:"caph.ui.base.layout.Absolute",$extends:t,_beforeAddChild:function(t,e){this.$super(),this._checkOption(e)},_checkOption:function(t){t=t||{},t.size&&this._checkParameter(t.size),t.position&&this._checkParameter(t.position)},_checkParameter:function(t){if(!caph.isArray(t))throw Error("The arguments should be a array.");t.forEach(function(t){if(e.isPercent(t))throw Error("The arguments must be a PX absolute value in Absolue Layout.")},this)}})}(this),function(){"use strict";var t=caph.require("ui.base.Layout");caph.require("ui.base.layout.util");var e={HALIGN:"center",VALIGN:"center",CENTER:"center",BOTTOM:"bottom",RIGHT:"right"};$class({$namespace:"caph.ui.base.layout.Float",$extends:t,addChild:function(t,e){return this.$super(t,e||{})},setOption:function(t){t=t||{},this.$super(t),this.hInterval=caph.isBlank(t.hInterval)?0:t.hInterval,this.vInterval=caph.isBlank(t.vInterval)?0:t.vInterval,this.hAlign=caph.isBlank(t.hAlign)?e.HALIGN:t.hAlign,this.vAlign=caph.isBlank(t.vAlign)?e.VALIGN:t.vAlign},_setChildSizePositionByLayout:function(t,e,i){this.$super(t,e,i),this._rowCountArray=[0],this._rowWidthArray=[0];var n=this.getChildren();caph.isEmpty(n)||(n.forEach(function(t){this._calculateRowCountAndWidth(t,i)},this),this._setChildPosition())},_calculateRowCountAndWidth:function(t,e,i){i||(i=t.size()[0]);var n=this._rowCountArray.length-1,s=this._rowWidthArray[n]+i+this.hInterval;s===e[0]?(this._rowCountArray[n]++,this._rowWidthArray[n]=s,this._rowCountArray[++n]=0,this._rowWidthArray[n]=this.hInterval):s>e[0]?(this._rowCountArray[++n]=1,this._rowWidthArray[n]=i+2*this.hInterval):(this._rowWidthArray[n]=s,this._rowCountArray[n]++)},_setChildPosition:function(){for(var t=0,i=this.vInterval,n=this.getChildren(),s=0;this._rowCountArray.length>s;s++){var o=this._rowCountArray[s],r=this._getMaxHeight(n,t,o+t),a=this.hInterval+this._getBlankWidth(s);n.forEach(function(n,s){if(s>=t&&o+t>s){var h=i,c=n.size();s>t&&(a+=this.hInterval),this.vAlign===e.CENTER?h+=(r-c[1])/2:this.vAlign===e.BOTTOM&&(h+=r-c[1]),n.position(a,h),a+=c[0],s===o+t-1&&(i+=r+this.vInterval)}},this),t+=o}},_getMaxHeight:function(t,e,i){var n=0;if(caph.isNumber(e)&&caph.isNumber(i)&&i>=e&&e>=0&&t.length>=i)for(var s=null,o=e;i>o;o++)s=t[o].size(),s[1]>n&&(n=s[1]);return n},_getBlankWidth:function(t){var i=0;return this.hAlign===e.RIGHT?i=this.size()[0]-this._rowWidthArray[t]:this.hAlign===e.CENTER&&(i=(this.size()[0]-this._rowWidthArray[t])/2),i}})}(this),function(){"use strict";var t=caph.require("ui.base.layout.Float"),e=caph.require("ui.base.layout.util"),i={HALIGN:"center",VALIGN:"center",CENTER:"center",BOTTOM:"bottom",RIGHT:"right",COLUMN_SUM:960,LARGE_SCREEN:1200,MIDDLE_SCREEN:992,SMALL_SCREEN:768,DEFAULT_COLS:{xs:960,sm:960,md:960,lg:960}};$class({$namespace:"caph.ui.base.layout.Fluid",$extends:t,addChild:function(t,e){return this.$super(t,e||{})},_calculateRowCountAndWidth:function(t,n){var s=this._map.get(t),o=caph.isBlank(s.cols)?i.DEFAULT_COLS:s.cols,r=caph.isBlank(s["max-width"])?null:s["max-width"],a=caph.isBlank(s["min-width"])?0:s["min-width"],n=this.size(),h=this._getProportion(n[0],o),c=n[0]*h;if(a>c&&(c=a),r&&c>r&&(c=r),e.isPercent(s.size[1])){var l=e.getPxArray(s.size,n);t.size([c,l[1]])}else t.size([c,t.size()[1]]);this.$super(t,n,c)},_getProportion:function(t,e){var n=i.COLUMN_SUM;return t>=i.LARGE_SCREEN&&!isNaN(e.lg)?n=e.lg:t>=i.MIDDLE_SCREEN&&!isNaN(e.md)?n=e.md:t>=i.SMALL_SCREEN&&!isNaN(e.sm)?n=e.sm:isNaN(e.xs)||(n=e.xs),n/=i.COLUMN_SUM}})}(this),function(){"use strict";var t=caph.require("ui.base.Layout"),e={PARENT_TOP:"PARENT_TOP",PARENT_BOTTOM:"PARENT_BOTTOM",PARENT_LEFT:"PARENT_LEFT",PARENT_RIGHT:"PARENT_RIGHT",CENTER_IN_PARENT:"CENTER_IN_PARENT",CENTER_HORIZONTAL:"CENTER_HORIZONTAL",CENTER_VERTICAL:"CENTER_VERTICAL",TO_LEFT_OF:"TO_LEFT_OF",TO_RIGHT_OF:"TO_RIGHT_OF",ABOVE:"ABOVE",BELOW:"BELOW",TOP:"TOP",LEFT:"LEFT",BOTTOM:"BOTTOM",RIGHT:"RIGHT"},i={PARENT_LEFT:function(t){return[t.x-t.offset,t.y]},PARENT_TOP:function(t){return[t.x,t.y+t.offset]},PARENT_RIGHT:function(t){return[t.layoutSize[0]-t.childSize[0]+t.offset,t.y]},PARENT_BOTTOM:function(t){return[t.x,t.layoutSize[1]-t.childSize[1]-t.offset]},CENTER_IN_PARENT:function(t){return[(t.layoutSize[0]-t.childSize[0])/2+t.offset,(t.layoutSize[1]-t.childSize[1])/2+t.offset]},CENTER_HORIZONTAL:function(t){return[(t.layoutSize[0]-t.childSize[0])/2+t.offset,t.y]},CENTER_VERTICAL:function(t){return[t.x,(t.layoutSize[1]-t.childSize[1])/2+t.offset]},TO_LEFT_OF:function(t){return[t.referPosition[0]-t.childSize[0]-t.offset,t.y]},TO_RIGHT_OF:function(t){return[t.referPosition[0]+t.referSize[0]+t.offset,t.y]},ABOVE:function(t){return[t.x,t.referPosition[1]-t.childSize[1]-t.offset]},BELOW:function(t){return[t.x,t.referPosition[1]+t.referSize[1]+t.offset]},TOP:function(t){return[t.x,t.referPosition[1]+t.offset]},LEFT:function(t){return[t.referPosition[0]-t.offset,t.y]},BOTTOM:function(t){return[t.x,t.referPosition[1]+t.referSize[1]-t.childSize[1]-t.offset]},RIGHT:function(t){return[t.referPosition[0]+t.referSize[0]-t.childSize[0]+t.offset,t.y]}};$class({$namespace:"caph.ui.base.layout.Relative",$extends:t,$statics:{LayoutParam:e},addChild:function(t,e){return this.$super(t,e||{})},_setChildSizePositionByLayout:function(t,e,i){this.$super(t,e,i),this.getChildren().forEach(function(t){this._setRelativeLocation(t,i)},this)},_setRelativeLocation:function(t,e){var n=this._map.get(t);if(n&&n.location){n=n.location,!caph.isArray(n)&&(n=[].concat(n));var s=null,o=null,r=[0,0],a=[0,0],h=[0,0],c=t.size();n.forEach(function(t){if(t.align){s=t.refer,o=1*t.offset,isNaN(o)&&(o=0),s&&(a=s.size(),h=s.position());var n=i[t.align];caph.isFunction(n)&&(r=n({x:r[0],y:r[1],layoutSize:e,childSize:c,referSize:a,referPosition:h,offset:o}))}}),t.position(r)}}})}(this),function(){"use strict";var t=caph.require("ui.base.Layout"),e={DEFAULT_INTERVAL:0},i={HORIZONTAL:"horizontal",VERTICAL:"vertical",FILL_PARENT:"FILL_PARENT",WRAP_CONTENT:"WRAP_CONTENT"};$class({$namespace:"caph.ui.base.layout.Linear",$extends:t,$statics:{LayoutParam:i},setOption:function(t){this.$super(t),t.fillType&&(caph.isUndefined(this._weightSum)&&(this._weightSum=0),this._widthFillType=t.fillType.width,this._heightFillType=t.fillType.height),this.direction=caph.isBlank(t.direction)?i.HORIZONTAL:t.direction,this.interval=caph.isBlank(t.interval)?e.DEFAULT_INTERVAL:t.interval},addChild:function(t,e){return this.$super(t,e||{})},_beforeAddChild:function(t,e){this.$super(t,e),(this._widthFillType===i.FILL_PARENT||this._heightFillType===i.FILL_PARENT)&&(this._weightSum+=caph.isUndefined(e.weight)?1:e.weight)},_setChildSizePositionByLayout:function(t,e,n){this.$super(t,e,n);var e,s=0,o=0,r=[0,0],a=this._widthFillType===i.FILL_PARENT||this._heightFillType===i.FILL_PARENT,h=this.getChildren(),c=1,l=(h.length-1)*this.interval;caph.isEmpty(h)||h.forEach(function(t){a&&(e=this._map.get(t),c=(e&&e.weight?e.weight:1)/this._weightSum,r=this._calculateChildSize(t,l,c,n),t.size(r)),t.position(s,o),this.direction===i.HORIZONTAL?s+=t.size()[0]+this.interval:o+=t.size()[1]+this.interval},this)},_calculateChildSize:function(t,e,n,s){var o=t.size();return this._applyFillParent(this._widthFillType,s,o,0,i.HORIZONTAL,e,n),this._applyFillParent(this._heightFillType,s,o,1,i.VERTICAL,e,n),o},_applyFillParent:function(t,e,n,s,o,r,a){t===i.FILL_PARENT&&(n[s]=e[s],this.direction===o&&(n[s]=(n[s]-r)*a))}})}(this),function(){"use strict";var t=caph.require("ui.base.Layout"),e=caph.require("ui.base.layout.util"),i={DEFAULT_COLUMN:3,DEFAULT_CELLWIDTH:200,DEFAULT_CELLHIGHT:100};$class({$namespace:"caph.ui.base.layout.Table",$extends:t,setOption:function(t){this.$super(t),this.columns=caph.isBlank(t.columns)?i.DEFAULT_COLUMN:t.columns,this.cellWidth=caph.isBlank(t.cellWidth)?i.DEFAULT_CELLWIDTH:t.cellWidth,this.cellHeight=caph.isBlank(t.cellHeight)?i.DEFAULT_CELLHIGHT:t.cellHeight},addChild:function(t,e){return this.$super(t,e||{})},_setChildSizePositionByLayout:function(t,e,i){this.$super(t,e,i),this._cells=[],this.getChildren().forEach(function(t){this._calculateItemPosition(t,i)},this)},_calculateItemPosition:function(t,i){var n=0,s=0,o=e.getPxArray([this.cellWidth,this.cellHeight],i),r=this._map.get(t);caph.isBlank(r.rowSpan)?r.rowSpan=1:r.rowSpan,caph.isBlank(r.colSpan)?r.colSpan=1:r.colSpan;var a=o[0]*r.colSpan,h=o[1]*r.rowSpan;t.size(a,h);var c=this._getNextSpace(n,s);n=c[0],s=c[1];for(var l=s;s+(r.rowSpan||1)>l;l++){!this._cells[l]&&(this._cells[l]=[]);for(var u=n;n+(r.colSpan||1)>u;u++)this._cells[l][u]=!0}var p=o[0]*(n+(r.colSpan||1)/2)-a/2,d=o[1]*(s+(r.rowSpan||1)/2)-h/2;t.position(p,d)},_getNextSpace:function(t,e){for(;t>=this.columns||this._cells[e]&&this._cells[e][t];)t>=this.columns?(e++,t=0):t++;return[t,e]}})}(this),function(){"use strict";var t=caph.require("ui.base.Layout"),e=caph.require("ui.base.layout.util"),i={isShow:!0,height:"15%"},n={isShow:!0,width:"15%"},s={DEFAULT_HEADER:i,DEFAULT_LEFT:n,DEFAULT_RIGHT:n,DEFAULT_FOOTER:i},o={HEADER:"HEADER",LEFT:"LEFT",RIGHT:"RIGHT",CONTENT:"CONTENT",FOOTER:"FOOTER"},r={HEADER:function(t,e,i){t.size=[e[0],i.headerHeight]},LEFT:function(t,e,i){t.size=[i.leftWidth,e[1]-i.headerHeight-i.footerHeight],t.position[1]=i.headerHeight},RIGHT:function(t,e,i){t.size=[i.rightWidth,e[1]-i.headerHeight-i.footerHeight],t.position=[e[0]-i.rightWidth,i.headerHeight]},FOOTER:function(t,e,i){t.size=[e[0],i.footerHeight],t.position[1]=e[1]-i.footerHeight},CONTENT:function(t,e,i){t.size=[e[0]-i.leftWidth-i.rightWidth,e[1]-i.headerHeight-i.footerHeight],t.position=[i.leftWidth,i.headerHeight]}};$class({$namespace:"caph.ui.base.template.Template",$extends:t,$constructor:function(t){for(var e in o)this[e]={};this.$super(t)},$statics:{TemplateParam:o},addChild:function(t,e){return this.$super(t,e||{})},setOption:function(t){this.$super(t),this[o.HEADER].option=t.header||s.DEFAULT_HEADER,this[o.LEFT].option=t.left||s.DEFAULT_LEFT,this[o.RIGHT].option=t.right||s.DEFAULT_RIGHT,this[o.FOOTER].option=t.footer||s.DEFAULT_FOOTER,this[o.CONTENT].option={isShow:!0}},_beforeAddChild:function(t,e){this.$super(t,e),this[e.region||o.CONTENT].object=t},_setChildSizePositionByLayout:function(t,e,i){this.$super(t,e,i);for(var n in o)this._setRegion(n,i)},_setRegion:function(t,e){var i=this[t].object;if(i){var n={size:[0,0],position:[0,0]},s=r[t];caph.isFunction(s)&&s(n,e,this._getRegionSize(e)),i.size(n.size),i.position(n.position)}},_getRegionSize:function(t){return{headerHeight:this._calRegionSize(o.HEADER,t[1]),footerHeight:this._calRegionSize(o.FOOTER,t[1]),leftWidth:this._calRegionSize(o.LEFT,t[0]),rightWidth:this._calRegionSize(o.RIGHT,t[0])}},_calRegionSize:function(t,i){var n=this[t].option;return n.isShow?e.getPxValue(n.height||n.width,i):0}})}(this),function(){"use strict";var t,e=caph.require("ui.base.layout.Absolute"),i=caph.require("module.event.Manager"),n=caph.require("event.Message"),s=caph.require("module.focus.Manager");$class({$namespace:"caph.ui.base.Scene",$extends:e,$constructor:function(e){this.$super(e),this._sceneManager=null,this._callback=null,this._preLoadFlag=!1,this.focusManager=s.getInstance(),this._lastFocus=null,this.active(!1),this._lifeStateEnum=["destroy","create","render","unrender","show","hide"],this._lifeState=this._lifeStateEnum[0],this._flagEnum={FLAG_USE_SAVE_FOCUS:!1,FLAG_USE_SHOW_ANIMATION:!0,FLAG_USE_HIDE_ANIMATION:!0,FLAG_SCENE_CLEAR_TOP:!1,FLAG_SCENE_SINGLE_TOP:!1,FLAG_SCENE_NO_HISTORY:!1},t=i.getInstance(),t.addObserver(this)},go:function(t,e,i,n){this._sceneManager.go(t,e,i,n)},back:function(t,e,i){this._sceneManager.back(t,e,i)},preLoad:function(t,e){this._sceneManager.preLoad(t,e)},setFlag:function(t,e){return this._flagEnum[t]=e,!0},getFlag:function(t){return this._flagEnum[t]},dim:function(t,e){var i=this.getDim();t===!0?(this._sceneManager._surface.addChild(i),i.show(e)):i.hide(e)},getDim:function(){return this._sceneManager._getDim()},oncreate:function(){},ondestroy:function(){},onshow:function(){},onhide:function(){},onrender:function(){},onunrender:function(){},_postRender:function(){if(this.$super(),this._preLoadFlag||"render"!==this._getLifeState())this._preLoadFlag=!1;else{var t=this._callback,e={sceneID:this._getId(),nextState:"show",cb:t};this._complete(e)}},_complete:function(e){var i=new n({type:"complete",bubbles:!1,detail:e});t.sendTo(this._sceneManager,i)},_render:function(t){this._callback=t.cb,"render"===t.nextState&&(this._preLoadFlag=!0),this._sceneManager._surface.addChild(this),this.visibility(!1)},_unrender:function(){this._sceneManager._surface.removeChild(this)},_show:function(){this.visibility(!0),this._showAnimation(),this.active(!0),this._restoreFocus(this)},_hide:function(){this._saveFocus(this),this.visibility(!1),this._hideAnimation(),this.active(!1)},_saveFocus:function(){this.getFlag("FLAG_USE_SAVE_FOCUS")===!0&&(this._lastFocus=this.focusManager.getCurrentFocus()),this.focusManager.reset()},_restoreFocus:function(){this.getFlag("FLAG_USE_SAVE_FOCUS")===!0&&null!==this._lastFocus&&this.focusManager.focus(this._lastFocus)},_showAnimation:function(){this.getFlag("FLAG_USE_SHOW_ANIMATION")===!0},_hideAnimation:function(){this.getFlag("FLAG_USE_HIDE_ANIMATION")===!0},_updateLifeState:function(t){return-1===this._lifeStateEnum.indexOf(t)?!1:(this._lifeState=t,!0)},_getLifeState:function(){return this._lifeState},_getId:function(){return this.getProperty("id")}})}(this),function(){"use strict";var t=caph.require("ui.base.Scene");$class({$namespace:"caph.ui.base.scene.Html",$extends:t,$constructor:function(t){if(this.$super(t),this.source){if(this.source.html){var e=caph.xhr(this.source.html,{method:"get",type:"TEXT",async:!1});this.innerHTML(e.value)}if(this.source.css){var i=document.getElementsByTagName("head")[0],n=document.createElement("link");n.setAttribute("href",this.source.css),n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/stylesheet"),i.appendChild(n)}}},registerKeyHandler:function(t){this._keyHandler=t,this.focusable(!0)},onkeydown:function(t){this._keyHandler&&(this._isreturnFocus=!1,this._keyHandler(t),this._isreturnFocus===!1&&t.stopPropagation())},returnFocus:function(){this._isreturnFocus=!0}})}(this),function(t){"use strict";var e=caph.require("ui.base.Component"),i=caph.require("module.event.Manager"),n=caph.require("module.focus.Manager"),s=(caph.require("module.renderer.View"),caph.require("event.Message"),{initClass:"caph-dim-init",translucentClass:"caph-dim-translucent",innerContentClass:"caph-dim-inner-content",size:[t.innerWidth,t.innerHeight],opacity:.6,backgroundColor:"#666666",duration:0,easing:"ease-out",remain:!1}),o={TRANSITION:"Transition",TRANSITION_TYPE:"all",TRANSITION_DURATION:"TransitionDuration",TRANSITION_TIMING_FUNCTION:"TransitionTimingFunction",TRANSITION_DELAY:"TransitionDelay",TRANSLATE_X:"translateX",TRANSLATE_Y:"translateY",TRANSFORM:"Transform",ANIMATION_ITERATION_COUNT:"AnimationIterationCount",REDUCE_MOVE_BACK_DURATION:4,RESET_DELAY_TIME:1.15,VENDER_PREFIX:["webkit","Moz","ms","O",""],SECOND_TO_MILLISECOND:1e3,LENGTH_UNIT:"px",TIME_UNIT:"s"};$class({$namespace:"caph.ui.base.component.Dim",$extends:e,$constructor:function(t){this.$super(t)},_initialize:function(){this.$super(),this._innerContents=null,this._opacity=null,this._background_color=null,this._duration=null,this._easing=null,this._focus_manager=n.getInstance(),this.level(9998)},setOption:function(t){this._option=this._extendOptions(s,t),this.setARIA({title:"dim",role:"dim"}),this.$super(this._option),this._create(this._option)},_create:function(){this.addClass(this._option.initClass),this.focusable(!0),this.active(!0),i.getInstance().addObserver(this)},_extendOptions:function(t,e){return caph.isBlank(e)?caph.clone(t):caph.extend(t,e,!0)},show:function(t){var e={},i=null,n=null,s=null,r=null;try{caph.isBlank(t)?(s=this._option.easing,n=this._option.duration,r=this._option.opacity,i=this._option.backgroundColor,o.VENDER_PREFIX.map(function(t){e[t+o.TRANSITION]=o.TRANSITION_TYPE+" "+n+o.TIME_UNIT+" "+s})):(s=t.easing||this._option.easing,n=t.duration||this._option.duration,r=t.opacity||this._option.opacity,i=t.backgroundColor||this._option.backgroundColor,o.VENDER_PREFIX.map(function(t){e[t+o.TRANSITION]=o.TRANSITION_TYPE+" "+n+o.TIME_UNIT+" "+s}))}catch(a){throw Error("show occur error : "+a.message)}finally{this._focus_manager.setFocusLevel(9998),this.focus(),this.setStyle(e),this.addClass(this._option.translucentClass),this.setStyle({opacity:r,backgroundColor:i}),this._option.backgroundColor=i,this._option.duration=n,this._option.easing=s,this._option.opacity=r}},hide:function(t){var e={},i=null,n=null,s=null,r=null;try{caph.isBlank(t)?(i=this._option.easing,n=this._option.duration,s=this._option.opacity,r=this._option.backgroundColor,o.VENDER_PREFIX.map(function(t){e[t+o.TRANSITION]=o.TRANSITION_TYPE+" "+n+o.TIME_UNIT+" "+i}),this.removeFromParent()):(i=t.easing||this._option.easing,n=t.duration||this._option.duration,s=t.opacity||this._option.opacity,r=t.backgroundColor||this._option.backgroundColor,o.VENDER_PREFIX.map(function(t){e[t+o.TRANSITION]=o.TRANSITION_TYPE+" "+n+o.TIME_UNIT+" "+i}),t.remain!==!0&&this.removeFromParent())}catch(a){throw Error("show occur error : "+a.message)}finally{this._focus_manager.setFocusLevel(0),this.setStyle(e),this.removeClass(this._option.translucentClass),this.setStyle({opacity:s,backgroundColor:r})}},setContent:function(t){caph.isBlank(t)||(this._innerContents&&this.removeChild(this._innerContents),t instanceof caph.module.renderer.View&&(this._innerContents=t,this._innerContents.addClass(this._option.innerContentClass),this.addChild(this._innerContents)))}})}(this),function(){"use strict";var t=caph.require("module.renderer.View");$class({$namespace:"caph.ui.base.component.Label",$extends:caph.ui.base.Component,$constructor:function(t){this.$super(t),this._createElement()},setText:function(t){return this.text=t,this._textView.setProperty({innerText:this.text}),this},getText:function(){return this.text},setAlign:function(t){return this.align.horizontal=this._setAlign(this.align.horizontal,t.horizontal),this.align.vertical=this._setAlign(this.align.vertical,t.vertical),this},setMultiLine:function(t){return this._toggleClass(!t,"single-line"),this.multiLine=t,this},setWordBreak:function(t){return this._toggleClass(t,"word-break"),this.wordBreak=t,this},setEllipsis:function(t){return this._toggleClass(t,"ellipsis"),this.ellipsis=t,this},setTextColor:function(t){return this._textView.setStyle({color:t}),this},setTextFont:function(t){return this._textView.setStyle({font:t}),this},setTextSize:function(t){return this._textView.setStyle({fontSize:t}),this},setBackgroundColor:function(t){return this.setStyle({backgroundColor:t}),this},setTextStyle:function(t){return this._textView.setStyle(t),this},size:function(t){return caph.isBlank(t)?this.$super():(this.$super(t),this._textView&&this._textView.setStyle({width:t[0]+"px",maxHeight:t[1]+"px"}),this)},setOption:function(t){this.text=t.text||"",this.align=t.align||{horizontal:"center",vertical:"middle"},this.multiLine=caph.isBlank(t.multiLine)?!0:t.multiLine,this.wordBreak=caph.isBlank(t.wordBreak)?!1:t.wordBreak,this.ellipsis=caph.isBlank(t.ellipsis)?!1:t.ellipsis,this.setARIA({role:"textbox",title:"label"}),this.$super(t)},_initialize:function(){this.$super(),this._alignView=null,this._textView=null,this.addClass("caph-label")},_createElement:function(){var e=this.size()||[0,0];this._alignView=new t,this._alignView.removeClass("caph-view"),this._alignView.addClass("caph-label-align"),this.align.horizontal&&this._alignView.addClass(this.align.horizontal),this.align.vertical&&this._alignView.addClass(this.align.vertical),this._textView=new t,this._textView.removeClass("caph-view"),this._textView.addClass("caph-label-text"),this.multiLine||this._textView.addClass("single-line"),this.wordBreak&&this._textView.addClass("word-break"),this.ellipsis&&this._textView.addClass("ellipsis"),this._textView.setProperty({innerText:this.text,style:{width:e[0]+"px",maxHeight:e[1]+"px"}}),this._alignView.addChild(this._textView),this.addChild(this._alignView)},_setAlign:function(t,e){return e&&e!==t?(this._alignView.removeClass(t),this._alignView.addClass(e),e):t},_toggleClass:function(t,e){t?this._textView.hasClass(e)||this._textView.addClass(e):this._textView.removeClass(e)}})}(this),function(){"use strict";var t,e=caph.require("ui.base.Scene"),i=caph.require("module.event.Manager"),n=caph.require("event.Message"),s=caph.require("ui.base.component.Dim");$class({$namespace:"caph.ui.base.scene.Manager",$mixins:[caph.module.mixins.event.Observer],$constructor:function(e){this._surface=e,this._currentScene=null,this._topestScene=null,this._sceneList=[],this._sceneStack=[],this._parameter=null,t=i.getInstance(),t.addObserver(this),this._dim=new s},add:function(t,i){var n={surface:this._surface,size:this._surface.size()},s=new i(n);s instanceof e&&s.setProperty({id:t}),this._register(s)},go:function(t,e,i,n){void 0!==i&&(this._parameter=i);
var s;return s="string"==typeof t?this._getSceneById(t):t,this._isRegistered(s)?(this._sceneStack.push(s._getId()),this._updateStackBySceneFlag(s),this._changeScene(e,n),!0):!1},back:function(t,e,i){return void 0!==e&&(this._parameter=e),1>this._sceneStack.length?!1:(this._sceneStack.length>1&&this._sceneStack.pop(),this._topestScene=this._getSceneById(this._sceneStack[this._sceneStack.length-1]),this._changeScene(t,i),!0)},preLoad:function(t,e){var i;return i="string"==typeof t?this._getSceneById(t):t,this._isRegistered(i)||this._register(i),this._isRegistered(i)?(this._updateLifeCycle(i,"render",e),!0):!1},setMainScene:function(t){this._mainScene=void 0===t?this._sceneList[0]:this._getSceneById(t),this._sceneStack.push(this._mainScene._getId()),this._updateStackBySceneFlag(this._mainScene),this._updateLifeCycle(this._mainScene,"show")},oncomplete:function(t){var i=this._getSceneById(t.detail.sceneID),n=t.detail.nextState,s=t.detail.cb;i instanceof e&&this._updateLifeCycle(i,n,s)},_getMainScene:function(){return this._mainScene},_getSceneById:function(t){for(var e=0,i=this._sceneList.length;i>e;e++){var n=this._sceneList[e];if(n._getId()===t)return n}},_getDim:function(){return this._dim},_changeScene:function(t,e){if(null!==this._currentScene&&this._topestScene._getId()!==this._currentScene._getId()){var i=this._topestScene._getLifeState();("destroy"===i||"unrender"===i)&&this._updateLifeCycle(this._topestScene,"show",e),t&&this._currentScene._getId()!==this._mainScene._getId()?this._updateLifeCycle(this._currentScene,"unrender"):this._updateLifeCycle(this._currentScene,"hide"),("hide"===i||"render"===i)&&this._updateLifeCycle(this._topestScene,"show",e)}},_isPreRendered:function(t){return"render"===t._getLifeState()?!0:!1},_isRegistered:function(t){var e=this._sceneList.indexOf(t);return-1===e?!1:!0},_updateStackBySceneFlag:function(t){if(t.getFlag("FLAG_SCENE_SINGLE_TOP")===!0&&this._sceneStack.length>1)for(var e=1,i=this._sceneStack.length;i>e;e++)this._sceneStack[e]===t._getId()&&this._sceneStack[e]===this._sceneStack[e-1]&&(this._sceneStack.splice(e,1),i--,e--);if(t.getFlag("FLAG_SCENE_CLEAR_TOP")===!0&&this._sceneStack.length>1){for(var n,e=0,s=this._sceneStack.length;s>e;e++)this._sceneStack[e]!==t._getId()||n||(n=e);this._sceneStack.splice(n+1,this._sceneStack.length-n-1)}this._topestScene=this._getSceneById(this._sceneStack[this._sceneStack.length-1]),t.getFlag("FLAG_SCENE_NO_HISTORY")===!0&&this._sceneStack.pop()},_register:function(t){return this._isRegistered(t)?!1:(this._sceneList.push(t),t._sceneManager=this,!0)},_deRegister:function(t){if(this._isRegistered(t)){var e=this._sceneList.indexOf(t);return this._sceneList.splice(e,1),!0}return!1},_updateLifeCycle:function(t,e,i){var n=t._getLifeState();n!==e?this._next(t,e,i):"function"==typeof i&&(t.update(),i())},_next:function(e,i,s){var o=e._getId();switch(e._getLifeState()){case"destroy":e._updateLifeState("create");var r={sceneID:o,nextState:i,cb:s},a=new n({type:"create",bubbles:!1,detail:r});t.sendTo(e,a),e._complete(r);break;case"create":e._updateLifeState("render"),e.requestPostRender();var r={sceneID:o,nextState:i,cb:s},a=new n({type:"render",bubbles:!1,detail:r});t.sendTo(e,a),e._render(r);break;case"render":e._updateLifeState("show"),this._currentScene=e;var r={sceneID:o,nextState:i,cb:s};null!==this._parameter&&(r.parameter=this._parameter,this._parameter=null);var a=new n({type:"show",bubbles:!1,detail:r});t.sendTo(e,a),e._show(),e._complete(r);break;case"show":e._updateLifeState("hide");var r={sceneID:o,nextState:i,cb:s},a=new n({type:"hide",bubbles:!1,detail:r});t.sendTo(e,a),e._hide(),e._complete(r);break;case"hide":if("show"===i){e._updateLifeState("show"),this._currentScene=e;var r={sceneID:o,nextState:i,cb:s};null!==this._parameter&&(r.parameter=this._parameter,this._parameter=null);var a=new n({type:"show",bubbles:!1,detail:r});t.sendTo(e,a),e._show(),e._complete(r)}else if("unrender"===i){e._updateLifeState("unrender");var r={sceneID:o,nextState:i,cb:s},a=new n({type:"unrender",bubbles:!1,detail:r});t.sendTo(e,a),e._unrender(),e._complete(r)}break;case"unrender":e._updateLifeState("render"),e.requestPostRender();var r={sceneID:o,nextState:i,cb:s},a=new n({type:"render",bubbles:!1,detail:r});t.sendTo(e,a),e._render(r);break;default:}}})}(this),function(){"use strict";caph.require("module.renderer.VDom");var t=caph.require("module.renderer.View");$class({$namespace:"caph.ui.base.component.Surface",$extends:t,type:"caph-surface",$constructor:function(t){this.$super(t),this._option={size:t.size},this.size(t.size),this._sceneManager=null},go:function(t,e,i,n){null!==this._sceneManager&&this._sceneManager.go(t,e,i,n)},back:function(t,e,i){null!==this._sceneManager&&this._sceneManager.back(t,e,i)},_setSceneManager:function(t){null===this._sceneManager&&t instanceof caph.ui.base.scene.Manager&&(this._sceneManager=t)},_getSceneManager:function(){return this._sceneManager}})}(this),function(t){"use strict";var e=caph.require("ui.base.Component"),i=caph.require("module.renderer.View"),n=(caph.require("event.Message"),{progress:0,increment:.1,position:[t.innerWidth/2-250,t.innerHeight/2,0],size:[500,2]}),s={MIN_INCREMENT:0,MIN_PROGRESS:0,MAX_PROGRESS:1,MAX_INCREMENT:1};$class({$namespace:"caph.ui.base.component.ProgressBar",$extends:e,$constructor:function(t){this.$super(t)},_initialize:function(){this.$super(),this.thread=null,this.body=new i,this.label=new i},setOption:function(t){this._option=caph.isBlank(t)?caph.clone(n):caph.extend(n,t,!0),this.setARIA({title:"progressbar",role:"progressbar"}),this.$super(this._option),this.focusable(!1),this._create()},setIncrement:function(t){if(caph.isBlank(this.body)&&caph.isBlank(this.label))return!1;if(caph.isBlank(t)||!caph.isNumber(t)||s.MIN_INCREMENT>t||t>s.MAX_INCREMENT)return!1;try{return this._option.increment=t,!0}catch(e){return console.log(e),!1}},getIncrement:function(){return this._option.increment},setCurrentProgress:function(t){if(caph.isBlank(this.body)&&caph.isBlank(this.label))return!1;if(t=Math.round(1e3*t)/1e3,caph.isBlank(t)||!caph.isNumber(t)||s.MIN_PROGRESS>t)return!1;try{return t>s.MAX_PROGRESS&&(t=s.MAX_PROGRESS),this._option.progress=t,this._run(!1),!0}catch(e){return console.log(e),!1}},getCurrentProgress:function(){return this._option.progress-this._option.increment},_run:function(t){0===arguments.length&&(t=!0);try{this._option.progress=Math.round(1e3*this._option.progress)/1e3;var e=null;return this._option.progress<s.MAX_PROGRESS?e=Math.round(this._option.size[0]*this._option.progress):(this._option.progress=s.MAX_PROGRESS,e=this._option.size[0]),this.body.setStyle({width:e+"px"}),this._option.progress>=s.MAX_PROGRESS?this._complete():(!caph.isBlank(this._option.increment)&&caph.isNumber(this._option.increment)&&t&&(this._option.progress+=this._option.increment),this._update())}catch(i){throw Error("progressbar : _run occur error : "+i.message)}},_create:function(){var t=this,e=this.body,i=this.label,n=t._option.size;e.setStyle({width:"0px",height:n[1]+"px"}),t.addChild(i),t.addChild(e),this._run()},_update:function(){if(caph.isBlank(this.body)&&caph.isBlank(this.label))return!1;try{var t=new caph.event.Message({type:"update",detail:{data:this._option.progress}});return this._onupdate(t),this._option.progress+=this._option.increment}catch(e){return Error("progressbar : _update occur error : "+e.message),!1}},_complete:function(){if(caph.isBlank(this.body)&&caph.isBlank(this.label))return!1;try{caph.isBlank(this.thread)||(clearInterval(this.thread),this.thread=null);var t=new caph.event.Message({type:"complete",detail:{data:this._option.progress}});return this._oncomplete(t),this._option.progress}catch(e){return Error("progressbar : _complete occur error : "+e.message),!1}}})}(this),function(){"use strict";caph.require("module.event.Manager"),$class({$namespace:"caph.ui.base.component.Icon",$extends:caph.ui.base.Component,$constructor:function(t){this.$super(t),this.addClass(this._prefix+this._type)},setOption:function(t){if(!t.type)throw Error('IllegalArgumentError: The "caph.ui.base.component.Icon" needs to know the icon type. Please identify that the "type" property has been passed.');this._type=t.type,this._prefix=t.prefix||"caph-icon-",this.setARIA({role:"button",title:"icon"}),this.$super(t)}})}(this),function(){"use strict";var t=caph.require("module.renderer.View"),e=caph.require("module.event.Manager");$class({$namespace:"caph.ui.base.component.Button",$extends:caph.ui.base.Component,$constructor:function(t){this.$super(t)},_initialize:function(){this.$super(),this.addClass("caph-button"),this.addClass("normal"),this.focusable(!0)},setOption:function(t){this.$super(t),t&&(t.contents&&this.setContent(t.contents),t.align&&this.setAlign(t.align))},setAlign:function(t){if(t&&(t=t.replace(/\s+/g,""),this._option.align=t,this._option.contents&&caph.isFunction(this._option.contents.setAlign)))for(var e=t.split("|"),i=0;e.length>i;i++)this._option.contents.setAlign(this,e[i]);return this},setContent:function(e){if(e&&e instanceof t){if(e===this._option.contents)return this;this._option.contents&&this.removeChild(this._option.contents),e._isTypeOfFocusable===!0&&e.focusable(!1),this._option.contents=e._clone(),this.addChild(this._option.contents)}return this},setEnable:function(t){return this.$super(t),t===!0?this.removeClass("disable"):this.addClass("disable"),this},onfocus:function(t){if(this.addClass("focus"),this._option.contents instanceof caph.ui.base.Component){var i={detail:t.detail,source:this._option.contents,type:"focus",bubbles:!1};e.getInstance().sendTo(this._option.contents,i)}},onblur:function(t){if(this.removeClass("focus"),this.hasClass("select")&&this.removeClass("select"),this._option.contents instanceof caph.ui.base.Component){var i={detail:t.detail,source:this._option.contents,type:"blur",bubbles:!1};e.getInstance().sendTo(this._option.contents,i)}},onkeydown:function(t){this.isEnable()&&t.key().enter&&this.addClass("select")},onkeyup:function(t){this.isEnable()&&t.key().enter&&this.removeClass("select")},onmousedown:function(){this.isEnable()&&this.addClass("select")},onmouseup:function(){this.isEnable()&&this.removeClass("select")}})}(this),function(){"use strict";$class({$namespace:"caph.ui.base.component.Sprite",$extends:caph.ui.base.Component,$constructor:function(t){this.$super(t)},_initialize:function(){this.$super(),this._option.frame=[],this.addClass("caph-sprite")},setOption:function(t){this.$super(t),t.frame&&this.addFrame(t.frame),t.src&&(this._option.src=t.src,this.setStyle({"background-image":'url("'+t.src+'")'})),this._option.duration=t.duration||this._option.duration||66},_separateFrame:function(t){if("horizontal"===t.direction)for(var e=0;t.number>e;e++)this.addFrame({x:t.x+t.width*e,y:t.y,width:t.width,height:t.height});else if("vertical"===t.direction)for(var e=0;t.number>e;e++)this.addFrame({x:t.x,y:t.y+t.height*e,width:t.width,height:t.height})},addFrame:function(t){if(t instanceof Array)for(var e=t.length,i=0;e>i;i++)this._option.frame.push(t[i]);else t.direction?this._separateFrame(t):"object"==typeof t&&this._option.frame.push(t);return this},getFrame:function(t){return"number"==typeof t?this._option.frame[t]:this._option.frame},removeFrame:function(t){return t?this._option.frame.splice(t,1):this._option.frame=[],this},setDuration:function(t){return this._option.duration=t,this},getDuration:function(){return this._option.duration},run:function(){var t=this,e=0,i=this.getFrame().length;this._option.timer||(this._option.settingTimer=setInterval(function(){"number"!=typeof i||0===i?(e=0,i=t.getFrame().length):(t._option.timer=setInterval(function(){t._setFrame(e),e=(e+1)%i},t._option.duration),clearInterval(t._option.settingTimer))},100))},stop:function(){this._option.settingTimer&&(clearInterval(this._option.settingTimer),this._option.settingTimer=null),this._option.timer&&(clearInterval(this._option.timer),this._option.timer=null)},_setFrame:function(t){var e=t?t:0,i=this.getFrame(e);i&&(i.width&&this.size([i.width,i.height]),this.setStyle({"background-position":-1*i.x+"px "+-1*i.y+"px"}))}})}(this),function(){"use strict";caph.require("module.renderer.View");var t={baseCls:"caph-checkbox",selectedCls:"select",checkWithoutBoxCls:"check",focusCls:"focus"};$class({$namespace:"caph.ui.base.component.Checkbox",$extends:caph.ui.base.Component,$constructor:function(t){this.$super(t)},_initialize:function(){this.$super(),this.setARIA({title:"checkbox",role:"checkbox"}),this.addClass(t.baseCls),this.focusable(!0),this._option.hasBox=!0,this._option.checked=!1},setOption:function(t){this.$super(t),t&&caph.extend(this._option,t),this._setClass()},setChecked:function(t){caph.isBoolean(t)&&(this._option.checked=t,this._setClass(),this._stateChange())},isChecked:function(){return this._option.checked},onfocus:function(){this.addClass(t.focusCls)},onblur:function(){this.removeClass(t.focusCls)},onclick:function(){this.isEnable()&&this.setChecked(!this._option.checked)},onkeydown:function(t){this.isEnable()&&t.key().enter&&this.setChecked(!this._option.checked)},_setClass:function(){caph.isBoolean(this._option.checked)&&(this._option.checked?(this.addClass(t.selectedCls),this._option.hasBox?this.removeClass(t.checkWithoutBoxCls):this.addClass(t.checkWithoutBoxCls)):(this.removeClass(t.selectedCls),this._option.hasBox?this.removeClass(t.checkWithoutBoxCls):this.addClass(t.checkWithoutBoxCls)))},_stateChange:function(){try{var t=new caph.event.Message({type:"statechange",detail:{state:this._option.checked}});this._onstatechange(t)}catch(e){return Error("checkbox : _statechange occur error : "+e.message),!1}}})}(this),function(){"use strict";caph.require("module.event.Manager");var t=["small","medium","large"],e=["left","right","up","down"];$class({$namespace:"caph.ui.base.component.Indicator",$extends:caph.require("ui.base.Component"),$constructor:function(t){this.$super(t),this._initCssClass()},setEnable:function(t){return this.$super(t),t?this.removeClass("disabled"):this.addClass("disabled"),this},setOption:function(i){if(this.setARIA({title:"button",role:"button"}),this.indicatorClass=i.indicatorClass,null==i.type||void 0==i.type||-1==t.indexOf(i.type.toLowerCase()))throw Error("IllegalArgumentError: The value of property.type should be only small, medium and large.");if(this.type=i.type,null==i.direction||void 0==i.direction||-1==e.indexOf(i.direction.toLowerCase()))throw Error("IllegalArgumentError: The value of property.direction should be only left, right, up and down.");this.direction=i.direction,this.$super(i)},onfocus:function(){this.addClass("focused")},onblur:function(){this.removeClass("focused")},_initialize:function(){this.$super(),this.focusable(!0)},_initCssClass:function(){this.addClass(this.indicatorClass),this.addClass(this.type),this.addClass(this.direction)}})}(this),function(t){"use strict";var e=caph.require("ui.base.Component"),i=caph.require("ui.base.component.Dim"),n=caph.require("ui.base.component.Label"),s=caph.require("module.renderer._VDomLookUpTable"),o=caph.require("module.focus.Manager");caph.require("module.event.Manager");var r="caph-{themeName}-popupbg-",a=["topleft","topcenter","topright","middleleft","middlecenter","middleright","bottomleft","bottomcenter","bottomright"],h=[{type:"MessagePopup",shape:["message","message","message"],paddingWidth:34,paddingTop:108,paddingBottom:34,messageMarginTop:98,messageMarginWidth:54,messageMarginBottom:80,buttonAreaHeight:124,useCloseFunc:!1},{type:"PushPopup",shape:["push","message","message"],paddingWidth:34,paddingTop:92,paddingBottom:34,messageMarginTop:50,messageMarginWidth:54,messageMarginBottom:80,buttonAreaHeight:0,useCloseFunc:!1}];$class({$namespace:"caph.ui.base.component.Popup",$extends:caph.require("ui.base.Component"),$constructor:function(t){this.$super(t),this._initTypeInfo(t),this._create(t),this.active(!1)},setOption:function(e){this.Button=e._theme_button,this._theme_name=e._theme_name,this._theme_dimOpacity=e._theme_dimOpacity,this._theme_dimColor=e._theme_dimColor,this._theme_popupOpacity=e._theme_popupOpacity,this._theme_popupColor=e._theme_popupColor,this._theme_enableWidth=e._theme_enableWidth,this._theme_usePopupImage=e._theme_usePopupImage,r=r.replace("{themeName}",this._theme_name),this._popupType=e.popupType||null,this._arrCreateButton=[],this._width=e.width||600,this._height=e.height||400,"ALERT"==this._popupType||"CONFIRM"==this._popupType?(this._useButtonArea=!0,this._messageTextAlign="center",this._bgType="MessagePopup",this._bgOpacity=.8,this._useCloseFunc=!0,600>this._width&&(this._width=600),400>this._height&&(this._width=400)):(this._useButtonArea=e.useButtonArea||!1,this._messageTextAlign=e.messageTextAlign||"center",this._bgType=e.bgType||"MessagePopup",this._bgOpacity=e.bgOpcity||.8,this._isBgAlphaType=e.isBgAlphaType||!1,this._useCloseFunc=e.useCloseFunc||!1),this._theme_enableWidth||(this._width=t.innerWidth),this._callback=e.callback,this.$super(e)},setTitle:function(t){return this.popupTitleBox.setText(t),this},setMessageText:function(t){return this.popupMessageBox.setProperty({innerText:t}),this},getTitleAreaLabel:function(){return this.popupTitleBox},getMessageAreaComponent:function(){return this.popupMessageBox},getButtonAreaComponent:function(){return this.popupButtonBox},show:function(){this._showPopup(!0)},close:function(){this._showPopup(!1)},onpostrender:function(){for(var t=this;null!=t._parent;)t=t._parent;if(t.addChild(this),!this._useCloseFunc){var e=this,i=new caph.dom.Element(s.getInstance().getDom(this));i.bind("click",function(){e.close()})}},onkeydown:function(){this._useCloseFunc||this.close()},onclick:function(){this._useCloseFunc||this.close()},_initialize:function(){this.$super(),this.focusable(!0),this.requestPostRender()},_initTypeInfo:function(){for(var t=0;h.length>t&&h[t].type!=this._bgType;t++);t>=h.length&&(t=2),this._typeInfo=h[t],this.arrShapeElem=[];for(var t=0;9>t;t++)this.arrShapeElem.push(r+this._typeInfo.shape[Math.floor(t/3)]+(this._isBgAlphaType?"A":"N")+"-"+a[t])},_create:function(s){var o=this._typeInfo;this.x(0),this.y(0),this.visibility(!1),this.setStyle({"z-index":"9999"});var r=(t.innerWidth-this._width)/2,a=(t.innerHeight-this._height-o.paddingTop-o.paddingBottom)/2;if(this.popupOuter=new e,this.popupOuter.position(r,a),this.popupOuter.level(2).setStyle({"z-index":"9999",backgroundColor:this._theme_popupColor,opacity:this._theme_popupOpacity,width:this._width+"px",height:this._height+"px"}),this.addChild(this.popupOuter),this.popupTitleBox=new n({size:[this._width-2*o.messageMarginWidth,96],position:[o.messageMarginWidth,0],dom:{style:{borderBottom:"1px solid rgba(255, 255, 255, 0.3)"}}}).setTextColor("#ffffff").setTextFont('46pt "Samsung SVD_Medium"'),this.popupOuter.addChild(this.popupTitleBox),this._theme_usePopupImage){for(var h=0;9>h;h++){var c=new e;c.addClass(this.arrShapeElem[h]),c.setStyle({opacity:this._theme_popupOpacity}),this.popupOuter.addChild(c),this.arrShapeElem[h]=c}this._setStyleArray("CENTER",{width:this._width-2*o.paddingWidth+"px"},{x:o.paddingWidth}),this._setStyleArray("RIGHT",null,{x:this._width-o.paddingWidth}),this._setStyleArray("MIDDLE",{height:this._height-o.paddingTop-o.paddingBottom+"px"},{y:o.paddingTop}),this._setStyleArray("BOTTOM",null,{y:this._height-o.paddingBottom})}var l=this._useButtonArea?o.buttonAreaHeight:o.messageMarginBottom;this.popupMessageBox=new e,this.popupMessageBox.position(o.messageMarginWidth,o.messageMarginTop),this.popupMessageBox.setStyle({border:"","text-align":this._messageTextAlign,overflow:"hidden",width:this._width-2*o.messageMarginWidth+"px",height:this._height-o.messageMarginTop-l+"px","font-size":"21pt",color:"#ffffff"}),this.popupOuter.addChild(this.popupMessageBox),this.popupButtonBox=new e,this.popupButtonBox.position(o.messageMarginWidth,this._height-l),this._useButtonArea?this.popupButtonBox.setStyle({border:"",overflow:"hidden",width:this._width-2*o.messageMarginWidth+"px",height:l+"px","font-size":"21pt",color:"#ffffff"}):this.popupButtonBox.visibility(!1),this.popupOuter.addChild(this.popupButtonBox);var u=t.innerHeight>=1080;if("ALERT"==this._popupType){var p=s.buttonContent;caph.isString(p)||(p="OK"),this._createButton(this._width/2-(u?175:150),p)}else if("CONFIRM"==this._popupType){var p=s.buttonContent;caph.isArray(p)&&2==p.length||(p=["YES","NO"]),this._createButton(this._width/2-(u?325:250),p[0],!0),this._createButton(this._width/2-(u?25:50),p[1],!1)}else{var p="CLOSE";this._createButton(this._width/2-(u?175:150),p)}this.layerDim=new i({opacity:this._theme_dimOpacity,backgroundColor:this._theme_dimColor}),this.layerDim.setStyle({"z-index":"9998"}),this.addChild(this.layerDim)},_createButton:function(t,e,i){var n=this,s=function(){"function"==typeof n._callback&&n._callback(i),n.close()},o=new this.Button({position:[t,25]});o.setContent(e).level(2),o.on({click:function(){s()},keydown:function(t){t.key().enter&&s()}}),this._useCloseFunc||o.visibility(!1),this.popupButtonBox.addChild(o),this._arrCreateButton.push(o)},_setStyleArray:function(t,e,i){var n=["LEFT","CENTER","RIGHT","TOP","MIDDLE","BOTTOM"].indexOf(t);if(!(0>n)){var s=2>=n?3:1;1==s&&(n=3*(n-3));for(var o=n;n+2*s>=o;o+=s)(void 0!=e||null!=e)&&this.arrShapeElem[o].setStyle(e),void 0!=i.x&&this.arrShapeElem[o].x(i.x),void 0!=i.y&&this.arrShapeElem[o].y(i.y)}},_enableInnerButton:function(t){if(null!=t&&void 0!=t)for(var e=0;this._arrCreateButton.length>e;e++)this._arrCreateButton[e].focusable(t)},_showPopup:function(t){this.active(t),this.visibility(t),t?(this.layerDim.show(),o.getInstance().setFocusLevel(2),this._arrCreateButton[0].focus()):(this.layerDim.hide({remain:!0}),caph.module.focus.Manager.getInstance().setFocusLevel(0))}})}(this),function(){"use strict";var t=caph.require("module.event.Manager"),e=caph.require("module.renderer.View");$class({$namespace:"caph.ui.base.component.Slider",$extends:caph.require("ui.base.Component"),$constructor:function(t){this.$super(t),this._create(t)},setOption:function(t){this.$super(t),this.setARIA({title:"slider",role:"slider"}),this._isBarImgSplit=t._isBarImgSplit,this._sliderBarClass=t._sliderBarClass,this._sliderFocusClass=t._sliderFocusClass;var e=t.step||10;"number"!=typeof e&&(e=10),1!=e&&10!=e&&(e=10),this._isEnter=!1,this.width=t.width||50,this.selectedValue=t.value||0,this.step=e,this.thisFocusClass="","number"!=typeof this.width&&(this.width=50,t.width=50),50>this.width&&(this.width=50,t.width=50),"number"!=typeof this.selectedValue&&(this.selectedValue=0),0>this.selectedValue?this.selectedValue=0:this.selectedValue>this.width&&(this.selectedValue=this.width),this._isUseMouse=t._isUseMouse,this._isUseKey=t._isUseKey,caph.isBlank(this._isUseMouse)&&(this._isUseMouse=!0),caph.isBlank(this._isUseKey)&&(this._isUseKey=!0)},getSelectedValue:function(){return this.selectedValue},setSelectedValue:function(e){return e>=0&&this.width>=e&&this.selectedValue!==e&&(this.selectedValue=e,this._renderBar(),t.getInstance().sendTo(this,{type:"change",detail:this.selectedValue})),this},onfocus:function(){this._changeFoucsClass("focused")},onblur:function(){this._setEnterStatus(!1),this._changeFoucsClass("normal")},onkeydown:function(t){if(this._isUseKey){var e=t.key();if(e.enter)return this._setEnterStatus(),t.stopPropagation(),void 0;if(this._isEnter){if(this._isMoveKey(e)){var i=this.step*(e.left?-1:1),n=this.selectedValue+i;n>=0&&this.width>=n&&this._setSelectedValue(i)}t.stopPropagation()}}},onmousedown:function(t){if(this._isMouseMove=t.source==this.focus){var e=t.mouse();this._correctionValue=e.clientX-e.offsetX-this.selectedValue}},_initialize:function(){this.$super(),this.focusable(!0),caph.window.bind("mousemove",function(t){if(this._isUseMouse&&this._isMouseMove){var e=t.clientX-this.focus.x()-10-this._correctionValue;return 0>e?this.setSelectedValue(0):e>this.width?this.setSelectedValue(this.width):(this.focusBox.x(e),this.setSelectedValue(e)),t.preventDefault(),t.stopPropagation(),!1}}.bind(this)),caph.window.bind("mouseup",function(){this._isMouseMove=!1,this._correctionValue=0}.bind(this))},_create:function(t){this.addClass("caph-slider-normal"),this.setStyle({width:t.width+25+"px"}),this.bar=new e,this._appendChild(this.bar,this,this._sliderBarClass+"unselected",{x:9,y:9},{width:this.width+"px"}),this._isBarImgSplit&&(this._appendChild(null,this.bar,this._sliderBarClass+"unselected-left",{x:-6,y:0},null),this._appendChild(null,this.bar,this._sliderBarClass+"unselected-right",{x:this.width,y:0},null)),this.barSelected=new e,this._appendChild(this.barSelected,this,this._sliderBarClass+"selected",{x:9,y:9},{width:this.selectedValue+"px"}),this._isBarImgSplit&&(this._appendChild(null,this.barSelected,this._sliderBarClass+"selected-left",{x:-6,y:0},null),this.barSelectedRight=new e,this._appendChild(this.barSelectedRight,this.barSelected,this._sliderBarClass+"selected-right",{x:this.selectedValue,y:0},null)),this.focusBox=new e,this.addChild(this.focusBox),this.focus=new e,this.focusBox.addChild(this.focus),this.focus.position(0,0),this.arrowLeft=new e,this._appendChild(this.arrowLeft,this.focusBox,this._sliderFocusClass+"focused-left",null,{visibility:"hidden"}),this.arrowRight=new e,this._appendChild(this.arrowRight,this.focusBox,this._sliderFocusClass+"focused-right",null,{visibility:"hidden"}),this._changeFoucsClass("normal"),this._renderBar()},_appendChild:function(t,i,n,s,o){null==t&&(t=new e),i.addChild(t),t.addClass(n),t.setStyle(o),s&&t.position(s.x,s.y)},_changeFoucsClass:function(t){""!=this.thisFocusClass&&this.focus.removeClass(this.thisFocusClass),this.thisFocusClass=this._sliderFocusClass+t,this.focus.addClass(this.thisFocusClass)},_setSelectedValue:function(e){this.selectedValue+=e,0>this.selectedValue&&(this.selectedValue=0),this.selectedValue>this.width&&(this.selectedValue=this.width),this._renderBar(),t.getInstance().sendTo(this,{type:"change",detail:this.selectedValue})},_setEnterStatus:function(t){this._isEnter=void 0==t?!this._isEnter:t,this.arrowLeft.visibility(this._isEnter),this.arrowRight.visibility(this._isEnter)},_renderBar:function(){this.focusBox.x(this.selectedValue),this.barSelected.setStyle({width:this.selectedValue+"px"}),this._isBarImgSplit&&this.barSelectedRight.x(this.selectedValue)},_isMoveKey:function(t){return t.left||t.right}})}(this),function(){"use strict";var t=caph.require("module.renderer.View");$class({$namespace:"caph.ui.base.component.Tooltip",$extends:caph.ui.base.Component,$constructor:function(t){this.$super(t),this._createElement()},$statics:{TOP:"top",LEFT:"left",RIGHT:"right",BOTTOM:"bottom",CENTER:"center"},size:function(t){return caph.isBlank(t)?this.$super():(this.setWidth(t[0]),this.setHeight(t[1]),this)},setWidth:function(t){return this._setSize("width",t),this},setHeight:function(t){return this._setSize("height",t),this},setText:function(t){var e=this.size();return this.text=t,this._view.text.setProperty({innerHTML:'<div style="max-width: '+e[0]+"px; max-height:"+e[1]+'px">'+this.text+"</div>"}),this},setTextFont:function(t){return this._view.text.setStyle({font:t}),this},setTextStyle:function(t){return this._view.text.setStyle(t),this},setTimeout:function(t){return this.timeout=t,this},setTailDirection:function(t){if(this.tailDirection===t)return this;var e=this._view.tail;return e.removeClass(this.tailClassPrefixName+this.tailDirection),e.addClass(this.tailClassPrefixName+(this.tailDirection=t)),this._setTailViewSize(e,this.size()),this},setTailAlign:function(t){if(this.tailAlign===t)return this;var e=this._view.tail;return e.removeClass(this.tailAlign),e.addClass(this.tailAlign=t),this},show:function(){return this._handle&&clearTimeout(this._handle),this.addClass("show"),this.timeout>0&&(this._handle=setTimeout(function(){this.hide()}.bind(this),this.timeout)),this},hide:function(){return this.removeClass("show"),this._handle&&clearTimeout(this._handle),this},setOption:function(t){this.text=t.text||"",this.timeout=caph.isBlank(t.timeout)?5e3:t.timeout,this.tailDirection=t.tailDirection||caph.ui.base.component.Tooltip.BOTTOM,this.tailAlign=t.tailAlign||caph.ui.base.component.Tooltip.CENTER,this.textClassName=t.textClassName||"caph-tooltip-text",this.tailClassPrefixName=t.tailClassPrefixName||"caph-tooltip-tail-",this.setARIA({role:"tooltip",title:"tooltip"}),this.$super(t)},_initialize:function(){this.$super(),this._view={},this._handle,this.addClass("caph-tooltip")},_createElement:function(){var t=this.size();this.addChild(this._view.text=this._createTextView(t)),this.addChild(this._view.tail=this._createTailView(t))},_createTextView:function(e){var i=new t;return i.removeClass("caph-view"),i.addClass(this.textClassName),i.setProperty({innerHTML:'<div style="max-width: '+e[0]+"px; max-height:"+e[1]+'px">'+this.text+"</div>"}),i.setStyle({width:e[0]+"px",height:e[1]+"px"}),i},_createTailView:function(e){var i=new t;return i.removeClass("caph-view"),i.addClass(this.tailClassPrefixName+this.tailDirection),i.addClass(this.tailAlign),this._setTailViewSize(i,e),i},_setTailViewSize:function(t,e){switch(this.tailDirection){case caph.ui.base.component.Tooltip.TOP:case caph.ui.base.component.Tooltip.BOTTOM:t.setStyle({width:e[0]+"px",height:""});break;case caph.ui.base.component.Tooltip.LEFT:case caph.ui.base.component.Tooltip.RIGHT:t.setStyle({width:"",height:e[1]+"px"})}},_setSize:function(t,e){var i=this._view.text,n=this._view.tail,s={};s[t]=e+"px",this.setStyle(s),i&&i.setStyle(s),n&&this._setTailViewSize(n,this.size())}})}(this),function(){"use strict";var t=caph.require("module.renderer.View"),e=caph.require("module.event.Manager"),i="arrow",n="left",s="right",o="hidden",r="rating",a="star",h="full",c="half";$class({$namespace:"caph.ui.base.component.Rating",$extends:caph.ui.base.Component,$constructor:function(t){this.$super(t),this._createElement(),["caph-rating",this.className].forEach(this.addClass.bind(this))},$statics:{MIN:0,MAX:5,MIN_INCREMENTS:.5,MAX_INCREMENTS:1},setIncrements:function(t){return this.increments=t===caph.ui.base.component.Rating.MIN_INCREMENTS||t===caph.ui.base.component.Rating.MAX_INCREMENTS?t:caph.ui.base.component.Rating.MIN_INCREMENTS,this},getRatingValue:function(){return this.rating},setRatingValue:function(t){return t=this._normalizeNumber(t,caph.ui.base.component.Rating.MIN,caph.ui.base.component.Rating.MAX),this.rating===t?this:(this.rating=t,this._hideArrow(this._view[n],this._view[s]),this._initStar(this._view[r]),e.getInstance().sendTo(this,{type:"change"}),this)},setEnable:function(t){return this.$super(t),t?(this._view[n]&&this._view[n].removeClass("disabled"),this._view[s]&&this._view[s].removeClass("disabled")):(this._view[n]&&this._view[n].addClass("disabled"),this._view[s]&&this._view[s].addClass("disabled")),this},onfocus:function(){this._view[r].addClass("focus")},onblur:function(){this._view[r].removeClass("focus")},onmouseover:function(t){this._view[r].removeClass("focus"),this._view[n].addClass("pointer"),this._view[s].addClass("pointer"),this._isArrow(t.source,n)?this._focusArrow(n):this._isArrow(t.source,s)&&this._focusArrow(s)},onmouseout:function(t){this._view[n].removeClass("pointer"),this._view[s].removeClass("pointer"),this._isArrow(t.source,n)?this._blurArrow(n):this._isArrow(t.source,s)&&this._blurArrow(s)},onkeydown:function(t){var e=t.key();e.left?(this._focusArrow(n),this._decreaseStar(t)):e.right&&(this._focusArrow(s),this._increaseStar(t)),this._view[r].addClass("focus"),this._view[n].removeClass("pointer"),this._view[s].removeClass("pointer")},onkeyup:function(t){var e=t.key();e.left?this._blurArrow(n):e.right&&this._blurArrow(s)},onmousedown:function(t){this._isMouseDown=!0,this._isArrow(t.source,n)?this._decreaseStar():this._isArrow(t.source,s)?this._increaseStar():this._setStarRating(t)},onmouseup:function(){this._isMouseDown=!1},onmousemove:function(t){this._isMouseDown&&this._setStarRating(t)},onchange:function(t){t.setSource(this),t.setDetail(this.rating)},setOption:function(t){this.rating=caph.isBlank(t.rating)?caph.ui.base.component.Rating.MIN:t.rating,this.increments=caph.isBlank(t.increments)?caph.ui.base.component.Rating.MIN_INCREMENTS:t.increments,this.className=t.className||"caph-base-rating",this.setARIA({role:"slider",title:"rating"}),this.$super(t)
},_initialize:function(){this.$super(),this._view={},this._isMouseDown=!1,this.focusable(!0)},_normalizeNumber:function(t,e,i){return e>t?e:t>i?i:t},_createElement:function(){var t=this._createArrow(n),e=this._createArrow(s),i=this._createRating();this._hideArrow(t,e),this._initStar(i),this.addChild(this._view[n]=t),this.addChild(this._view[r]=i),this.addChild(this._view[s]=e)},_createArrow:function(e){var n=new t;return n.removeClass("caph-view"),["caph-rating",this.className,i,e].forEach(n.addClass.bind(n)),n},_createRating:function(){var e=new t;e.removeClass("caph-view"),["caph-rating",this.className,r].forEach(e.addClass.bind(e));for(var i=0;caph.ui.base.component.Rating.MAX>i;i++){var n=new t;n.removeClass("caph-view"),["caph-rating",this.className,a].forEach(n.addClass.bind(n)),e.addChild(n)}return e},_hideArrow:function(t,e){this.rating<caph.ui.base.component.Rating.MIN+this.increments?(t.addClass(o),e.removeClass(o)):this.rating>caph.ui.base.component.Rating.MAX-this.increments?(t.removeClass(o),e.addClass(o)):(t.removeClass(o),e.removeClass(o))},_initStar:function(t){for(var e=t.getChildren(),i=0;caph.ui.base.component.Rating.MAX>i;i++)[c,h].forEach(e[i].removeClass.bind(e[i]));var n=Math.floor(this.rating),s=this.rating-n;for(i=0;n>i;i++)e[i].addClass(h);s>=caph.ui.base.component.Rating.MIN_INCREMENTS&&e[n].addClass(c)},_decreaseStar:function(t){this._changeStar(this.rating-this.increments,t)},_increaseStar:function(t){this._changeStar(this.rating+this.increments,t)},_changeStar:function(t,e){var i=this.rating;this.setRatingValue(t),i!==this.rating&&e&&e.stopPropagation()},_focusArrow:function(t){this._view[t].addClass("focus")},_blurArrow:function(t){this._view[t].removeClass("focus")},_isArrow:function(t,e){return t===this._view[e]},_setStarRating:function(t){for(var e=t.source,i=this._view[r].getChildren(),n=0,s=i.length;s>n;n++)if(e===i[n]){var o=t.mouse().offsetX,a=e.getStyle("width").replace("px","");this.increments===caph.ui.base.component.Rating.MIN_INCREMENTS?o>a/2?this.setRatingValue(n+caph.ui.base.component.Rating.MAX_INCREMENTS):o>a/4?this.setRatingValue(n+caph.ui.base.component.Rating.MIN_INCREMENTS):this.setRatingValue(n):o>a/4?this.setRatingValue(n+caph.ui.base.component.Rating.MAX_INCREMENTS):this.setRatingValue(n);break}}})}(this),function(){"use strict";var t=caph.require("ui.base.Component");$class({$namespace:"caph.ui.base.component.Html",$extends:t})}(this),function(){"use strict";$class({$namespace:"caph.ui.base.component.RadioButton._Group",$constructor:function(t){this.initialize(),this.setOption(t)},initialize:function(){this._option={},this._option.element=[],this._option.currentSelected=null},setOption:function(t){this._option.name=t.name||this._option.name||"default"},add:function(t){this.isMember(t)===!1&&(this._option.element.push(t),t._setGroupName(this._option.name))},remove:function(t){var e=this.isMember(t);return e>-1&&this._option.element.splice(e,1),this},isMember:function(t){var e=this._option.element.indexOf(t);return e>-1?e:!1},select:function(t){var e=this._option.element.indexOf(t);this._option.currentSelected=e>-1?e:null,t._setChecked(!0)},deselect:function(t){this._option.currentSelected=null,t._setChecked(!1)},setChecked:function(t,e){var i=this._option.currentSelected;null!==this._option.currentSelected&&this._option.element[i]!==t&&this.deselect(this._option.element[i]),e?this.select(t):this.deselect(t)},getCheckedElement:function(){return this._option.element[this._option.currentSelected]||null}})}(this),function(){"use strict";var t=caph.require("ui.base.component.RadioButton._Group"),e=$class({$constructor:function(){this.initialize()},initialize:function(){this._groups={}},createGroup:function(e){return this._groups[e]instanceof t||(this._groups[e]={},this._groups[e]=new t({name:e})),this._groups[e]},setGroup:function(t,e){var i=this._groups[e._option.group],n=this._groups[t];return i&&i.isMember(e)!==!1&&i.remove(e),n?n.add(e):this.createGroup(t).add(e),this._groups[t]},getGroup:function(t){return this._groups[t]||this.createGroup(t)}});caph.namespace("caph.ui.base.component.RadioButton._Manager",caph.pattern.singleton(e))}(this),function(){"use strict";var t=(caph.require("module.renderer.View"),caph.require("ui.base.component.RadioButton._Manager")),e={baseCls:"caph-radiobutton",checkedCls:"check",focusedCls:"focus",disabledCls:"disable"};$class({$namespace:"caph.ui.base.component.RadioButton",$extends:caph.ui.base.Component,$constructor:function(t){this.$super(t)},_initialize:function(){this.$super(),this.setARIA({title:"radiobutton",role:"radiobutton"}),this.addClass(e.baseCls),this.focusable(!0),this._option.checked=!1,this._option.group="default",this._option.groupObject=t.getInstance().setGroup("default",this),this._option.groupObject.setChecked(this,this._option.checked)},setOption:function(e){this.$super(e),e&&(caph.extend(this._option,e),e.group&&"string"==typeof e.group&&(this._option.groupObject=t.getInstance().setGroup(this._option.group,this)),e.checked&&"boolean"==typeof e.checked&&this._option.groupObject.setChecked(this,this._option.checked)),this._setClass()},_setGroupName:function(t){this._option.group=t},_setClass:function(){caph.isBoolean(this._option.checked)&&(this._option.checked?this.addClass(e.checkedCls):this.removeClass(e.checkedCls))},setChecked:function(t){this._option.groupObject.setChecked(this,t)},_setChecked:function(t){caph.isBoolean(t)&&(this._option.checked=t,this._setClass(),this._stateChange())},isChecked:function(){return this._option.checked},setEnable:function(t){this.$super(t),t===!0?this.removeClass(e.disabledCls):this.addClass(e.disabledCls)},_stateChange:function(){try{var t=new caph.event.Message({type:"statechange",detail:{state:this._option.checked}});this._onstatechange(t)}catch(e){return Error("radiobutton : _statechange occur error : "+e.message),!1}},onfocus:function(){this.addClass(e.focusedCls)},onblur:function(){this.removeClass(e.focusedCls)},onclick:function(){this.isEnable()&&this._option.groupObject.setChecked(this,!0)},onkeydown:function(t){this.isEnable()&&t.key().enter&&this._option.groupObject.setChecked(this,!0)}})}(this),function(){"use strict";var t=caph.require("module.renderer.View"),e=caph.require("ui.base.Component"),i=caph.require("module.event.Manager"),n=caph.require("module.focus.Manager"),s=caph.require("module.renderer._VDomLookUpTable");caph.require("ui.base.Marquee");var o=$class({$extends:caph.ui.base.Component,$constructor:function(t){this.tag=t.tag,this.maxLength=t.maxLength,this.isShowTextLength=t.isShowTextLength,this.callback=t.callback,this.$super(t),this.domEvent(!1)},onkeydown:function(t){var e=t.key();e.enter&&(t.preventDefault(),t.stopPropagation(),s.getInstance().getDom(this).blur(),n.getInstance().focus(this.getParent()),"function"==typeof this.callback&&this.callback(t)),(e.left||e.right||e.up||e.down)&&t.stopPropagation()},oninput:function(t){var e=s.getInstance().getVDom(t.source);if(e===this){var n=this.getProperty("value"),o=n.length,r={value:n,length:o};i.getInstance().sendTo(this.getParent(),{type:"change",detail:r})}},onfocus:function(){s.getInstance().getDom(this).focus()}});$class({$namespace:"caph.ui.base.component.Inputbox",$extends:e,$statics:{INPUT:"input",TEXTAREA:"textarea"},$constructor:function(t){this.$super(t),this._create(t)},setOption:function(t){if(this.setARIA({title:"inputbox",role:"inputbox"}),this.type=t.type||caph.ui.base.component.Inputbox.INPUT,this.className=t.className||"caph-base-inputbox",this.maxLength=t.maxLength||40,this.scrollbar=t.scrollbar||!1,this.placeholder=t.placeholder||"",this.isShowTextLength=t.isShowTextLength||!1,this.value=t.value||"",this.align=t.align||"left",this.value.length>this.maxLength&&(this.value=this.value.slice(0,this.maxLength)),!caph.isNumber(this.maxLength))throw Error("width/maxLength should be a number");if(!caph.isBoolean(this.scrollbar)||!caph.isBoolean(this.isShowTextLength))throw Error("scrollbar/isShowTextLength should be a boolean type");if(!caph.isString(this.align)||!caph.isString(this.placeholder))throw Error("align/placeholder should be a string type");if(this.type!=caph.ui.base.component.Inputbox.INPUT&&this.type!=caph.ui.base.component.Inputbox.TEXTAREA)throw Error("Unsupported Inputbox type");this.$super(t)},setPlaceholder:function(t){this.inputbox.setProperty({placeholder:t})},setValue:function(t){t.length>this.maxLength&&(t=t.slice(0,this.maxLength)),this.inputbox.setProperty({value:t}),this._setTextLengthLabel(t.length)},setMaxLength:function(t){this.maxLength=t,this.inputbox.setProperty({maxLength:this.maxLength});var e=this.inputbox.getProperty("value");e.length>t&&(e=e.slice(0,this.maxLength)),this.inputbox.setProperty({value:e}),this._setTextLengthLabel(e.length)},onfocus:function(){this.inputbox.addClass("focus")},onblur:function(){this.inputbox.removeClass("focus")},onchange:function(t){t.stopPropagation(),this._setTextLengthLabel(t.detail.length)},getValue:function(){return this.inputbox.getProperty("value")},setReadOnly:function(){this.inputbox.setProperty({readOnly:!0})},onkeydown:function(t){var e=t.key();e.enter&&(t.preventDefault(),t.stopPropagation(),n.getInstance().focus(this.inputbox))},hideTextLength:function(){this.textLengthLabel&&this.textLengthLabel.visibility(!1)},showTextLength:function(){this.textLengthLabel?this.textLengthLabel.visibility(!0):this._createTextLengthLabel()},size:function(t){return caph.isBlank(t)?this.$super():(this.$super(t),this.inputbox&&this.inputbox.size(t),this.textLengthLabel&&this.textLengthLabel.setStyle({width:t[0]+"px"}),this)},setEnable:function(t){return this.$super(t),this.inputbox&&(t?(this.inputbox.removeClass("dim"),this.inputbox.getProperty("disabled")&&this.inputbox.setProperty({disabled:""})):(this.inputbox.addClass("dim"),this.inputbox.setProperty({disabled:"disabled"}))),this},_initialize:function(){this.$super(),this.focusable(!0),i.getInstance().addObserver(this),this.requestPostRender()},_create:function(t){var e=this.size();this.placeholder.length>0&&this.value.length>0&&(this.placeholder=""),this.inputbox=new o({tag:this.type,isShowTextLength:this.isShowTextLength,maxLength:this.maxLength,callback:t.callback}),this.scrollbar||this.inputbox.setStyle({overflow:"hidden"}),this.inputbox.size(e),this.inputbox.setProperty({value:this.value,placeholder:this.placeholder}),this.isShowTextLength&&this._createTextLengthLabel(),this.addClass(this.className),this.inputbox.addClass(this.className),this.inputbox.addClass(this.align),this.inputbox.addClass("normal"),this.inputbox.addClass("caph-stripe-inputbox-align"),this.addChild(this.inputbox)},_createTextLengthLabel:function(){this.textLengthLabel=new t;var e=this.inputbox.getProperty("value").length;this.textLengthLabel.addClass("caph-stripe-inputbox-showTextLength"),this.textLengthLabel.setProperty({innerText:e+"/"+this.maxLength}),this.addChild(this.textLengthLabel)},_setTextLengthLabel:function(){this.textLengthLabel&&this.textLengthLabel.setProperty({innerText:text.length+"/"+this.maxLength})}})}(this),function(){"use strict";var t=caph.require("ui.base.Component"),e=caph.require("ui.base.component.Inputbox"),i={DEFAULT_MAXVALUE:9999,DEFAULT_MINVALUE:0,DEFAULT_VALUE:0,DEFAULT_INCREMENT:1,INCREASE:"increase",DECREASE:"decrease"};$class({$namespace:"caph.ui.base.component.Spinner",$extends:t,$constructor:function(t){this.$super(t)},_initialize:function(){this.$super(),this.setARIA({title:"spinner",role:"spinner"}),this.focusable(!1),this._option.maxValue=i.DEFAULT_MAXVALUE,this._option.minValue=i.DEFAULT_MINVALUE,this._option.isCycle=!0,this._option.increment=i.DEFAULT_INCREMENT,this._option.value=i.DEFAULT_VALUE,this._upIcon=new t,this._upIconDiv=new t,this._innerText=new e({align:"center",dim:"true"}),this._innerText.setReadOnly(),this._downIcon=new t,this._downIconDiv=new t,this._upIcon.addChild(this._upIconDiv),this._downIcon.addChild(this._downIconDiv),this.addChild(this._innerText),this.addChild(this._upIcon),this.addChild(this._downIcon),this.addClass("caph-spinner-body"),this.addClass("normal"),this._upIcon.addClass("caph-spinner-arrow"),this._upIcon.addClass("caph-spinner-up"),this._upIcon.addClass("normal"),this._upIconDiv.addClass("caph-spinner-up-inner"),this._upIconDiv.addClass("normal"),this._downIcon.addClass("caph-spinner-arrow"),this._downIcon.addClass("caph-spinner-down"),this._downIcon.addClass("normal"),this._downIconDiv.addClass("caph-spinner-down-inner"),this._downIconDiv.addClass("normal"),this._innerText.inputbox.addClass("caph-spinner-input"),this._addEvents(),this.requestPostRender()},setOption:function(t){this.$super(t),t&&caph.extend(this._option,t),this.setValue(this._option.value)},setValue:function(t){return this._option.maxValue>=t&&t>=this._option.minValue?(this._innerText.setValue(t),this._value=t,this):void 0},getValue:function(){return this._value},onpostrender:function(){var t,e,i=this._upIcon,n=this._upIconDiv,s=this._downIconDiv;i.hasClass("normal")?(t=(i.size()[0]-n.size()[0])/2,e=(i.size()[1]-n.size()[1])/2):(t=(i.size()[0]-n.size()[0]-2)/2,e=(i.size()[1]-n.size()[1]-2)/2),n.setStyle({marginLeft:t,marginTop:e}),s.setStyle({marginLeft:t,marginTop:e})},setEnable:function(t){return this.$super(t),t===!0?this.removeClass("disable"):this.addClass("disable"),this},onkeydown:function(t){this.isEnable()&&(t.key().up?(this._incValue(),this._upArrowDisable&&(this._changeClass(this._upIconDiv,"focus"),this._changeClass(this._upIcon,"normal")),t.stopPropagation()):t.key().down&&(this._decValue(),this._downArrowDisable&&(this._changeClass(this._downIconDiv,"focus"),this._changeClass(this._downIcon,"normal")),t.stopPropagation()))},_arrowClick:function(t){this.isEnable()&&(t===i.INCREASE?this._upArrowDisable||(this._changeClass(this._upIcon,"focus"),this._changeClass(this._upIconDiv,"focus"),this._incValue(),this._changeClass(this._downIcon,"mouse")):this._downArrowDisable||(this._changeClass(this._downIcon,"focus"),this._changeClass(this._downIconDiv,"focus"),this._decValue(),this._changeClass(this._upIcon,"mouse")),this.onpostrender())},_arrowFocus:function(t){t===i.INCREASE?this._upArrowDisable||(this._changeClass(this._upIcon,"focus"),this._changeClass(this._upIconDiv,"focus"),this._changeClass(this._downIcon,"mouse")):this._downArrowDisable||(this._changeClass(this._downIcon,"focus"),this._changeClass(this._downIconDiv,"focus"),this._changeClass(this._upIcon,"mouse")),this.onpostrender()},_arrowBlur:function(t){t===i.INCREASE?(this._upArrowDisable||this._changeClass(this._upIconDiv,"normal"),this._changeClass(this._upIcon,"normal"),this._changeClass(this._downIcon,"normal")):(this._downArrowDisable||this._changeClass(this._downIconDiv,"normal"),this._changeClass(this._downIcon,"normal"),this._changeClass(this._upIcon,"normal"))},_changeClass:function(t,e){switch(e){case"normal":t.addClass("normal"),t.removeClass("mouse"),t.removeClass("focus"),t.removeClass("disable");break;case"mouse":t.removeClass("normal"),t.addClass("mouse"),t.removeClass("focus"),t.removeClass("disable");break;case"focus":t.removeClass("normal"),t.removeClass("mouse"),t.addClass("focus"),t.removeClass("disable");break;case"disable":t.removeClass("normal"),t.removeClass("mouse"),t.removeClass("focus"),t.addClass("disable")}},_incValue:function(){var t=!1;this._value=this._value+this._option.increment,this._downArrowDisable=!1,this._changeClass(this._downIcon,"normal"),this._changeClass(this._downIconDiv,"normal"),this._value>=this._option.maxValue&&!this._option.isCycle&&(this._changeClass(this._upIcon,"disable"),this._upArrowDisable=!0),this._value>this._option.maxValue?this._option.isCycle?(this._value=this._option.minValue,t=!0):this._value=this._option.maxValue:t=!0,this.setValue(this._value),t&&this._fireUserEvent()},_decValue:function(){var t=!1;this._value=this._value-this._option.increment,this._upArrowDisable=!1,this._changeClass(this._upIcon,"normal"),this._changeClass(this._upIconDiv,"normal"),this._value<=this._option.minValue&&!this._option.isCycle&&(this._changeClass(this._downIcon,"disable"),this._downArrowDisable=!0),this._value<this._option.minValue?this._option.isCycle?(this._value=this._option.maxValue,t=!0):this._value=this._option.minValue:t=!0,this.setValue(this._value),t&&this._fireUserEvent()},_fireUserEvent:function(){caph.isFunction(this._onvaluechanged)&&this._onvaluechanged.call(this)},_addEvents:function(){this._upIcon.focusable(!0),this._downIcon.focusable(!0),this._upIcon.on({focus:this._arrowFocus.bind(this,i.INCREASE),blur:this._arrowBlur.bind(this,i.INCREASE),click:this._arrowClick.bind(this,i.INCREASE)}),this._downIcon.on({focus:this._arrowFocus.bind(this,i.DECREASE),blur:this._arrowBlur.bind(this,i.DECREASE),click:this._arrowClick.bind(this,i.DECREASE)}),this._upIcon.keyEvent(!1),this._downIcon.keyEvent(!1)}})}(this),function(){"use strict";var t=caph.require("module.renderer.View"),e=caph.require("module.event.Manager");caph.require("module.focus.Manager"),$class({$namespace:"caph.ui.base.component.Scrollbar",$extends:caph.ui.base.Component,$constructor:function(t){this.$super(t),this._setMethodByDirection(),this._createScrollbar()},$statics:{VERTICAL:"vertical",HORIZONTAL:"horizontal"},setSizeValue:function(t){return this.sizeValue=t,this._setCurrentSizeValueByDirection(),this._moveThumb(),this},setMaxThumbPosition:function(t){return this.maxThumbPosition=t,this._normalizeCurrentThumbPosition(),this._moveThumb(),this},getCurrentThumbPosition:function(){return this.currentThumbPosition},moveNext:function(){return this.currentThumbPosition===this.maxThumbPosition?!1:(this.currentThumbPosition+=this.step,this._moveThumb(),!0)},movePrev:function(){return 1===this.currentThumbPosition?!1:(this.currentThumbPosition-=this.step,this._moveThumb(),!0)},moveTo:function(t){this.currentThumbPosition=t;var e=this._normalizeCurrentThumbPosition();return this._moveThumb(),e},onmouseover:function(t){this.addClass("focus"),this._thumb.addClass("over"),t.source===this._thumb&&(this._thumb.addClass("focus"),this._thumb.update())},onmouseout:function(t){t.source===this._thumb&&(this._thumb.removeClass("focus"),this._thumb.update()),this.removeClass("focus"),this._thumb.removeClass("over"),this._thumb.removeClass("focus")},onmousedown:function(t){var e=t.source,i=t.mouse();e===this||e===this._wrapper?this._moveByMouseOffsetDirection(i):e===this._thumb&&(this._isMouseDown=!0,this._adjustment=this._getAdjustmentByDirection(i))},onchange:function(t){t.setSource(this),t.setDetail(this.currentThumbPosition)},onpostrender:function(){this._thumbWidth=1*this._thumb.getStyle("width").replace("px",""),this._thumbHeight=1*this._thumb.getStyle("height").replace("px",""),this._moveThumb()},show:function(){return this.visibility(!0),this},hide:function(){return this.visibility(!1),this},setOption:function(t){this.sizeValue=t.sizeValue||100,this.maxThumbPosition=t.maxThumbPosition||10,this.currentThumbPosition=t.currentThumbPosition||1,this.step=t.step||1,this.direction=t.direction||caph.ui.base.component.Scrollbar.VERTICAL,this.className=t.className||"caph-base-scrollbar",this.setARIA({role:"scrollbar",title:"scrollbar"}),this.$super(t)},_initialize:function(){this.$super(),this._thumb=null,this._thumbWidth=0,this._thumbHeight=0,this._wrapper=null,this._isMouseDown=!1,this._adjustment=0,this.focusable(!0),this.keyEvent(!1),this.requestPostRender(),caph.window.bind("mousemove",function(t){return this._isMouseDown?(this._moveByMousePositionDirection(t),t.preventDefault(),t.stopPropagation(),!1):void 0}.bind(this)),caph.window.bind("mouseup",function(){this._isMouseDown=!1,this._adjustment=0}.bind(this))},_setMethodByDirection:function(){var t=caph.capitalize(this.direction);this._setCurrentSizeValueByDirection=this["_setCurrentSizeValueBy"+t],this._createScrollbarByDirection=this["_createScrollbarBy"+t],this._moveByMouseDirection=this["_moveByMouse"+t],this._moveByMouseOffsetDirection=this["_moveByMouseOffset"+t],this._moveByMousePositionDirection=this["_moveByMousePosition"+t],this._moveThumbByDirection=this["_moveThumbBy"+t],this._getAdjustmentByDirection=this["_getAdjustmentBy"+t]},_createScrollbar:function(){this._thumb=this._createThumb(),this._createScrollbarByDirection(),this.addClass("caph-scrollbar"),this.addClass(this.className),this.addClass(this.direction)},_createThumb:function(){var e=new t;return e.removeClass("caph-view"),e.addClass("caph-scrollbar"),e.addClass(this.className),e.addClass("thumb"),e},_createScrollbarByVertical:function(){this._setCurrentSizeValueByDirection(),this.addChild(this._thumb)},_createScrollbarByHorizontal:function(){this._wrapper=new t,this._wrapper.removeClass("caph-view"),this._wrapper.addChild(this._thumb),this._setCurrentSizeValueByDirection(),this.addChild(this._wrapper)},_setCurrentSizeValueByVertical:function(){this.size([void 0,this.sizeValue])},_setCurrentSizeValueByHorizontal:function(){this.size([this.sizeValue,void 0])},_moveThumb:function(t){this._normalizeCurrentThumbPosition(),this._moveThumbByDirection(t)},_moveThumbByVertical:function(t){this._moveThumbPosition(this._thumbHeight,t,function(t){return[0,t,0]})},_moveThumbByHorizontal:function(t){this._moveThumbPosition(this._thumbWidth,t,function(t){return[t,0,0]})},_moveThumbPosition:function(t,e,i){caph.isBlank(e)&&(e=(this.currentThumbPosition-1)*this._getOffset(t)),this._thumb.position(i(e))},_normalizeCurrentThumbPosition:function(){return this.currentThumbPosition>this.maxThumbPosition?(this.currentThumbPosition=this.maxThumbPosition,!1):1>this.currentThumbPosition?(this.currentThumbPosition=1,!1):!0},_getOffset:function(t){return(this.sizeValue-t)/(this.maxThumbPosition-1)},_getOffsetByMouse:function(t,e){return Math.ceil(t/e*this.maxThumbPosition)},_moveByMouseOffsetVertical:function(t){this._moveByMouseVertical(t.offsetY)},_moveByMouseOffsetHorizontal:function(t){this._moveByMouseHorizontal(t.offsetX)},_getAdjustmentByVertical:function(t){return t.clientY-this._thumb.y()-this._thumbHeight/2},_getAdjustmentByHorizontal:function(t){return t.clientX-this._thumb.x()-this._thumbWidth/2},_moveByMousePositionVertical:function(t){this._moveByMouseVertical(t.clientY-this._adjustment)},_moveByMousePositionHorizontal:function(t){this._moveByMouseHorizontal(t.clientX-this._adjustment)},_moveByMouseVertical:function(t){this._moveByMouse(this._thumbHeight,t)},_moveByMouseHorizontal:function(t){this._moveByMouse(this._thumbWidth,t)},_moveByMouse:function(t,i){var n=this.sizeValue-t;i-=t/2,0>i?i=0:i>n&&(i=n);var s=this.currentThumbPosition;this.currentThumbPosition=this._getOffsetByMouse(i,n),this._moveThumb(i),s!==this.currentThumbPosition&&e.getInstance().sendTo(this,{type:"change"})}})}(this),function(){"use strict";var t=caph.require("ui.base.Component"),e={DEFAULT_WIDTH:100,DEFAULT_ITEMHEIGHT:25,DEFAULT_INTERVAL:0,DEFAULT_TEXTALIGN:"left",DEFAULT_SHOWCOUNT:6,DEFAULT_ISSCROLL:!0,LISTMENU_ZINDEX:1e4},i={ESC:27},n=$class({$constructor:function(t){t=t||{},this._direction=t.direction||"vertical",this._space=caph.isBlank(t.space)?0:t.space,this._rank=caph.isBlank(t.rank)?30:t.rank,this._index=0},getNextPosition:function(){return"vertical"===this._direction?[0,this._index*(this._rank+this._space),0]:[this._index*(this._rank+this._space),0,0]},increaseIndex:function(){this._index++},getDirection:function(){return this._direction}}),s=$class({$extends:t,$constructor:function(t){this.$super(t)},setLayout:function(t){t&&(this._layout=t)},addItems:function(t){var e;if(this._layout&&caph.isArray(t))for(var i=0,n=t.length;n>i;i++)e=this._layout.getNextPosition(),t[i].position(e[0],e[1],e[2]),this.addChild(t[i]),this._layout.increaseIndex()},getLayout:function(){return this._layout}});$class({$namespace:"caph.ui.base.component.ListMenu",$extends:t,$constructor:function(t){this.$super(t)},_initialize:function(){this.$super(),this.setARIA({title:"listMenu",role:"listMenu"}),this.addClass("caph-listmenu"),this.visibility(!0),this.requestPostRender(),this._itemList=[],this._trigger=null,this._option.itemSize=[e.DEFAULT_WIDTH,e.DEFAULT_ITEMHEIGHT],this._option.interval=e.DEFAULT_INTERVAL,this._option.showCount=e.DEFAULT_SHOWCOUNT,this._option.textAlign=e.DEFAULT_TEXTALIGN,this._option.isScroll=e.DEFAULT_ISSCROLL},setOption:function(t){this.$super(t),t&&caph.extend(this._option,t)},show:function(){this.visibility(!0),!this._selectedItem&&this._itemList&&this._itemList.length>0&&(this._selectedItem=this._itemList[0]),caph.module.focus.Manager.getInstance().focus(this._selectedItem),this._show()},hide:function(){this.visibility(!1),this._trigger&&caph.module.focus.Manager.getInstance().focus(this._trigger),this._hide()},bindTrigger:function(t){t&&(this._trigger=t)},addItem:function(t){var i=this;if(caph.isArray(t)){for(var n=0,s=t.length;s>n;n++)t[n].addClass("caph-listmenu-item"),t[n].setStyle({textAlign:this._option.textAlign}),t[n].on({focus:function(){i._selectedItem&&i._selectedItem.removeClass("focus"),this.addClass("focus"),i._selectedItem=this},blur:function(){this.removeClass("focus")},click:function(){i._selectedItem=this,i._selected(),i._trigger&&i.hide()},keydown:function(t){t.key().up?(i._pre(t),t.stopPropagation()):t.key().down&&(i._next(t),t.stopPropagation())}}),t[n].focusable(!0),caph.module.event.Manager.getInstance().addObserver(t[n]);this._itemList=t,t.length>e.DEFAULT_SHOWCOUNT&&this._createUpDownArrow()}},getSelectedItem:function(){return this._selectedItem?this._selectedItem:null},getItem:function(t){return this._itemList&&this._itemList.length>t?this._itemList[t]:null},onkeydown:function(t){this.visibility()&&(event.keyCode===i.ESC&&this._trigger?this.hide():t.key().up?(this._pre(t),t.stopPropagation()):t.key().down?(this._next(t),t.stopPropagation()):t.key().enter&&this._trigger&&(this._selected(),this.hide()),t.stopPropagation())},onpostrender:function(){var t,e,i,n=this.getRoot();if(n){if(t=n.getProperty("clientWidth"),e=n.getProperty("clientHeight"),this._initSize(),caph.isArray(this._itemList)&&this._itemList.length>0){i=this._itemList[0].getStyle("margin").substring(this._itemList[0].getStyle("margin").indexOf(" "),this._itemList[0].getStyle("margin").length-2),this.itemWidth=parseInt(this._option.itemSize[0])-2*parseInt(i);for(var s=0,o=this._itemList.length;o>s;s++)this._itemList[s].size([this.itemWidth,this._option.itemSize[1]])}this._trigger&&null===this.position()[0]&&this._setPosition()}},_setPosition:function(){var t,i,n=parseInt(this.getStyle("border")),s=this.size(),o=parseInt(this.getStyle("padding").substring(0,this.getStyle("padding").indexOf("px"))),r=this._trigger.position(),a={x:this._trigger.getProperty("offsetWidth"),y:this._trigger.getProperty("offsetHeight")};this._trigger&&(t=this.getRoot().getProperty("clientWidth"),i=this.getRoot().getProperty("clientHeight"),caph.isNumber(o)&&(s[1]=parseInt(s[1])+2*o),caph.isNumber(n)&&(s[0]=parseInt(s[0])+2*n,s[1]=parseInt(s[1])+2*n),r[0]+=parseFloat(a.x),r[1]+=parseFloat(a.y),r[2]+=parseFloat(1),parseFloat(r[0])+parseFloat(s[0])>t&&(r[0]-=parseFloat(s[0])+parseFloat(a.x)),parseFloat(r[1])+parseFloat(s[1])>i&&(r[1]-=parseFloat(s[1])+parseFloat(a.y),this._top=!0),this._upIcon&&(r[1]-=this._option.itemSize[1]),this.position(r[0],r[1],r[2]),this.setStyle({zIndex:e.LISTMENU_ZINDEX}))},_initSize:function(){var t=this._option.showCount*(this._option.interval+this._option.itemSize[1]),e=null,i=0,o=null;this._itemList&&this._itemList.length<this._option.showCount&&(t=this._itemList.length*(this._option.interval+this._option.itemSize[1])),!this._option.isScroll&&caph.isArray(this._itemList)&&(t=this._itemList.length*(this._option.interval+this._option.itemSize[1])),this._option.height=t,o=new n({dirction:"vertical",rank:this._option.itemSize[1],space:this._option.interval}),this._upIcon&&(i+=this._option.itemSize[1]),e=new s({position:[0,i,0],size:[this._option.itemSize[0],t]}),e.setStyle({overflow:"hidden"}),this._popup=e,this._popup.setLayout(o),this._popup.addItems(this._itemList),this.addChild(e),this._upIcon?(this.addChild(this._upIcon),this.addChild(this._downIcon),this.size([this._option.itemSize[0],this._option.height+2*this._option.itemSize[1]])):this.size([this._option.itemSize[0],this._option.height])},_getPreItem:function(){!this._selectedItem&&this._itemList&&this._itemList.length>0&&(this._selectedItem=this._itemList[0]);for(var t=0,e=this._itemList.length;e>t;t++)if(this._itemList[t]===this._selectedItem)return t>0?this._itemList[t-1]:this._itemList[e-1]},_getNextItem:function(){if(!this._selectedItem&&this._itemList&&this._itemList.length>0&&(this._selectedItem=this._itemList[0],!this._trigger))return this._selectedItem;for(var t=0,e=this._itemList.length;e>t;t++)if(this._itemList[t]===this._selectedItem)return e-1>t?this._itemList[t+1]:this._itemList[0]},_show:function(){try{var t=new caph.event.Message({type:"show",detail:{data:0}});return this._onshow(t),0}catch(e){Error("listmenu : _show occur error : "+e.message)}},_hide:function(){try{var t=new caph.event.Message({type:"hide",detail:{data:0}});return this._onhide(t),0}catch(e){Error("listmenu : _hide occur error : "+e.message)}},_selected:function(){try{var t=new caph.event.Message({type:"selected",detail:{data:0}});return this._onselected(t),0}catch(e){Error("listmenu : _selected occur error : "+e.message)}},_calcPosition:function(t){var e,i=this._option.interval+this._option.itemSize[1],n=this._option.showCount*i,s=this._selectedItem.y(),o=this._itemList.length,r=i*(o-this._option.showCount);if(this._option.isScroll&&"vertical"===this._popup.getLayout().getDirection())for(var a=0;o>a;a++)e=this._itemList[a].position(),t&&n===s?e[1]-=i:t||s!==-i?t&&0>s?e[1]+=r:t||s!==(o-1)*i||(e[1]-=r):e[1]+=i,this._itemList[a].y(e[1])},_next:function(){this._selectedItem&&this._selectedItem.removeClass("focus"),this._selectedItem=this._getNextItem(),this._selectedItem&&(this._selectedItem.addClass("focus"),this._itemList.length>this._option.showCount&&this._calcPosition(!0))},_pre:function(){this._selectedItem&&this._selectedItem.removeClass("focus"),this._selectedItem=this._getPreItem(),this._selectedItem&&(this._selectedItem.addClass("focus"),this._itemList.length>this._option.showCount&&this._calcPosition(!1))},_adjustPosition:function(t){var e,i,n=this._itemList.length,s=t.y();if(this._option.isScroll)if(0>s)for(var o=0;n>o;o++)e=this._itemList[o].position(),this._itemList[o].y(e[1]-s);else if(s>5*(this._option.interval+this._option.itemSize[1])){i=s-5*(this._option.interval+this._option.itemSize[1]);for(var o=0;n>o;o++)e=this._itemList[o].position(),this._itemList[o].y(e[1]-i)}},_createUpDownArrow:function(){var i=this;this._upIcon=new t,this._downIcon=new t,this._upIcon.addClass("caph-listmenu-arrow-up"),this._downIcon.addClass("caph-listmenu-arrow-down"),"listMenu"===this.getARIA().title&&(this._upIcon.setProperty({innerText:"+"}),this._downIcon.setProperty({innerText:"-"})),this._upIcon.focusable(!0),this._downIcon.focusable(!0),this._upIcon.size([this._option.itemSize[0],this._option.itemSize[1]]),this._downIcon.size([this._option.itemSize[0],this._option.itemSize[1]]),this._upIcon.onpostrender=function(){if(i._up){i._upIcon.addChild(i._up),i._downIcon.addChild(i._down),i._up.focusable(!1),i._down.focusable(!1);var t=i._up.size();i._up.setStyle({marginLeft:(i._option.itemSize[0]-t[0])/2,marginTop:(i._option.itemSize[1]-t[1])/2}),i._down.setStyle({marginLeft:(i._option.itemSize[0]-t[0])/2,marginTop:(i._option.itemSize[1]-t[1])/2})}i._trigger&&(i._upIcon.visibility(!1),i._downIcon.visibility(!1),i._upIcon.focusable(!1),i._downIcon.focusable(!1)),i.position(),i._itemList[0].size(),i._upIcon.position(0,0,0),i._downIcon.position(0,(i._option.itemSize[1]+i._option.interval)*(e.DEFAULT_SHOWCOUNT+1),0)},this._upIcon.requestPostRender(),this._upIcon.on({focus:function(){i._up?i._up.addClass("focus"):this.addClass("focus")},blur:function(){i._up?i._up.removeClass("focus"):this.removeClass("focus")},click:function(t){i._pre(t),t.stopPropagation()}}),this._downIcon.on({focus:function(){i._down?i._down.addClass("focus"):this.addClass("focus")
},blur:function(){i._down?i._down.removeClass("focus"):this.removeClass("focus")},click:function(t){i._next(t)}})}})}(this),function(){"use strict";function t(t,e){return{type:t,source:e.source,related:e.related,detail:e.detail,_event:e._event}}var e=caph.require("ui.base.Component");caph.require("ui.base.Layout");var i=caph.require("module.event.Manager");caph.require("module.focus.Manager");var n=caph.require("module.renderer._VDomLookUpTable"),s="horizontal",o="vertical",r="prev",a="next",h=0,c=1,l=5,u={xPosition:s,yPosition:o},p=$class({$constructor:function(t){this.parent=t.parent,this.direction=t.direction,this.row=t.row,this.column=t.column,this.gap=t.gap,this.itemSize=t.itemSize,this.itemCountPerPage=t.itemCountPerPage,this.items=[],this._addItemsByDirection=this["_add"+caph.capitalize(this.direction)+"Items"]},addItems:function(t,e){return this._addItemsByIndex(t,e,!1)},addItemsPerPage:function(t,e){return this._addItemsByIndex(t,e,!0)},getItems:function(){return this.items},_addItemsByIndex:function(t,e,i){return this.currentPageIndex=this._getCurrentPageIndex(e),i&&(e=this._getStartIndex()),this._addItemsByDirection(t,e),this},_addHorizontalItems:function(t,e){this._addItems(t,e,this.column,this.row,this._getHorizontalPosition,function(t,e,i,n){t.position(e,this._getVerticalPosition(n),t.z()),t.setProperty({"data-list-item-x-position":i,"data-list-item-y-position":n})})},_addVerticalItems:function(t,e){this._addItems(t,e,this.row,this.column,this._getVerticalPosition,function(t,e,i,n){t.position(this._getHorizontalPosition(n),e,t.z()),t.setProperty({"data-list-item-x-position":n,"data-list-item-y-position":i})})},_addItems:function(t,e,i,n,s,o){var r=t.length,a=e;i=Math.floor(i),n=Math.floor(n);for(var h=Math.floor(e/n),c=i*(this.currentPageIndex+1);c>h;h++)for(var l=s.call(this,h),u=a-h*n;n>u&&!(a>=r);u++){var p=this._getItem(t,a++);o.call(this,p,l,h,u),this.items.push(p)}},_getCurrentPageIndex:function(t){return Math.floor(t/this.itemCountPerPage)},_getStartIndex:function(){return 0>this.currentPageIndex?0:this.currentPageIndex*this.itemCountPerPage},_getHorizontalPosition:function(t){return(this.itemSize[0]+this._getHorizontalGap(t))*t},_getVerticalPosition:function(t){return(this.itemSize[1]+this._getVerticalGap(t))*t},_getHorizontalGap:function(t){return this._getGap(t,0)},_getVerticalGap:function(t){return this._getGap(t,1)},_getGap:function(t,e){return t>0?this.gap[e]:0},_getItem:function(e,n){var s=this.parent,o=s.decorateItem(e[n],n);if(!(o instanceof caph.ui.base.Component))throw Error('IllegalReturnTypeError: The "decorateItem" function must return an instance of "caph.ui.base.Component".');return o.size(this.itemSize),o.setProperty({"data-list-item-index":n}),o.getProperty("data-list-item-no-auto-focus")||o.focusable(!0),o.on({focus:function(e){i.getInstance().sendTo(s,t("focusitem",e))},blur:function(e){i.getInstance().sendTo(s,t("bluritem",e))},click:function(e){i.getInstance().sendTo(s,t("selectitem",e)),e.stopPropagation()},keydown:function(e){e.key().enter&&(i.getInstance().sendTo(s,t("selectitem",e)),e.stopPropagation())}}),o}});$class({$namespace:"caph.ui.base.component.List",$extends:caph.ui.base.Component,$constructor:function(t){this.$super(t);var e=caph.capitalize(this.direction);this._processKeyByDirection=this["_processKeyBy"+e],this._setScrollAmountByDirection=this["_setScrollAmountBy"+e],this._getCurrentItemIndexByDirection=this["_getCurrentItemIndexBy"+e],this._moveByDirection=this["_moveBy"+e],this._setPositionByDirection=this["_setPositionBy"+e],this._autoScrollByDirection=this["_autoScrollBy"+e],this._getMaxRowIndexByDirection=this["_getMaxRowIndexBy"+e],this._getMaxColumnIndexByDirection=this["_getMaxColumnIndexBy"+e],this._itemSize=this._getItemSize(this.size()),this._itemCountPerPage=this._getItemCountPerPage(),this._currentPageIndex=this._getCurrentPageIndex(),this._createElement(),this.addClass("caph-list-layout"),this._enableAutoScroll()},$statics:{VERTICAL:"vertical",HORIZONTAL:"horizontal"},addItem:function(t){return this.items.push(t),this._dynamicPaging?this._createPageItems(1):(this._removeContainer(),this._createContainer(),this._createAllPageItems(),this._addContainer()),this},addItems:function(t){return this.items=this.items.concat(t),this._dynamicPaging?this._createPageItems(t.length):(this._removeContainer(),this._createContainer(),this._createAllPageItems(),this._addContainer()),this},getItemCount:function(){return this.items.length},getItemSize:function(){return this._itemSize},getMaxRowIndex:function(){return this._getMaxRowIndexByDirection()},getMaxColumnIndex:function(){return this._getMaxColumnIndexByDirection()},getCurrentItemIndex:function(){return this._getCurrentItemIndexByDirection()},getCurrentPositionItem:function(){var t,e=this.xPosition,i=this.yPosition;return this._getCurrentPage().getItems().forEach(function(n){return n.getProperty("data-list-item-x-position")===e&&n.getProperty("data-list-item-y-position")===i?(t=n,!1):void 0}),t},size:function(t){return caph.isBlank(t)?this.$super():(this.$super(t),this.update(),this.container&&this._recreateElement(),this)},onkeydown:function(t){return this._lock?(t.stopPropagation(),void 0):(this._keyCount++,this._lock=!0,this._processKeyByDirection(t.key())||(this._setPositionByDirection(),i.getInstance().sendTo(this,{type:"keyup",detail:t.detail})),this._lockHandle=setTimeout(function(){this._lock=!1}.bind(this),this._lockDuration),void 0)},onkeyup:function(t){var e=this._keyCount;this._keyCount=0,e>l&&this._processKeyByDirection(t.key())},onfocusitem:function(t){for(var e=t.source;e&&caph.isBlank(e.getProperty("data-list-item-index"));)e=e.getParent();e&&this._setCurrentPositionByItem(e),t.detail={x:this.xPosition,y:this.yPosition}},onbluritem:function(t){t.source||t.related||t.setRelated(this.getCurrentPositionItem())},onselectitem:function(t){t.detail=this.getCurrentPositionItem()},onprevpage:function(t){t.detail={current:this.getCurrentItemIndex()+1,totalCount:this.getItemCount()}},onnextpage:function(t){t.detail={current:this.getCurrentItemIndex()+1,totalCount:this.getItemCount()}},onautoscroll:function(t){t.detail={x:this.xPosition,y:this.yPosition}},moveToX:function(t){return this._moveTo("xPosition",t,this.getMaxColumnIndex(),this._leftCallback,this._rightCallback)},moveToY:function(t){return this._moveTo("yPosition",t,this.getMaxRowIndex(),this._upCallback,this._downCallback)},moveTo:function(t,e){return this.moveToX(t),this.moveToY(e),this},setOption:function(t){if(!caph.isFunction(t.decorateItem))throw Error('IllegalArgumentError: The "decorateItem" option is missing.');this.decorateItem=t.decorateItem.bind(this),this.direction=t.direction||s,this.row=t.row||1,this.column=t.column||1,this.gap=t.gap||[5,5],this.ease=t.ease||"ease-out",this.duration=t.duration||500,this.items=t.items||[],this.setARIA({role:"gridcell",title:"gridcell"}),this.$super(t)},_initialize:function(){this.$super(),this.pages=[],this._dynamicPaging=!0,this._pageManipulationThreshold=2,this.xPosition=0,this.yPosition=0,this._scrollThreshold=0,this._scrollAmount=0,this._scrollAdjustment=.15,this._autoScrollHandle=null,this._autoScrollThreshold=5,this._autoScrollDuration=150,this._autoScrollInterval=150,this._autoScrollTimeoutHandle=null,this._autoScrollIntervalHandle=null,this._keyCount=0,this._lock=!1,this._lockHandle=null,this._lockDuration=150,this._durationReductionRatio=.5},_enableAutoScroll:function(){caph.window.bind("mousemove",function(t){for(var e=n.getInstance().getVDom(t.target);e&&e!==this;)e=e.getParent();e&&(this._autoScrollTimeoutHandle&&clearTimeout(this._autoScrollTimeoutHandle),this._autoScrollIntervalHandle&&clearInterval(this._autoScrollIntervalHandle),this._autoScrollTimeoutHandle=setTimeout(function(){this._autoScrollByDirection(t)}.bind(this),this._autoScrollDuration),t.preventDefault(),t.stopPropagation())}.bind(this))},_getItemSize:function(t){return t=t||[0,0],[this._getSize(t[h],this.gap[h],this.column),this._getSize(t[c],this.gap[c],this.row)]},_getSize:function(t,e,i){return Math.floor(t/i-e)},_getItemCountPerPage:function(){return Math.floor(this.row)*Math.floor(this.column)},_createElement:function(){this._createContainer(),this._setTransition(),this._dynamicPaging?this._createInitialPageItems():this._createAllPageItems(),this._addContainer()},_recreateElement:function(){this._removeContainer(),this._itemSize=this._getItemSize(this.size()),this._createContainer(),this._dynamicPaging?this._createInitialPageItems():this._createAllPageItems();var t=this.duration;this.duration=0,this._addContainer(),this._moveByDirection(0),this.duration=t},_createContainer:function(){this.container=new e({position:[0,0,0]}),this.container.addClass("caph-list-layout-container")},_removeContainer:function(){this.pages=[],this.container.destroy(),this.update()},_addContainer:function(){this.addChild(this.container)},_createAllPageItems:function(){for(var t=0,e=this.getItemCount();e>t;t+=this._itemCountPerPage)this._addInitialPage(t);this.pages.forEach(function(t){this.container.addChild(t.getItems())}.bind(this))},_createInitialPageItems:function(){var t=this.getCurrentItemIndex(),e=t-this._itemCountPerPage,i=t+this._itemCountPerPage;e>-1&&this._addInitialPage(e),this._addInitialPage(t),this.getItemCount()>i&&this._addInitialPage(i),this.pages.forEach(function(t){this.container.addChild(t.getItems())}.bind(this))},_addInitialPage:function(t){var e=this._createNewPage().addItemsPerPage(this.items,t);e.getItems().length>0&&this.pages.push(e)},_createPageItems:function(t){var e=this.getItemCount(),i=this._createNewPage().addItems(this.items,e-t),n=t-i.getItems().length,s=e-n;1>this.pages.length?(this._addNewPage(i),this._addNewPageOfRemainItems(n,s)):this._addPageToSameIndexPage(i,function(t){i.currentPageIndex<this._currentPageIndex+this._pageManipulationThreshold&&(t?this._addNewPageOfRemainItems(n,s):this._addNewPage(i))})},_addNewPage:function(t){this.pages.push(t),this.container.addChild(t.getItems())},_addPageToSameIndexPage:function(t,e){var i=t.getItems(),n=!1;this.pages.forEach(function(e){if(e.currentPageIndex===t.currentPageIndex){for(var s=e.getItems(),o=0,r=i.length;r>o;o++){if(!(s.length<e.itemCountPerPage)){t.currentPageIndex++;break}var a=i.shift();s.push(a),this.container.addChild(a)}return n=!0,!1}}.bind(this)),e.call(this,n)},_addNewPageOfRemainItems:function(t,e){if(t>0){var i=this._createNewPage().addItems(this.items,e);this.pages.push(i),this.container.addChild(i.getItems())}},_getCurrentItemIndexByHorizontal:function(){return this.xPosition*Math.floor(this.row)+this.yPosition},_getCurrentItemIndexByVertical:function(){return this.xPosition+this.yPosition*Math.floor(this.column)},_createNewPage:function(){return new p({parent:this,direction:this.direction,row:this.row,column:this.column,gap:this.gap,itemSize:this._itemSize,itemCountPerPage:this._itemCountPerPage})},_getCurrentPageIndex:function(){return Math.floor(this.getCurrentItemIndex()/this._itemCountPerPage)},_getCurrentPage:function(){var t,e=this._getCurrentPageIndex();return this.pages.forEach(function(i){return i.currentPageIndex===e?(t=i,!1):void 0}),t},_getMaxPageIndex:function(){return Math.floor((this.getItemCount()-1)/this._itemCountPerPage)},_getMaxRowIndexByHorizontal:function(){return Math.floor(this.row)-1},_getMaxRowIndexByVertical:function(){return Math.floor((this.getItemCount()-1)/Math.floor(this.column))},_getMaxColumnIndexByHorizontal:function(){return Math.floor((this.getItemCount()-1)/Math.floor(this.row))},_getMaxColumnIndexByVertical:function(){return Math.floor(this.column)-1},_setHorizontalScrollAmount:function(t){this._setScrollAmount(this.xPosition,t,this._itemSize[h]+this.gap[h],this.column)},_setVerticalScrollAmount:function(t){this._setScrollAmount(this.yPosition,t,this._itemSize[c]+this.gap[c],this.row)},_setScrollAmount:function(t,e,i,n){var s=Math.floor(n),o=n-s,r=s-1,a=i*(o>=this._scrollAdjustment?this._scrollAdjustment:.5*o);0>e?0===this._scrollThreshold?this._scrollAmount=-1*i*t+a:(this._scrollThreshold+=e,this._scrollThreshold=0>this._scrollThreshold?0:this._scrollThreshold):e>0?this._scrollThreshold===r?this._scrollAmount=-1*i*(t-r)+a:(this._scrollThreshold+=e,this._scrollThreshold=this._scrollThreshold>r?r:this._scrollThreshold):this._scrollAmount=-1*i*(t-this._scrollThreshold)+a,this._scrollAmount>0&&(this._scrollAmount=0)},_processKeyByHorizontal:function(t){return this._processKey({key:t,maxRowIndex:Math.floor(this.row)-1,maxColumnIndex:this.getMaxColumnIndex(),leftCallback:this._leftCallback,rightCallback:this._rightCallback})},_processKeyByVertical:function(t){return this._processKey({key:t,maxRowIndex:this.getMaxRowIndex(),maxColumnIndex:Math.floor(this.column)-1,upCallback:this._upCallback,downCallback:this._downCallback})},_processKey:function(t){var e,i=t.key,n=!1;return i.up?this.yPosition>0&&(e=this.yPosition--,n=!0,t.upCallback&&t.upCallback.call(this,this.yPosition-e)):i.down?this.yPosition<t.maxRowIndex&&(e=this.yPosition++,n=!0,t.downCallback&&t.downCallback.call(this,this.yPosition-e)):i.left?this.xPosition>0&&(e=this.xPosition--,n=!0,t.leftCallback&&t.leftCallback.call(this,this.xPosition-e)):i.right&&this.xPosition<t.maxColumnIndex&&(e=this.xPosition++,n=!0,t.rightCallback&&t.rightCallback.call(this,this.xPosition-e)),n},_setScrollAmountByHorizontal:function(t){this._setHorizontalScrollAmount(t)},_setScrollAmountByVertical:function(t,e){this._setVerticalScrollAmount(e)},_addItems:function(t){var e,i=this._createNewPage(),n=this.getCurrentItemIndex();t===r?(e=this.pages[0],i.addItemsPerPage(this.items,n-this._itemCountPerPage),i.currentPageIndex>=0&&e.currentPageIndex!==i.currentPageIndex&&(this.pages.unshift(i),this.container.addChild(i.getItems()))):t===a&&(e=this.pages[this.pages.length-1],i.addItemsPerPage(this.items,n+this._itemCountPerPage),i.currentPageIndex<=this._getMaxPageIndex()&&e.currentPageIndex!==i.currentPageIndex&&(this.pages.push(i),this.container.addChild(i.getItems()))),this.container.update()},_removePage:function(t){var e,i,n=[];if(t===r)for(i=this._currentPageIndex+this._pageManipulationThreshold;e=this.pages.pop();)e.currentPageIndex>i?this._removeItems(e):n.unshift(e);else if(t===a)for(i=this._currentPageIndex-this._pageManipulationThreshold;e=this.pages.shift();)i>e.currentPageIndex?this._removeItems(e):n.push(e);this.pages=n,this.container.update()},_removeItems:function(t){t.getItems().forEach(function(t){t.destroy()}.bind(this))},_leftCallback:function(t){this._move(r,t,this._moveByHorizontal)},_rightCallback:function(t){this._move(a,t,this._moveByHorizontal)},_upCallback:function(t){this._move(r,t,this._moveByVertical)},_downCallback:function(t){this._move(a,t,this._moveByVertical)},_moveByHorizontal:function(t){this._setHorizontalScrollAmount(t),this._setTransition(),this._setPositionByDirection()},_moveByVertical:function(t){this._setVerticalScrollAmount(t),this._setTransition(),this._setPositionByDirection()},_setTransition:function(){var t=this.duration,e=this.ease;this._keyCount>l&&(t*=this._durationReductionRatio,e="linear"),this.container.setStyle({transition:"transform "+t+"ms "+e,webkitTransition:"-webkit-transform "+t+"ms "+e})},_setPositionByHorizontal:function(){this.container.x(this._scrollAmount)},_setPositionByVertical:function(){this.container.y(this._scrollAmount)},_move:function(t,e,n){var s=this._getCurrentPageIndex();s!==this._currentPageIndex&&(this._currentPageIndex=s,this._dynamicPaging&&(this._addItems(t),this._removePage(t)),i.getInstance().sendTo(this,{type:t+"page"})),n.call(this,e)},_moveTo:function(t,e,i,n,s){if(this[t]===e||0>e||e>i)return this;if(this.direction!==u[t])return this[t]=e,this;var o=this[t],r=this._currentPageIndex,a=(this[t]=e)-o,h=this._getCurrentPageIndex();if(Math.abs(h-r)<this._pageManipulationThreshold)for(var c=0>a?n:s,l=Math.abs(a),p=0;l>p;p++)c.call(this,1);else this._recreateElement(),this._currentPageIndex=h;return this},_getXYByHorizontal:function(t){return{x:Math.floor(t/this.row),y:t%this.row}},_getXYByVertical:function(t){return{x:Math.floor(t/this.column),y:t%this.column}},_autoScrollByHorizontal:function(t){var e=t.clientX,n=t.clientY;this._autoScroll({isWithinArea:function(t){return n>t.top&&t.top+t.height>n},isMoveToPrev:function(t){return t.left+this._autoScrollThreshold>=e},moveToPrev:function(){this.xPosition>0&&(this.moveToX(this.xPosition-1),i.getInstance().sendTo(this,{type:"autoscroll"}))},isMoveToNext:function(t){return e>=t.left+t.width-this._autoScrollThreshold},moveToNext:function(){this.xPosition<this.getMaxColumnIndex()&&(this.moveToX(this.xPosition+1),i.getInstance().sendTo(this,{type:"autoscroll"}))}})},_autoScrollByVertical:function(t){var e=t.clientX,n=t.clientY;this._autoScroll({isWithinArea:function(t){return e>t.left&&t.left+t.width>e},isMoveToPrev:function(t){return t.top+this._autoScrollThreshold>=n},moveToPrev:function(){this.yPosition>0&&(this.moveToY(this.yPosition-1),i.getInstance().sendTo(this,{type:"autoscroll"}))},isMoveToNext:function(t){return n>=t.top+t.height-this._autoScrollThreshold},moveToNext:function(){this.yPosition<this.getMaxRowIndex()&&(this.moveToY(this.yPosition+1),i.getInstance().sendTo(this,{type:"autoscroll"}))}})},_autoScroll:function(t){var e=new caph.dom.Element(n.getInstance().getDom(this)).offset(),i=this.size(),s={left:e.left,top:e.top,width:i[0],height:i[1]};t.isWithinArea.call(this,s)&&(t.isMoveToPrev.call(this,s)?this._autoScrollIntervalHandle=setInterval(t.moveToPrev.bind(this),this._autoScrollInterval):t.isMoveToNext.call(this,s)&&(this._autoScrollIntervalHandle=setInterval(t.moveToNext.bind(this),this._autoScrollInterval)))},_setCurrentPositionByItem:function(t){var e={x:this.xPosition,y:this.yPosition},i={x:t.getProperty("data-list-item-x-position"),y:t.getProperty("data-list-item-y-position")};return this._setScrollAmountByDirection((this.xPosition=i.x)-e.x,(this.yPosition=i.y)-e.y),this}})}(this),function(){"use strict";caph.require("module.renderer.View");var t=caph.require("ui.base.Component"),e=caph.require("module.event.Manager");caph.require("module.focus.Manager");var i=caph.require("ui.base.component.Label");caph.require("ui.base.component.Checkbox"),$class({$namespace:"caph.ui.base.component.Listtext",$extends:t,$constructor:function(t){this.$super(t),this._create(t)},$statics:{DEFAULT:"default",SELECTBOX:"selectbox",CHECKBOX:"checkbox",RADIOBUTTON:"radiobutton"},setOption:function(t){this.setARIA({title:"listtext",role:"listtext"}),this.type=t.type||"default",this.CheckboxCreator=t._theme_checkbox||caph.require("stripe.ui.component.Checkbox"),this.RadiobuttonCreator=t._theme_radiobutton||caph.require("stripe.ui.component.RadioButton"),this.underline=t.underline||!1,this.className=t.className||"caph-stripe-listtext",this.group=t.group,this.text=t.text||"",this.fontsize=t.fontsize||20,this.callback=t.callback,this.checked=!1,this.hasSelected=!0,this.$super(t)},onfocus:function(t){t.stopPropagation(),this.wrappee&&e.getInstance().sendTo(this.wrappee,{bubbles:!1,detail:t.detail,type:t.type,source:this.wrappee}),this.label.addClass("focus"),this.addClass("focus"),this.underlineDiv&&this.underlineDiv.visibility(!1)},onblur:function(t){t.stopPropagation(),this.wrappee&&e.getInstance().sendTo(this.wrappee,{bubbles:!1,detail:t.detail,type:t.type,source:this.wrappee}),this.removeClass("focus"),this.label.removeClass("focus")},onkeydown:function(t){var e=t.key();e.enter&&(t.stopPropagation(),this._selectListtext(t))},onclick:function(t){t.stopPropagation(),this._selectListtext(t)},onpostrender:function(){var t=this.size();if(this.type==caph.ui.base.component.Listtext.DEFAULT)this.label.size(t);else{var e=1*this.wrapper.getStyle("width").replace("px",""),i=1*this.wrapper.getStyle("padding-right").replace("px",""),n=1*this.wrapper.getStyle("padding-left").replace("px","");this.label.size([t[0]-e-n-i,t[1]])}},setEnable:function(t){return this.$super(t),t?(this.removeClass("dim"),this.wrappee&&this.wrappee.setEnable(t)):(this.addClass("dim"),this.wrappee&&this.wrappee.setEnable(t),this.underlineDiv&&this.underlineDiv.visibility(!0)),this},setChecked:function(t){return this.checked=t,this.wrappee&&this.wrappee.setChecked(t),this.hasSelected&&(t?(this.addClass("selected"),this.label.addClass("selected")):(this.addClass("selected"),this.label.addClass("selected"))),this},_initialize:function(){this.$super(),this.focusable(!0),this.requestPostRender()},_create:function(){var t=this.size()||[100,100];this.label=new i({text:this.text}),this.label.removeClass("caph-view"),this.label.setTextSize(this.fontsize),this.label.setTextFont("normal "+this.fontsize+" SamsungSmart_Latin Light"),this.label.focusable(!1),this.label.addClass("caph-stripe-listtext-label"),this.label.focusable(!1),this._createUnderline(),this.type!=caph.ui.base.component.Listtext.DEFAULT&&this["_create"+caph.capitalize(this.type)](),this.size(t),this.addChild(this.label),this.addClass(this.className),this.addClass("normal")},_createUnderline:function(){this.underline&&(this.underlineDiv=new t({tag:"div"}),this.underlineDiv.size([this.size()[0],1]),this.underlineDiv.setStyle({bottom:"0px"}),this.underlineDiv.addClass("caph-stripe-listtext-underline"),this.addChild(this.underlineDiv))},_createCheckbox:function(){this._createWrapper(function(){return this.hasSelected=!1,new this.CheckboxCreator({checked:!1,hasBox:!0})})},_createRadiobutton:function(){this._createWrapper(function(){return this.hasSelected=!1,new this.RadiobuttonCreator({checked:!1,group:this.group})})},_createSelectbox:function(){this._createWrapper(function(){return new this.CheckboxCreator({checked:!1,hasBox:!1})})},_createWrapper:function(e){this.wrapper=new t({tag:"div"}),this.wrapper.removeClass("caph-view"),this.wrappee=e.call(this),this.wrappee.removeClass("caph-view"),this.wrappee.focusable(!1),this.wrapper.addChild(this.wrappee),this.wrapper.addClass("caph-stripe-listtext-wrapper"),this.wrapper.focusable(!1),this.addChild(this.wrapper),this.label.setAlign({horizontal:"left",vertical:"left"}),this.label.addClass("caph-stripe-listtext-label-origin")},_selectListtext:function(t){this.hasSelected&&(this.checked?(this.label.removeClass("selected"),this.removeClass("selected")):(this.label.addClass("selected"),this.addClass("selected"))),this.checked=!this.checked,this.wrappee&&e.getInstance().sendTo(this.wrappee,{bubbles:!1,detail:t.detail,type:t.type,source:this.wrappee}),this.underlineDiv&&this.underlineDiv.visibility(!1),"function"==typeof this.callback&&this.callback(this.label.getText())}})}(this),function(){$class({$namespace:"caph.ui.base.widget.audioPlayer",$constructor:function(){},$statics:{getPlayerInstance:function(t,e){var i=caph.require("stripe.ui.widget.audioPlayer.html5");return new i(t,e)}}})}(this),function(){"use strict";$class({$namespace:"caph.ui.base.widget.videoPlayer",$constructor:function(){},$statics:{getPlayerInstance:function(t){var e=null;return t=t||{},e=new caph.stripe.ui.widget.videoPlayer.html5(t)}}})}(this),function(window){"use strict";var View=caph.require("module.renderer.View"),componentBase=caph.require("ui.base.Component"),VDomLookUpTable=null,Icon=null,Button=null,timelinePlayer=null,timeline1=null,timeline2=null,animatingDiv=null,visibleDiv=null,cacheImage=[],MAX_CACHE_LEN=5,cacheIdx=0,self=null,_KEY_CODE={RETURN:0,RETURN_TV:10009,RETURN_ORSAY:88},_IMAGE_VIEWER_STATE={STATE_STOPPED:0,STATE_PLAYING:1,STATE_PAUSED:2},_SLIDESHOW_SPEED={SLOW:8e3,NORMAL:5e3,FAST:3e3},_SLIDESHOW_SPEED_TEXT={SLOW:"Slow",NORMAL:"Normal",FAST:"Fast"},_SLIDESHOW_EFFECT={CORNER_WIPE:"_cornerWipe",FADE_IN_STILL:"_fadeInStill",FADE_IN_LEFT:"_fadeInLeft",FADE_IN_RIGHT:"_fadeInRight",FADE_IN_DOWN:"_fadeInDown",FADE_IN_TOP:"_fadeInTop",SPIN_FADE_IN:"_spinFadeIn"},_SLIDESHOW_EFFECT_TEXT={CORNER_WIPE:"Corner Wipe",FADE_IN_STILL:"Fade In Still",FADE_IN_LEFT:"Fade In Left",FADE_IN_RIGHT:"Fade In Right",FADE_IN_DOWN:"Fade In Down",FADE_IN_TOP:"Fade In Top",SPIN_FADE_IN:"Spin Fade In"},_ANIMATION_STATE={RUNNING:0,COMPLETE:1},_ZOOM_STATE={NORMAL:0,ZOOM_2X:1,ZOOM_4X:2},_RESOLUTION=null,IMAGEVIEWER_DIMENSION={1080:{SETTING_MENU_BUTTON:{POSITION:[0,60,0],SIZE:[500,60],FONT_SIZE:30,LINE_HEIGHT:60},CHECKLIST_CONTAINER:{FONT_SIZE:30,TOP:5,LEFT:5},CHECKLIST_SPEED:{POSITION:[0,52,0],SIZE:[180,35]},CHECKLIST_LABEL:{POSITION:[0,0,0],SIZE:[60,50]},CHECKLIST_EFFECT:{POSITION:[0,52,0],SIZE:[300,52]},MENU_FRAME:{POSITION:[1665,180,999],SIZE:[180,52],PADDING:0},EFFECT_FRAME:{POSITION:[1550,240,999],SIZE:[300,52],PADDING:0},SLIDER:{WIDTH:1650,POSITION:[80,15,0],THUMB_COUNT:12},IMAGE_SLIDER_CONTAINER:{POSITION:[0,120,999],SIZE:[1900,35]},MUSIC_INFO:{POSITION:[1300,880,999],SIZE:[550,50],FONT_SIZE:26,LINE_HEIGHT:50,PADDING:10},SETTING_FRAME:{POSITION:[1405,124,998],SIZE:[500,300],PADDING:0},ZOOMROTATE_FRAME:{POSITION:[100,800,999],SIZE:[340,270]},ZOOM_PANEL:{POSITION:[74,0,2],SIZE:[200,200]},MINIMAP_POINTER:{BORDER_WIDTH:1,POSITION:[0,0,2],SIZE:[200,200]},POINTER_BOX:{POSITION:[50,50,2],SIZE:[100,100]},ARROW_TOP:{POSITION:[90,22,2],SIZE:[25,20]},ARROW_DOWN:{POSITION:[90,158,2],SIZE:[25,20]},ARROW_LEFT:{POSITION:[22,90,2],SIZE:[20,25]},ARROW_RIGHT:{POSITION:[161,90,2],SIZE:[20,25]},ZOOMROTATE_PANEL:{POSITION:[0,210,9],SIZE:[365,60]},ZOOM_IN:{POSITION:[0,0],SIZE:[60,60]},ZOOM_OUT:{POSITION:[60,0],SIZE:[60,60]},RESET:{POSITION:[120,0],SIZE:[125,60]},ROTATE_LEFT:{POSITION:[245,0],SIZE:[60,60]},ROTATE_RIGHT:{POSITION:[305,0],SIZE:[60,60]},INFOMAIN_DIV:{POSITION:[0,0,1e3],SIZE:[1920,680]},TOOLTIP:{POSITION:[30,0,0],SIZE:[80,60],FONT_SIZE:'20pt "Samsung SVD_Medium"'},PLAY:{POSITION:[10,0],SIZE:[54,54],TOOLTIP_FOCUS_POS:[2,65]},PAUSE:{POSITION:[10,0],SIZE:[54,54],TOOLTIP_FOCUS_POS:[2,65]},BGM_ICON:{POSITION:[1790,0],SIZE:[54,54],TOOLTIP_FOCUS_POS:[1770,65]},SETTING_ICON:{POSITION:[1855,0],SIZE:[54,54],TOOLTIP_FOCUS_POS:[1805,65]},THUMBNAIL_DIMENSIONS:{WIDTH:140,HEIGHT:170,PADDING:10}},720:{SETTING_MENU_BUTTON:{POSITION:[0,40,0],SIZE:[334,40],FONT_SIZE:20,LINE_HEIGHT:40},CHECKLIST_CONTAINER:{FONT_SIZE:20,TOP:3,LEFT:3},CHECKLIST_SPEED:{POSITION:[0,35,0],SIZE:[120,35]},CHECKLIST_LABEL:{POSITION:[0,0,0],SIZE:[40,33]},CHECKLIST_EFFECT:{POSITION:[0,35,0],SIZE:[200,35]},MENU_FRAME:{POSITION:[1110,120,999],SIZE:[120,35],PADDING:0},EFFECT_FRAME:{POSITION:[1033,160,999],SIZE:[200,35],PADDING:0},SLIDER:{WIDTH:1100,POSITION:[53,10,0],THUMB_COUNT:12},IMAGE_SLIDER_CONTAINER:{POSITION:[0,80,999],SIZE:[1267,35]},MUSIC_INFO:{POSITION:[867,587,999],SIZE:[367,33],FONT_SIZE:17,LINE_HEIGHT:33,PADDING:7},SETTING_FRAME:{POSITION:[936,83,665],SIZE:[334,200],PADDING:0},ZOOMROTATE_FRAME:{POSITION:[67,533,999],SIZE:[227,180]},ZOOM_PANEL:{POSITION:[55,0,2],SIZE:[133,133]},MINIMAP_POINTER:{BORDER_WIDTH:1,POSITION:[0,0,2],SIZE:[133,133]},POINTER_BOX:{POSITION:[33,33,2],SIZE:[67,67]},ARROW_TOP:{POSITION:[60,15,2],SIZE:[17,13]},ARROW_DOWN:{POSITION:[60,105,2],SIZE:[17,13]},ARROW_LEFT:{POSITION:[15,60,2],SIZE:[13,17]},ARROW_RIGHT:{POSITION:[107,60,2],SIZE:[13,17]},ZOOMROTATE_PANEL:{POSITION:[0,140,9],SIZE:[250,40]},ZOOM_IN:{POSITION:[0,0,2],SIZE:[40,40]},ZOOM_OUT:{POSITION:[40,0,2],SIZE:[40,40]},RESET:{POSITION:[80,0,2],SIZE:[90,40]},ROTATE_LEFT:{POSITION:[170,0,2],SIZE:[40,40]},ROTATE_RIGHT:{POSITION:[210,0,2],SIZE:[40,40]},INFOMAIN_DIV:{POSITION:[0,0,1e3],SIZE:[1280,454]},TOOLTIP:{POSITION:[0,0,0],SIZE:[60,40],FONT_SIZE:'16pt "Samsung SVD_Medium"'},PLAY:{POSITION:[7,0,0],SIZE:[36,36],TOOLTIP_FOCUS_POS:[0,45]},PAUSE:{POSITION:[7,0],SIZE:[36,36],TOOLTIP_FOCUS_POS:[0,45]},BGM_ICON:{POSITION:[1190,0],SIZE:[36,36],TOOLTIP_FOCUS_POS:[1180,45]},SETTING_ICON:{POSITION:[1235,0],SIZE:[36,36],TOOLTIP_FOCUS_POS:[1193,45]},THUMBNAIL_DIMENSIONS:{WIDTH:93,HEIGHT:113,PADDING:7}}},no_imageAvaialable_url=null,_MenuButton=null,_checkListContainer=null,log=function(){};$class({$namespace:"caph.ui.base.widget.imageViewer",$extends:componentBase,$constructor:function(t){if(log("Image viewer constructor"),t=t||{},this.$super(t),this.addClass("caph-imageviewer"),self=this,!(void 0!=t.itemList&&t.hasOwnProperty("itemList")&&caph.isObject(t.itemList)&&t.itemList.hasOwnProperty("items")&&caph.isObject(t.itemList.items)))throw"Error: Items are not found ..Please provide items.";if(!t.itemList.items.length)throw"Error: Items are empty.";_RESOLUTION=1080>window.innerHeight?{WIDTH:1280,HEIGHT:720}:{WIDTH:1920,HEIGHT:1080},no_imageAvaialable_url="../../../build/2.0.0/stripe/"+_RESOLUTION.HEIGHT+"/broken_image.png",this.dimension=IMAGEVIEWER_DIMENSION[_RESOLUTION.HEIGHT],Icon=caph.require("stripe.ui.component.Icon"),Button=caph.require("stripe.ui.component.Button"),VDomLookUpTable=caph.require("module.renderer._VDomLookUpTable").getInstance(),this.focusManager=caph.require("module.focus.Manager").getInstance(),this.callback=void 0!==t.callback&&caph.isFunction(t.callback)?t.callback:function(){log("No CallBack provided!!")},this._playList.list=t.itemList.items,this._playList.currentImageIndex=0,this.settingDom=null,this.speedContextMenu=null,this.effectContextMenu=null,this.zoomRotateArea=null,this.zoomPanel=null,this.miniMapImg=null,this.zoomRotatePanel=null,this.miniMapPointer=null,this.pointerBox=null,this.isEnter=!1,this.arrowTop=null,this.arrowDown=null,this.arrowLeft=null,this.arrowRight=null,this.currZoomState=_ZOOM_STATE.NORMAL,this.calbackQueueTimer=null,this.infoPopup=null,this.infoPopupTimer=null,this.msgOkBtn=null,this.imgSlider=null,this.VISIBLE_THUMB=this.dimension.SLIDER.THUMB_COUNT,this.slideIndex=0,this.sliderWidth=this.dimension.SLIDER.WIDTH,this.sliderInterval=this.sliderWidth/(this._playList.list.length-1),this.frontImageDom=null,this.backImageDom=null,this.frontImage=null,this.backImage=null,this.swichDomFlag=0,this.animTransObj=new caph.animation.Transform,this.visibleTransObj=new caph.animation.Transform,this.animationState=_ANIMATION_STATE.COMPLETE,this.infoView=null,this.tooltip=null,this.playIcon=null,this.pauseIcon=null,this.settingIcon=null,this.playerIcon=null,this.playerOffIcon=null,this.slider=null,this.prevState=_IMAGE_VIEWER_STATE.STATE_STOPPED,this._setSlideshowState(_IMAGE_VIEWER_STATE.STATE_STOPPED),this._setSpeed(_SLIDESHOW_SPEED.NORMAL),this._setEffect(_SLIDESHOW_EFFECT.CORNER_WIPE),this.settingItems=["Slideshow Speed","Slideshow Effect","Zoom & Rotate","Background Music","Information"],this.audioList=t.audioList,this.audioPlayer=null,this.musicInfo=null,this.hideMenuTimer=null,this.hideSliderTimer=null,this._initCustomComponents(),this._createElement(),this.focusable(!0);var e=caph.require("module.event.Manager").getInstance();e.addObserver(this)},_initCustomComponents:function(){_MenuButton=$class({$extends:Button,$constructor:function(t){this.$super(t),this.setProperty({id:t.id,style:{border:"1px solid rgba(255,255,255,.1)",width:IMAGEVIEWER_DIMENSION[_RESOLUTION.HEIGHT].SETTING_MENU_BUTTON.SIZE[0]+"px",fontSize:IMAGEVIEWER_DIMENSION[_RESOLUTION.HEIGHT].SETTING_MENU_BUTTON.FONT_SIZE+"px",lineHeight:IMAGEVIEWER_DIMENSION[_RESOLUTION.HEIGHT].SETTING_MENU_BUTTON.LINE_HEIGHT+"px",color:"rgba(255, 255, 255, 0.6)"}})},onfocus:function(){this.focus&&(this.addClass("submenuFocus"),this._children[0].setStyle({color:"#464646"}))},onblur:function(){this.removeClass("submenuFocus"),this._children[0].setStyle({color:"rgba(255, 255, 255, 0.6)"})},onclick:function(t){this._update(t)},onkeydown:function(t){t.detail.keyCode;var e=this.getProperty("innerText").split(":")[0];t.key().enter&&this._update(t),t.key().up&&e==self.settingItems[0]&&t.stopPropagation(),t.key().down&&e==self.settingItems[4]&&t.stopPropagation(),(t.key().left||t.key().right)&&t.stopPropagation()},onkeyup:function(t){if(t.key().enter){var e=this.getProperty("innerText").split(":")[0];switch(e){case self.settingItems[4]:self._showInfoPopup();break;default:}}},_update:function(t){self._hideContextMenu();var e=this.getProperty("innerText").split(":")[0];switch(e){case self.settingItems[0]:self.speedContextMenu.visibility(!0),self.focusManager.focus(self.speedContextMenu._children[0]);break;case self.settingItems[1]:self.effectContextMenu.visibility(!0),self.focusManager.focus(self.effectContextMenu._children[0]);
break;case self.settingItems[2]:self.prevState=self._getSlideshowState(),self.pauseIcon.visibility()&&self.pauseIcon._onclick(),self.zoomRotateArea.visibility()||(self._setZoom(),self.zoomRotateArea.visibility(!0),self.settingDom.visibility(!1),self.focusManager.focus(self.zoomRotatePanel._children[0]));break;case self.settingItems[3]:if(self.playerIcon.visibility()||self.playerOffIcon.visibility())self.audioPlayer.stop();else{if(caph.isNull(self.audioPlayer)){var i={playList:self.audioList,audioControls:!1,deviceProfile:0},n=caph.require("ui.base.widget.audioPlayer");self.audioPlayer=n.getPlayerInstance(i,{position:[0,0]}),self.audioPlayer.setRepeatMode("all"),self.audioPlayer.addListener("statechanged",function(t){switch(t){case"playing":self.playerIcon.visibility(!0),self.playerIcon.focusable(!0),self.playerOffIcon.visibility(!1),self.playerOffIcon.focusable(!1);var e=self.audioPlayer.getCurItem(),i=e.title||"track info not provided";self.musicInfo.visibility(!0),self.musicInfo.setProperty({innerHTML:"Now playing : "+i});break;case"paused":self.playerIcon.visibility(!1),self.playerIcon.focusable(!1),self.playerOffIcon.visibility(!0),self.playerOffIcon.focusable(!0);break;case"stopped":self.playerIcon.visibility(!1),self.playerIcon.focusable(!1),self.playerOffIcon.visibility(!1),self.playerOffIcon.focusable(!1),self.musicInfo.visibility(!1);break;default:}})}self.settingDom.visibility(!1),self.focusManager.focus(self.playerIcon),self.audioPlayer.play()}break;case self.settingItems[4]:"click"==t.type&&self._showInfoPopup();break;default:}}}),_checkListContainer=$class({$extends:componentBase,$constructor:function(t){this.$super(t),this.focusable(!0),this.focus=t.focus||!1,this.text=t.text,this._createContainer(t),this.setProperty({id:t.id,itemIndex:t.itemIndex,style:{border:"1px solid rgba(255,255,255,0.1)",width:t.width+"px",fontSize:IMAGEVIEWER_DIMENSION[_RESOLUTION.HEIGHT].CHECKLIST_CONTAINER.FONT_SIZE+"px"}})},_createContainer:function(t){var e=this,i=caph.require("stripe.ui.component.Checkbox"),n=caph.require("ui.base.component.Label");e.checkbox=new i({hasBox:t.hasBox,checked:t.checked,dom:{style:{marginTop:IMAGEVIEWER_DIMENSION[_RESOLUTION.HEIGHT].CHECKLIST_CONTAINER.TOP+"px",marginLeft:IMAGEVIEWER_DIMENSION[_RESOLUTION.HEIGHT].CHECKLIST_CONTAINER.LEFT+"px",position:"relative","float":"left"}}}),e.checkbox.on({statechange:function(){e._change()}}),e.label=new n({text:t.text,align:{horizontal:"left",vertical:"middle"},size:[t.width-IMAGEVIEWER_DIMENSION[_RESOLUTION.HEIGHT].CHECKLIST_LABEL.SIZE[0],IMAGEVIEWER_DIMENSION[_RESOLUTION.HEIGHT].CHECKLIST_LABEL.SIZE[1]],dom:{style:{position:"relative",color:"white"}}}),e.addChild(this.checkbox),e.addChild(this.label)},_change:function(){this.state=this.text+" State : "+this.checkbox.isChecked()},_update:function(){this.isEnable&&(this._toggleGroup(),this.checkbox.setChecked(!0),this._updateValue())},_updateValue:function(){var id=this.getProperty("id"),splitArr=id.split("_"),group=splitArr.shift(),text=splitArr.join("_").toUpperCase();switch(group){case"effect":self._setEffect(eval("_SLIDESHOW_EFFECT."+text)),self.settingDom._children[1].setContent(self.settingItems[1]+":"+self._getEffectName()),self.effectContextMenu.visibility(!1),self.focusManager.focus(self.settingDom._children[1]);break;case"speed":self._setSpeed(eval("_SLIDESHOW_SPEED."+text)),VDomLookUpTable.getDom(self.infoView._children[1]).innerText=self._getSpeedText(),self.settingDom._children[0].setContent(self.settingItems[0]+":"+self._getSpeedText()),self.speedContextMenu.visibility(!1),self.focusManager.focus(self.settingDom._children[0]);break;default:}},_toggleGroup:function(){var t,e=this._parent,i=e.getChildren(),n=i.length;for(t=0;n>t;t++){var s=i[t].getChildren();s.length&&s[0].setChecked(!1)}},onfocus:function(){this.focus&&(this.addClass("submenuFocus"),this.label.setStyle({color:"#464646"}))},onblur:function(){this.removeClass("submenuFocus"),this.label.setStyle({color:"rgba(255, 255, 255, 0.6)"})},onkeydown:function(t){var e=this.getProperty("itemIndex");t.key().enter&&this.isEnable()&&this._update(),t.key().up&&0==e&&t.stopPropagation(),t.key().down&&e===this._parent._children.length-1&&t.stopPropagation(),(t.key().left||t.key().right)&&t.stopPropagation()},onclick:function(){this.focus&&this._update()}})},onkeydown:function(t){var e=t.detail.keyCode;switch(log("KEYDOWN>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"),log("Image viewer onkeydown>> "+e),self.zoomRotateArea.visibility()||"none"!=self._children[0].getStyle("display")||(self._showControllerMenu(),t.stopPropagation()),e){case _KEY_CODE.RETURN:case _KEY_CODE.RETURN_ORSAY:case _KEY_CODE.RETURN_TV:self.speedContextMenu.visibility()?(self.speedContextMenu.visibility(!1),self.focusManager.focus(self.settingDom._children[0])):self.effectContextMenu.visibility()?(self.effectContextMenu.visibility(!1),self.focusManager.focus(self.settingDom._children[1])):self.zoomRotateArea.visibility()?(self.zoomRotateArea.visibility(!1),self.focusManager.focus(self.settingDom._children[2])):self.infoPopup.visibility()?self._hideInfoPopup():self.imgSlider.visibility()?(self._hideImageSlider(),self.focusManager.focus(self.slider)):self.settingDom.visibility()?(self.settingDom.visibility(!1),self.focusManager.focus(self.settingIcon)):(log("Destroy and Return"),self._close()),t.preventDefault();break;default:}},onclick:function(t){log("Image viewer onclick"),"none"==self._children[0].getStyle("display")&&(self._showControllerMenu(),t.stopPropagation())},_createElement:function(){log("Image viewer _createElement");var t=this._createMenu(),e=this._createSlideShowDom();this.imgSlider=this._createImageSlider(),this.settingDom=this._createSettingsFrame(),this.speedContextMenu=this._createSpeedContextMenu(),this.effectContextMenu=this._createEffectContextMenu(),this.zoomRotateArea=this._createZoomRotateArea(),this.infoPopup=this._createinfoPopup(),this.musicInfo=new componentBase({position:self.dimension.MUSIC_INFO.POSITION,size:self.dimension.MUSIC_INFO.SIZE,dom:{id:"nowPlayingArea",style:{padding:self.dimension.MUSIC_INFO.PADDING+"px",fontSize:self.dimension.MUSIC_INFO.FONT_SIZE+"px",lineHeight:self.dimension.MUSIC_INFO.LINE_HEIGHT+"px",color:"#FFF",visibility:"hidden",opacity:.6}}}),this.addChild([t,e,this.musicInfo,this.settingDom,this.speedContextMenu,this.effectContextMenu,this.infoPopup,this.zoomRotateArea,this.imgSlider])},_createMenu:function(){log("Image viewer _createMenu");var t=new View;t.position(0,0,999),t.addClass("caph-imageviewer-view"),this.infoView=this._createInfoView();var e=this._createControllerView();return t.addChild([this.infoView,e]),t},_createInfoView:function(){log("Image viewer _createInfoView");var t=new View,e=new View,i=new View,n=new View,s=new View;return e.addClass("fileinfo"),i.addClass("dateinfo"),n.addClass("speedinfo"),s.addClass("filecountinfo"),t.addChild([e,n,i,s]),t.addClass("caph-imageviewer-info-view"),t},_createControllerView:function(){log("Image viewer _createControllerView");var t=new View({dom:{id:"controllerMenu"}}),e=caph.require("stripe.ui.component.Tooltip");this.tooltip=new e({text:"Play",direction:caph.ui.base.component.Tooltip.TOP,align:caph.ui.base.component.Tooltip.CENTER,size:self.dimension.TOOLTIP.SIZE}),this.tooltip.setTextFont(self.dimension.TOOLTIP.FONT_SIZE),this.tooltip.setTailDirection(caph.ui.base.component.Tooltip.TOP),this.tooltip.setTailAlign(caph.ui.base.component.Tooltip.CENTER),this.playIcon=new Button({size:self.dimension.PLAY.SIZE,position:self.dimension.PLAY.POSITION,contents:Icon.play(),on:{click:function(){self._callBackOnAnimationComplete(function(){self._startSlideshow()})},focus:function(){self.tooltip.position(self.dimension.PLAY.TOOLTIP_FOCUS_POS[0],self.dimension.PLAY.TOOLTIP_FOCUS_POS[1]),self.tooltip.setTailAlign(caph.ui.base.component.Tooltip.CENTER),self.tooltip.setText("Play"),self.tooltip.show()},blur:function(){self.tooltip.hide()},keydown:function(t){"block"==self._children[0].getStyle("display")&&(self._resetControllerMenuTimer(),t.key().enter&&self._callBackOnAnimationComplete(function(){self._startSlideshow()}),(t.key().up||t.key().down)&&t.stopPropagation())}}}),this.playIcon.addClass("custom-icon"),this.pauseIcon=new Button({size:self.dimension.PAUSE.SIZE,position:self.dimension.PAUSE.POSITION,contents:Icon.pause(),dom:{style:{visibility:"hidden"}},on:{click:function(){self._stopSlideshow(),self.focusManager.focus(self.playIcon)},focus:function(){self.tooltip.position(self.dimension.PAUSE.TOOLTIP_FOCUS_POS[0],self.dimension.PAUSE.TOOLTIP_FOCUS_POS[1]),self.tooltip.setTailAlign(caph.ui.base.component.Tooltip.CENTER),self.tooltip.setText("Pause"),self.tooltip.show()},blur:function(){self.tooltip.hide()},keydown:function(t){"block"==self._children[0].getStyle("display")&&(self._resetControllerMenuTimer(),t.key().enter&&(self._stopSlideshow(),self.focusManager.focus(self.playIcon)),(t.key().up||t.key().down)&&t.stopPropagation())}}}),this.pauseIcon.addClass("custom-icon"),this.pauseIcon.visibility(!1),this.pauseIcon.focusable(!1);var i=caph.require("stripe.ui.component.Slider");return this.slider=new i({width:self.sliderWidth,position:self.dimension.SLIDER.POSITION,value:0,dom:{id:"sliderComp"}}),this.slider.on({click:function(t){self.slider._isEnter&&(self._stopSlideshow(),self.imgSlider.visibility()||(self.slider._setEnterStatus(!1),self._callBackOnAnimationComplete(self._showImageSlider),t.stopPropagation()))},keydown:function(t){"block"==self._children[0].getStyle("display")?(t.key().enter&&self.slider._isEnter&&(self._stopSlideshow(),self.imgSlider.visibility()||(self.slider._setEnterStatus(!1),self._callBackOnAnimationComplete(self._showImageSlider),t.stopPropagation())),t.key().left&&self.slider._isEnter&&self.imgSlider.visibility()&&self._moveSlider(t),t.key().right&&self.slider._isEnter&&self.imgSlider.visibility()&&self._moveSlider(t),t.key().down&&self.slider._isEnter&&self.imgSlider.visibility()&&(self.imgSlider._children[0]._children[self._playList.currentImageIndex].focus(),t.stopPropagation())):(self._showControllerMenu(),t.stopPropagation())}}),this.playerIcon=new Button({size:self.dimension.BGM_ICON.SIZE,position:self.dimension.BGM_ICON.POSITION,contents:Icon.bgm(),dom:{style:{visibility:"hidden"}},on:{click:function(){self._pauseMusic(),self.focusManager.focus(self.playerOffIcon)},keydown:function(t){"block"==self._children[0].getStyle("display")&&(self._resetControllerMenuTimer(),(t.key().up||t.key().down)&&t.stopPropagation(),t.key().enter&&(self._pauseMusic(),self.focusManager.focus(self.playerOffIcon)))},focus:function(){self.tooltip.position(self.dimension.BGM_ICON.TOOLTIP_FOCUS_POS[0],self.dimension.BGM_ICON.TOOLTIP_FOCUS_POS[1]),self.tooltip.setTailAlign(caph.ui.base.component.Tooltip.CENTER),self.tooltip.setText("Play"),self.tooltip.show()},blur:function(){self.tooltip.hide()}}}),this.playerIcon.addClass("custom-icon"),this.playerIcon.focusable(!1),this.playerOffIcon=new Button({size:self.dimension.BGM_ICON.SIZE,position:self.dimension.BGM_ICON.POSITION,contents:Icon.bgmOff(),dom:{style:{visibility:"hidden"}},on:{click:function(){self._resumeMusic(),self.focusManager.focus(self.playerIcon)},keydown:function(t){"block"==self._children[0].getStyle("display")&&(self._resetControllerMenuTimer(),(t.key().up||t.key().down)&&t.stopPropagation(),t.key().enter&&(self._resumeMusic(),self.focusManager.focus(self.playerIcon)))},focus:function(){self.tooltip.position(self.dimension.BGM_ICON.TOOLTIP_FOCUS_POS[0],self.dimension.BGM_ICON.TOOLTIP_FOCUS_POS[1]),self.tooltip.setTailAlign(caph.ui.base.component.Tooltip.CENTER),self.tooltip.setText("Pause"),self.tooltip.show()},blur:function(){self.tooltip.hide()}}}),this.playerOffIcon.addClass("custom-icon"),this.playerOffIcon.visibility(!1),this.playerOffIcon.focusable(!1),this.settingIcon=new Button({size:self.dimension.SETTING_ICON.SIZE,position:self.dimension.SETTING_ICON.POSITION,contents:Icon.setting(),on:{click:function(){self._toggleOptionsMenu()},focus:function(){self.tooltip.position(self.dimension.SETTING_ICON.TOOLTIP_FOCUS_POS[0],self.dimension.SETTING_ICON.TOOLTIP_FOCUS_POS[1]),self.tooltip.setTailAlign(caph.ui.base.component.Tooltip.RIGHT),self.tooltip.setText("Options"),self.tooltip.show()},blur:function(){self.tooltip.hide()},keydown:function(t){"block"==self._children[0].getStyle("display")&&(self._resetControllerMenuTimer(),(t.key().up||t.key().down)&&t.stopPropagation(),t.key().enter&&self._toggleOptionsMenu())}}}),this.settingIcon.addClass("custom-icon"),t.addChild([this.playIcon,this.tooltip,this.pauseIcon,this.slider,this.playerIcon,this.playerOffIcon,this.settingIcon]),t.addClass("caph-imageviewer-controller-view"),t},_createSlideShowDom:function(){log("Image viewer _createSlideShowDom");var t=new View({id:"slideshowDom"});return t.addClass("caph-ui-imageslideshow"),this.frontImageDom=new componentBase,this.frontImageDom.setProperty({id:"frontImageDomId",innerHTML:'<img id="frontImage" width="100%" height="100%"></img>',style:{height:_RESOLUTION.HEIGHT+"px",width:_RESOLUTION.WIDTH+"px"}}),this.frontImageDom.addClass("caph-ui-imageslideshow"),this.backImageDom=new componentBase,this.backImageDom.setProperty({id:"backImageDomId",innerHTML:'<img id="backImage" width="100%" height="100%"></img>',style:{height:_RESOLUTION.HEIGHT+"px",width:_RESOLUTION.WIDTH+"px"}}),this.backImageDom.addClass("caph-ui-imageslideshow"),t.addChild([this.backImageDom,this.frontImageDom]),t},_createSettingsFrame:function(){log("Image viewer _createSettingsFrame");var t,e=new View({dom:{id:"settingFrameContainer",style:{outline:"2px solid rgba(24,29,35,.95)",border:"2px solid rgba(89,107,129,.9)",padding:self.dimension.SETTING_FRAME.PADDING+"px",boxShadow:"inset 2px 2px 2px rgba(89,107,129,.95),inset -2px 2px 2px rgba(89,107,129,.95),inset 2px -2px 2px rgba(89,107,129,.95),inset -2px -2px 2px rgba(89,107,129,.95)",backgroundColor:"#1f2b3d"}}});for(t=0;5>t;t++)switch(t){case 0:e.addChild(this._createSettingItem(t,this.settingItems[t]+":"+self._getSpeedText()));break;case 1:e.addChild(this._createSettingItem(t,this.settingItems[t]+":"+self._getEffectName()));break;default:e.addChild(this._createSettingItem(t,this.settingItems[t]))}return e.size(self.dimension.SETTING_FRAME.SIZE),e.position(self.dimension.SETTING_FRAME.POSITION[0],self.dimension.SETTING_FRAME.POSITION[1],self.dimension.SETTING_FRAME.POSITION[2]),e.visibility(!1),e},_createSettingItem:function(t,e){log("Image viewer _createSettingItem");var i=new _MenuButton({type:"button",size:self.dimension.SETTING_MENU_BUTTON.SIZE,dom:{id:"item"+t,itemIndex:t+1}});return i.addClass("settingFrameButton"),i.y(self.dimension.SETTING_MENU_BUTTON.POSITION[1]*t),i.setContent(e),i},_createSpeedContextMenu:function(){log("Image viewer _createSpeedContextMenu");var t,e=new View({dom:{id:"speedContextMenu",style:{outline:"2px solid rgba(24,29,35,.95)",border:"2px solid rgba(89,107,129,.9)",padding:self.dimension.MENU_FRAME.PADDING+"px",boxShadow:"inset 2px 2px 2px rgba(89,107,129,.95),inset -2px 2px 2px rgba(89,107,129,.95),inset 2px -2px 2px rgba(89,107,129,.95),inset -2px -2px 2px rgba(89,107,129,.95)",backgroundColor:"#1f2b3d"}}}),i=0,n=this._getSpeedText();for(t in _SLIDESHOW_SPEED_TEXT){var s=new _checkListContainer({focus:!0,width:self.dimension.CHECKLIST_SPEED.SIZE[0],position:[self.dimension.CHECKLIST_SPEED.POSITION[0],self.dimension.CHECKLIST_SPEED.POSITION[1]*i],text:_SLIDESHOW_SPEED_TEXT[t],hasBox:!1,id:"speed_"+caph.toCamelCase(t),itemIndex:i,checked:n==_SLIDESHOW_SPEED_TEXT[t]?!0:!1});e.addChild(s),i++}return e.size([self.dimension.MENU_FRAME.SIZE[0],self.dimension.MENU_FRAME.SIZE[1]*i]),e.position(self.dimension.MENU_FRAME.POSITION[0],self.dimension.MENU_FRAME.POSITION[1],self.dimension.MENU_FRAME.POSITION[2]),e.visibility(!1),e},_createEffectContextMenu:function(){log("Image viewer _createEffectContextMenu");var t=new View({dom:{id:"effectContextMenu",style:{outline:"2px solid rgba(24,29,35,.95)",border:"2px solid rgba(89,107,129,.9)",padding:self.dimension.EFFECT_FRAME.PADDING+"px",boxShadow:"inset 2px 2px 2px rgba(89,107,129,.95),inset -2px 2px 2px rgba(89,107,129,.95),inset 2px -2px 2px rgba(89,107,129,.95),inset -2px -2px 2px rgba(89,107,129,.95)",backgroundColor:"#1f2b3d"}}}),e=0,i=this._getEffectName();for(var n in _SLIDESHOW_EFFECT_TEXT){var s=new _checkListContainer({focus:!0,width:self.dimension.CHECKLIST_EFFECT.SIZE[0],position:[self.dimension.CHECKLIST_EFFECT.POSITION[0],self.dimension.CHECKLIST_EFFECT.POSITION[1]*e],text:_SLIDESHOW_EFFECT_TEXT[n],hasBox:!1,id:"effect_"+caph.toCamelCase(n),itemIndex:e,checked:i==_SLIDESHOW_EFFECT_TEXT[n]?!0:!1});t.addChild(s),e++}return t.size([self.dimension.EFFECT_FRAME.SIZE[0],self.dimension.EFFECT_FRAME.SIZE[1]*e]),t.position(self.dimension.EFFECT_FRAME.POSITION[0],self.dimension.EFFECT_FRAME.POSITION[1],self.dimension.EFFECT_FRAME.POSITION[2]),t.visibility(!1),t},_createZoomRotateArea:function(){log("Image viewer _createZoomRotateArea");var t=new View({dom:{id:"zoomRotateFrameContainer",style:{padding:"0px"}}});return t.size(self.dimension.ZOOMROTATE_FRAME.SIZE),t.position(self.dimension.ZOOMROTATE_FRAME.POSITION[0],self.dimension.ZOOMROTATE_FRAME.POSITION[1],self.dimension.ZOOMROTATE_FRAME.POSITION[2]),this.zoomPanel=this._createZoomPanel(),this.zoomRotatePanel=this._createZoomRotatePanel(),t.addChild([this.zoomPanel,this.zoomRotatePanel]),t.visibility(!1),t},_createZoomPanel:function(){log("Image viewer _createZoomPanel");var t=new componentBase({dom:{id:"zoomPointerContainer"}}),e=new componentBase({dom:{innerHTML:'<img height="100%" width="100%" id="zoomMinimapImg"></img>'}});return e.setStyle({height:"100%",width:"100%"}),t.addChild(e),this.miniMapPointer=this._createMinimapPointer(),t.addChild(this.miniMapPointer),t.addClass("caph-ui-imageslideshow-zoompanel"),t.size(self.dimension.ZOOM_PANEL.SIZE),t.position(self.dimension.ZOOM_PANEL.POSITION[0],self.dimension.ZOOM_PANEL.POSITION[1],self.dimension.ZOOM_PANEL.POSITION[2]),t},_createMinimapPointer:function(){log("Image viewer _createMinimapPointer");var t=new componentBase({dom:{id:"miniMapPointer"},on:{click:function(){self.isEnter||(self.isEnter=!0,self._hideShowPointerArrow(!0))},focus:function(){self.pointerBox.addClass("focused")},blur:function(){self.pointerBox.removeClass("focused"),self.isEnter=!1;var t=self._getDomList(self.swichDomFlag);t.visible,t.animating,self._resetAnimatingDom(),self.miniMapPointer.position(0,0,0),self._hideShowPointerArrow(!1)},keydown:function(t){var e=t.source,i=(e._parent,self._getDomList(self.swichDomFlag)),n=i.visible,s=i.animating,o=i.visImg,r=self.currZoomState,a=(n.rotateZ(),n.scale());if(t.key().enter&&(self.isEnter||(self.isEnter=!0,self._hideShowPointerArrow(!0))),t.key().up){if(!self.isEnter)return t.stopPropagation(),void 0;if(d=-self.pointerBox.y(),r!=_ZOOM_STATE.NORMAL&&self.miniMapPointer.y()>d){var h=parseFloat((o.height*a[0]-o.height)/10,10),c=parseFloat((self.miniMapPointer.size()[1]-self.pointerBox.size()[1])/10,10);log("moveUpminiPix>>> "+c),c=c>self.miniMapPointer.y()-d?self.miniMapPointer.y()-d:c,self.miniMapPointer.translate(0,-c,0),new caph.animation.Transform(VDomLookUpTable.getDom(n)).move(0,-h,1).set(),log("self.miniMapPointer.y()>>> "+self.miniMapPointer.y())}}if(t.key().down){if(!self.isEnter)return self._hideShowPointerArrow(!1),self.focusManager.focus(self.zoomRotatePanel._children[2]),t.stopPropagation(),void 0;var l=self.pointerBox.y()-self.dimension.MINIMAP_POINTER.BORDER_WIDTH;if(log(" down toMove_Max"+l),r!=_ZOOM_STATE.NORMAL&&l>self.miniMapPointer.y()){var u=parseFloat((o.height*a[0]-o.height)/10,10),p=parseFloat((self.miniMapPointer.size()[1]-self.pointerBox.size()[1])/10,10);log("moveUpminiPix"+p),p=p>l-self.miniMapPointer.y()?l-self.miniMapPointer.y():p,self.miniMapPointer.translate(0,p,0),new caph.animation.Transform(VDomLookUpTable.getDom(n)).move(0,u,1).set(),log("self.miniMapPointer.y()"+self.miniMapPointer.y())}}if(t.key().left){if(!self.isEnter)return t.stopPropagation(),void 0;var d=-self.pointerBox.x();if(log("key code left toMove_Max"+l),r!=_ZOOM_STATE.NORMAL&&self.miniMapPointer.x()>d){var u=parseFloat((o.width*a[0]-o.width)/10,10),f=parseFloat((self.miniMapPointer.size()[0]-self.pointerBox.size()[0])/10,10);log("moveUpminiPix"+f),f=f>self.miniMapPointer.x()-d?self.miniMapPointer.x()-d:f,self.miniMapPointer.translate(-f,0,0),new caph.animation.Transform(VDomLookUpTable.getDom(n)).move(-u,0,1).set(),log("self.miniMapPointer.y()"+self.miniMapPointer.y())}}if(t.key().right){if(!self.isEnter)return t.stopPropagation(),void 0;var l=self.pointerBox.x()-self.dimension.MINIMAP_POINTER.BORDER_WIDTH;if(log("right toMove_Max"+l),r!=_ZOOM_STATE.NORMAL&&l>self.miniMapPointer.x()){var u=parseFloat((o.width*a[0]-o.width)/10,10),m=parseFloat((self.miniMapPointer.size()[0]-self.pointerBox.size()[0])/10,10);log("moveUpminiPix"+m),m=m>l-self.miniMapPointer.x()?l-self.miniMapPointer.x():m,self.miniMapPointer.translate(m,0,0),new caph.animation.Transform(VDomLookUpTable.getDom(n)).move(u,0,1).set(),log("self.miniMapPointer.y()"+self.miniMapPointer.y())}}switch(t.detail.keyCode){case _KEY_CODE.RETURN:case _KEY_CODE.RETURN_ORSAY:case _KEY_CODE.RETURN_TV:self.isEnter?(self.isEnter=!1,self._hideShowPointerArrow(!1),new caph.animation.Transform(VDomLookUpTable.getDom(n)).move(0,0,1).set(),new caph.animation.Transform(VDomLookUpTable.getDom(s)).move(0,0,0).set(),self.miniMapPointer.position(0,0,0)):(self.zoomRotateArea.visibility(!1),self._resetAnimatingDom(),self._resetSlideshowState()),t.preventDefault();break;default:}t.stopPropagation()}}});return self.pointerBox=new componentBase({dom:{id:"pointerBox",style:{border:"2px solid #ffffff"}}}),self.pointerBox.size(self.dimension.POINTER_BOX.SIZE),self.pointerBox.position(self.dimension.POINTER_BOX.POSITION[0],self.dimension.POINTER_BOX.POSITION[1],self.dimension.POINTER_BOX.POSITION[2]),self.arrowTop=new componentBase,self.arrowTop.size(self.dimension.ARROW_TOP.SIZE),self.arrowTop.position(self.dimension.ARROW_TOP.POSITION[0],self.dimension.ARROW_TOP.POSITION[1],self.dimension.ARROW_TOP.POSITION[2]),self.arrowTop.addClass("caph-ui-imageslideshow-arrow-top"),self.arrowDown=new componentBase,self.arrowDown.size(self.dimension.ARROW_DOWN.SIZE),self.arrowDown.position(self.dimension.ARROW_DOWN.POSITION[0],self.dimension.ARROW_DOWN.POSITION[1],self.dimension.ARROW_DOWN.POSITION[2]),self.arrowDown.addClass("caph-ui-imageslideshow-arrow-down"),self.arrowLeft=new componentBase,self.arrowLeft.size(self.dimension.ARROW_LEFT.SIZE),self.arrowLeft.position(self.dimension.ARROW_LEFT.POSITION[0],self.dimension.ARROW_LEFT.POSITION[1],self.dimension.ARROW_LEFT.POSITION[2]),self.arrowLeft.addClass("caph-ui-imageslideshow-arrow-left"),self.arrowRight=new componentBase,self.arrowRight.size(self.dimension.ARROW_RIGHT.SIZE),self.arrowRight.position(self.dimension.ARROW_RIGHT.POSITION[0],self.dimension.ARROW_RIGHT.POSITION[1],self.dimension.ARROW_RIGHT.POSITION[2]),self.arrowRight.addClass("caph-ui-imageslideshow-arrow-right"),t.addChild([self.pointerBox,self.arrowTop,self.arrowDown,self.arrowLeft,self.arrowRight]),t.size(self.dimension.MINIMAP_POINTER.SIZE),t.position(self.dimension.MINIMAP_POINTER.POSITION[0],self.dimension.MINIMAP_POINTER.POSITION[1],self.dimension.MINIMAP_POINTER.POSITION[2]),t.addClass("caph-ui-imageslideshow-minimapPointer"),t.focusable(!0),t},_hideShowPointerArrow:function(t){log("Image viewer _hideShowPointerArrow"),self.arrowTop.visibility(t),self.arrowDown.visibility(t),self.arrowLeft.visibility(t),self.arrowRight.visibility(t)},_createZoomRotatePanel:function(){log("Image viewer _createZoomRotatePanel");var t=new componentBase({dom:{id:"zoomRotateControl",style:{padding:"0px",background:"rgb(31, 43, 61)"}},on:{keydown:function(t){switch(t.detail.keyCode){case _KEY_CODE.RETURN:case _KEY_CODE.RETURN_ORSAY:case _KEY_CODE.RETURN_TV:self.zoomRotateArea.visibility(!1),self._resetAnimatingDom(),self._resetSlideshowState(),t.preventDefault(),t.stopPropagation();break;default:}}}}),e=new Button({size:self.dimension.ZOOM_IN.SIZE,position:self.dimension.ZOOM_IN.POSITION,contents:Icon.zoomIn(),on:{click:function(){self._zoomInSlideshowImage()},keydown:function(t){t.key().enter&&self._zoomInSlideshowImage(),t.key().left&&t.stopPropagation(),t.key().up&&(self.focusManager.focus(self.miniMapPointer),t.stopPropagation())}}}),i=new Button({size:self.dimension.ZOOM_OUT.SIZE,position:self.dimension.ZOOM_OUT.POSITION,contents:Icon.zoomOut(),on:{click:function(){self._zoomOutSlideshowImage()},keydown:function(t){t.key().enter&&self._zoomOutSlideshowImage(),t.key().up&&(self.focusManager.focus(self.miniMapPointer),t.stopPropagation())}}}),n=new Button({size:self.dimension.RESET.SIZE,position:self.dimension.RESET.POSITION,contents:"reset",on:{click:function(){self._callBackOnAnimationComplete(function(){self._setSlideshowState(_IMAGE_VIEWER_STATE.STATE_PAUSED),self._resetAnimatingDom()})},focus:function(t){t.stopPropagation()},blur:function(){},keydown:function(t){t.key().enter&&self._callBackOnAnimationComplete(function(){self._setSlideshowState(_IMAGE_VIEWER_STATE.STATE_PAUSED),self._resetAnimatingDom()}),t.key().up&&(self.focusManager.focus(self.miniMapPointer),t.stopPropagation())}}}),s=new Button({size:self.dimension.ROTATE_LEFT.SIZE,position:self.dimension.ROTATE_LEFT.POSITION,contents:Icon.rotateLeft(),on:{click:function(){self._rotateLeftSlideshowImage()},keydown:function(t){t.key().enter&&self._rotateLeftSlideshowImage(),t.key().up&&(self.focusManager.focus(self.miniMapPointer),t.stopPropagation())}}}),o=new Button({size:self.dimension.ROTATE_RIGHT.SIZE,position:self.dimension.ROTATE_RIGHT.POSITION,contents:Icon.rotateRight(),on:{click:function(){self._rotateRightSlideshowImage()},keydown:function(t){t.key().enter&&self._rotateRightSlideshowImage(),t.key().up&&(self.focusManager.focus(self.miniMapPointer),t.stopPropagation()),t.key().right&&t.stopPropagation()}}});return e.addClass("custom-icon"),i.addClass("custom-icon"),o.addClass("custom-icon"),s.addClass("custom-icon"),t.addChild([e,i,n,s,o]),t.size(self.dimension.ZOOMROTATE_PANEL.SIZE),t.position(self.dimension.ZOOMROTATE_PANEL.POSITION[0],self.dimension.ZOOMROTATE_PANEL.POSITION[1],self.dimension.ZOOMROTATE_PANEL.POSITION[2]),t},_setZoom:function(){if(log("Image viewer _setZoom"),self.miniMapImg=document.getElementById("zoomMinimapImg"),self._hideShowPointerArrow(!1),self.miniMapImg){var t=self._getDomList(self.swichDomFlag),e=(t.visible,t.animating,this.animationState==_ANIMATION_STATE.COMPLETE?t.visImg:t.animImg);self.miniMapImg.src=e.src}},_zoomInSlideshowImage:function(){if(log("Image viewer _zoomInSlideshowImage"),self.animationState==_ANIMATION_STATE.COMPLETE){var t=self._getDomList(self.swichDomFlag),e=t.visible,i=self.currZoomState;switch(e.rotateZ(),i){case _ZOOM_STATE.NORMAL:self.currZoomState=_ZOOM_STATE.ZOOM_2X,new caph.animation.Transform(VDomLookUpTable.getDom(e)).scale(2,2,1).set();break;case _ZOOM_STATE.ZOOM_2X:self.currZoomState=_ZOOM_STATE.ZOOM_4X,new caph.animation.Transform(VDomLookUpTable.getDom(e)).scale(4,4,1).set();break;case _ZOOM_STATE.ZOOM_4X:break;default:log("no Zoom status matched check implementation code")}}},_zoomOutSlideshowImage:function(){if(log("Image viewer _zoomOutSlideshowImage"),self.animationState==_ANIMATION_STATE.COMPLETE){var t=self._getDomList(self.swichDomFlag),e=t.visible,i=self.currZoomState;switch(e.rotateZ(),i){case _ZOOM_STATE.ZOOM_2X:self.currZoomState=_ZOOM_STATE.NORMAL,new caph.animation.Transform(VDomLookUpTable.getDom(e)).scale(.5,.5,1).set();break;case _ZOOM_STATE.ZOOM_4X:self.currZoomState=_ZOOM_STATE.ZOOM_2X,new caph.animation.Transform(VDomLookUpTable.getDom(e)).scale(.25,.25,1).set();break;case _ZOOM_STATE.NORMAL:break;default:log("no Zoom status matched check implementation code")}}},_rotateLeftSlideshowImage:function(){if(log("Image viewer _rotateLeftSlideshowImage"),self.animationState==_ANIMATION_STATE.COMPLETE){var t=self._getDomList(self.swichDomFlag),e=t.visible,i=t.animating;e.scale(),e.rotateZ(),caph.dom._style.set(VDomLookUpTable.getDom(i),"opacity",0),new caph.animation.Transform(VDomLookUpTable.getDom(e)).rotateZ(90).set(),new caph.animation.Transform(self.miniMapImg).rotateZ(90).set()}},_rotateRightSlideshowImage:function(){if(log("Image viewer _rotateRightSlideshowImage"),self.animationState==_ANIMATION_STATE.COMPLETE){var t=self._getDomList(self.swichDomFlag),e=t.visible,i=t.animating;e.scale(),e.rotateZ(),caph.dom._style.set(VDomLookUpTable.getDom(i),"opacity",0),new caph.animation.Transform(VDomLookUpTable.getDom(e)).rotateZ(-90).set(),new caph.animation.Transform(self.miniMapImg).rotateZ(-90).set()}},_resetSlideshowState:function(){log("Image viewer _rotateRightSlideshowImage"),self.prevState==_IMAGE_VIEWER_STATE.STATE_PLAYING?self._startSlideshow():self.focusManager.focus(self.playIcon)},_callBackOnAnimationComplete:function(t){switch(log("Image viewer _callBackOnAnimationComplete"),self.calbackQueueTimer&&(clearTimeout(self.calbackQueueTimer),self.calbackQueueTimer=null),self.animationState){case _ANIMATION_STATE.COMPLETE:t();break;case _ANIMATION_STATE.RUNNING:self.calbackQueueTimer=setTimeout(function(){self._callBackOnAnimationComplete(t)},10);break;default:}},_resetAnimatingDom:function(){log("Image viewer _resetAnimatingDom");var t=self._getDomList(self.swichDomFlag),e=t.visible,i=t.animating;caph.animation.util.initCurrentMatrix(VDomLookUpTable.getDom(e)),caph.animation.util.initCurrentOpacity(VDomLookUpTable.getDom(e)),caph.dom._style.set(VDomLookUpTable.getDom(e),"transform",""),caph.dom._style.set(VDomLookUpTable.getDom(e),"-webkit-transform",""),caph.animation.util.initCurrentMatrix(VDomLookUpTable.getDom(i)),caph.animation.util.initCurrentOpacity(VDomLookUpTable.getDom(i)),caph.dom._style.set(VDomLookUpTable.getDom(i),"transform",""),caph.dom._style.set(VDomLookUpTable.getDom(i),"-webkit-transform",""),new caph.animation.Transform(VDomLookUpTable.getDom(e)).stop().clear().move(0,0,1).set(),new caph.animation.Transform(VDomLookUpTable.getDom(i)).stop().clear().move(0,0,0).set(),caph.dom._style.set(VDomLookUpTable.getDom(e),"opacity",1),caph.dom._style.set(VDomLookUpTable.getDom(i),"opacity",1),self.currZoomState=_ZOOM_STATE.NORMAL,self.miniMapImg&&(caph.animation.util.initCurrentMatrix(self.miniMapImg),caph.animation.util.initCurrentOpacity(self.miniMapImg),caph.dom._style.set(self.miniMapImg,"transform",""),caph.dom._style.set(self.miniMapImg,"-webkit-transform",""),new caph.animation.Transform(self.miniMapImg).stop().clear().set())},_createinfoPopup:function(){log("Image viewer _createinfoPopup");var t=caph.require("stripe.ui.component.Popup"),e=new t({popupType:"ALERT",buttonContent:"OK",bgType:"MessagePopup",isBgAlphaType:!1,height:self.dimension.INFOMAIN_DIV.SIZE[1],callback:function(){self._hideInfoPopup()}});e.setProperty({id:"infoMainDiv"}),e.setTitle("Information");var i=new View({dom:{id:"infoSubDiv",innerHTML:"<div class=\"caph-video-popup-message\"><div class=\"caph-ui-imageView-leftInfoControl\"><div class=\"caph-ui-imageView-popup-infoText\">Title</div><div class=\"caph-ui-imageView-popup-infoText\">Created Date</div><div class=\"caph-ui-imageView-popup-infoText\">Format</div><div class=\"caph-ui-imageView-popup-infoText\">Size</div><div class=\"caph-ui-imageView-popup-infoText\">Resolution</div><div class=\"caph-ui-imageView-popup-infoText\">Location</div></div><div class=\"caph-ui-imageView-rightInfoControl\"><div id='infoTitleDetails' class='caph-ui-imageView-popup-infoText'></div><div id='infoLastSavedDateDetails' class='caph-ui-imageView-popup-infoText'></div><div id='infoFormatDetails' class='caph-ui-imageView-popup-infoText'></div><div id='infoSizeDetails' class='caph-ui-imageView-popup-infoText'></div><div id='infoResolutionDetails' class='caph-ui-imageView-popup-infoText'></div><div id='infoLocationDetails' class='caph-ui-imageView-popup-infoText'></div></div></div>"}});return i.addClass("caph-ui-imageViewer-popup-messageContainer"),e.addChild(i),e.addClass("caph-ui-imageViewer-popup-bgFog"),e.position(self.dimension.INFOMAIN_DIV.POSITION[0],self.dimension.INFOMAIN_DIV.POSITION[1],self.dimension.INFOMAIN_DIV.POSITION[2]),e.visibility(!1),e
},_showInfoPopup:function(){log("Image viewer _showInfoPopup"),self.infoPopup.show(),self.infoPopupTimer=setTimeout(function(){self._hideInfoPopup()},5e3)},_hideInfoPopup:function(){log("Image viewer _hideInfoPopup"),clearTimeout(self.infoPopupTimer),self.infoPopup.close(),self.focusManager.focus(self.settingDom._children[4])},_createImageSlider:function(){log("Image viewer _createImageSlider");var t,e=this._playList.list.length,i=new View({dom:{id:"imageSliderBox",style:{overflow:"hidden",padding:"10px",visibility:"hidden"}}}),n=new View({dom:{id:"imageSlider"}});for(n.size([e*(self.dimension.THUMBNAIL_DIMENSIONS.WIDTH+self.dimension.THUMBNAIL_DIMENSIONS.PADDING),self.dimension.THUMBNAIL_DIMENSIONS.HEIGHT]),n.position(0,0,9),t=0;e>t;t++){var s=this._playList.list[t].thumb||"../../../build/2.0.0/stripe/"+_RESOLUTION.HEIGHT+"/broken_image_thumb.png",o=new componentBase({position:[t*(self.dimension.THUMBNAIL_DIMENSIONS.WIDTH+self.dimension.THUMBNAIL_DIMENSIONS.PADDING),0,0],size:[self.dimension.THUMBNAIL_DIMENSIONS.WIDTH,self.dimension.THUMBNAIL_DIMENSIONS.HEIGHT],dom:{id:"image_"+t,itemIndex:t+1,style:{background:"url("+s+") no-repeat",border:"2px solid #FFF",backgroundSize:"100% 100%"}},on:{keydown:function(t){t.key().up&&(self.focusManager.focus(self.slider),t.stopPropagation()),t.key().left&&self._moveSlider(t),t.key().right&&self._moveSlider(t)}}});o.focusable(!0),n.addChild(o)}return i.addChild(n),i.size([self.dimension.IMAGE_SLIDER_CONTAINER.SIZE[0],self.dimension.THUMBNAIL_DIMENSIONS.WIDTH+4*self.dimension.THUMBNAIL_DIMENSIONS.PADDING]),i.position(self.dimension.IMAGE_SLIDER_CONTAINER.POSITION[0],self.dimension.IMAGE_SLIDER_CONTAINER.POSITION[1],self.dimension.IMAGE_SLIDER_CONTAINER.POSITION[2]),i},_showImageSlider:function(){log("Image viewer _showImageSlider"),self._hideContextMenu(),self._resetAnimatingDom(),self._resetImageSliderTimer(),self.imgSlider._children[0].position(-(self.slideIndex*self.dimension.THUMBNAIL_DIMENSIONS.WIDTH),0,9),self.imgSlider._children[0]._children[self._playList.currentImageIndex].addClass("focused"),self.slider._setEnterStatus(!0),self.imgSlider.visibility(!0);var t=self._getDomList(self.swichDomFlag),e=t.animImg;e.src="",e.onerror=null},_resetImageSliderTimer:function(){self.hideSliderTimer&&(clearTimeout(self.hideSliderTimer),self.hideSliderTimer=null),self.hideSliderTimer=setTimeout(function(){self._hideImageSlider()},2e3)},_hideImageSlider:function(){if(log("Image viewer _hideImageSlider"),clearTimeout(self.hideSliderTimer),self.hideSliderTimer=null,self.slider._setEnterStatus(!1),self.imgSlider._children[0]._children.length)for(var t in self.imgSlider._children[0]._children){var e=self.imgSlider._children[0]._children[t];e.removeClass("focused")}self.imgSlider.visibility(!1),self.settingDom.visibility()?self.focusManager.focus(self.settingDom._children[0]):self.focusManager.focus(self.slider)},_moveSlider:function(t){log("Image viewer _moveSlider"),self._resetImageSliderTimer(),self._resetControllerMenuTimer();var e=this.imgSlider._children[0],i=this._playList.list.length;if(t.key().left&&(self.slideIndex&&0===this._playList.currentImageIndex-self.slideIndex&&(e.translate(self.dimension.THUMBNAIL_DIMENSIONS.WIDTH,0,0),self.slideIndex--),self.imgSlider._children[0]._children[self._playList.currentImageIndex].removeClass("focused"),self._playList.decrementIndex(),self.slider.setSelectedValue(self._playList.currentImageIndex*self.sliderInterval),self.imgSlider._children[0]._children[self._playList.currentImageIndex].addClass("focused")),t.key().right){var n=this._playList.currentImageIndex+1;i>n&&n>=self.VISIBLE_THUMB+self.slideIndex&&(e.translate(-self.dimension.THUMBNAIL_DIMENSIONS.WIDTH,0,0),self.slideIndex++),self.imgSlider._children[0]._children[self._playList.currentImageIndex].removeClass("focused"),self._playList.incrementIndex(),self.slider.setSelectedValue(self._playList.currentImageIndex*self.sliderInterval),self.imgSlider._children[0]._children[self._playList.currentImageIndex].addClass("focused")}self._setImage(self._playList.getItem(this._playList.currentImageIndex).url),self._setImageInfo(self._playList.getItem(this._playList.currentImageIndex))},_startSlideshow:function(){log("Image viewer _startSlideshow"),self.animationState!=_ANIMATION_STATE.RUNNING&&(this._hideContextMenu(),this.settingDom.visibility(!1),this.playIcon.visibility(!1),this.playIcon.focusable(!1),this.pauseIcon.visibility(!0),this.pauseIcon.focusable(!0),self.focusManager.focus(self.pauseIcon),self._resetAnimatingDom(),this._setSlideshowState(_IMAGE_VIEWER_STATE.STATE_PLAYING),this._prepareNext())},_stopSlideshow:function(){return log("Image viewer _stopSlideshow"),self.nState===_IMAGE_VIEWER_STATE.STATE_STOPPED||self.nState===_IMAGE_VIEWER_STATE.STATE_PAUSED||self.animationState==_ANIMATION_STATE.COMPLETE?!1:(this._hideContextMenu(),this.settingDom.visibility(!1),this.pauseIcon.visibility(!1),this.pauseIcon.focusable(!1),this.playIcon.visibility(!0),this.playIcon.focusable(!0),self._callBackOnAnimationComplete(self._resetAnimatingDom),this._setSlideshowState(_IMAGE_VIEWER_STATE.STATE_STOPPED),void 0)},_toggleOptionsMenu:function(){log("Image viewer _toggleOptionsMenu"),this.settingDom.visibility()?this.settingDom.visibility(!1):(this.settingDom.visibility(!0),this.focusManager.focus(this.settingDom._children[0])),this._hideContextMenu()},_resumeMusic:function(){log("Image viewer _resumeMusic"),this._hideContextMenu(),this.settingDom.visibility(!1),this.audioPlayer.resume()},_pauseMusic:function(){log("Image viewer _pauseMusic"),this._hideContextMenu(),this.settingDom.visibility(!1),this.audioPlayer.pause()},initSlideshow:function(){log("Image viewer initSlideshow"),this.focusManager.focus(this.playIcon),this.frontImage=document.getElementById("frontImage"),this.backImage=document.getElementById("backImage");var t=this._playList.getItem(this._playList.currentImageIndex);this._cacheImage(t.url,function(){}),this._showControllerMenu(),this._setImage(t.url),this._setImageInfo(t)},_showControllerMenu:function(){log("Image viewer _showControllerMenu"),this._resetControllerMenuTimer(),this._children[0].setStyle({display:"block"}),self.zoomRotateArea.visibility()?self.focusManager.focus(self.zoomRotatePanel._children[0]):this.playIcon.visibility()?this.focusManager.focus(this.playIcon):this.pauseIcon.visibility()&&this.focusManager.focus(this.pauseIcon)},_resetControllerMenuTimer:function(){this.hideMenuTimer&&(clearTimeout(this.hideMenuTimer),this.hideMenuTimer=null),this.hideMenuTimer=setTimeout(function(){self._hideControllerMenu()},5e3)},_hideControllerMenu:function(){return log("Image viewer _hideControllerMenu"),this.settingDom.visibility()||this.imgSlider.visibility()?(clearTimeout(this.hideMenuTimer),this.hideMenuTimer=null,this.hideMenuTimer=setTimeout(function(){self._hideControllerMenu()},5e3),void 0):(clearTimeout(this.hideMenuTimer),this.hideMenuTimer=null,this._children[0].setStyle({display:"none"}),void 0)},_setSlideshowState:function(t){log("Image viewer _setSlideshowState"),this.nState=t},_getSlideshowState:function(){return log("Image viewer _getSlideshowState"),this.nState},_setImage:function(t){log("Image viewer _setImage");var e=self._getDomList(self.swichDomFlag);e.visImg.src=t},_setImageInfo:function(t){log("Image viewer _setImageInfo"),VDomLookUpTable.getDom(this.infoView._children[0]).innerText=t.title||"Unknown",VDomLookUpTable.getDom(this.infoView._children[1]).innerText=this._getSpeedText(),VDomLookUpTable.getDom(this.infoView._children[2]).innerText=t.date||"Unknown",VDomLookUpTable.getDom(this.infoView._children[3]).innerText=this._playList.currentImageIndex+1+" | "+this._playList.list.length,caph.dom.getElement("#infoTitleDetails").$[0].innerText=": "+(t.title||"Unknown"),caph.dom.getElement("#infoLastSavedDateDetails").$[0].innerText=": "+(t.date||"Unknown"),caph.dom.getElement("#infoFormatDetails").$[0].innerText=": "+(t.format||"Unknown"),caph.dom.getElement("#infoSizeDetails").$[0].innerText=": "+(t.size||"Unknown"),caph.dom.getElement("#infoResolutionDetails").$[0].innerText=": "+(t.resolution||"Unknown"),caph.dom.getElement("#infoLocationDetails").$[0].innerText=": "+(t.location||"Unknown"),this.slider.setSelectedValue(this._playList.currentImageIndex*this.sliderInterval)},_setSpeed:function(t){log("Image viewer _setSpeed"),this.slideshowSpeed=t},_setEffect:function(t){log("Image viewer _setEffect"),this.slideshowEffect=t},_getSpeed:function(){return log("Image viewer _getSpeed"),this.slideshowSpeed},_getSpeedText:function(){log("Image viewer _getSpeedText");var t=this._getSpeed(),e="";switch(t){case _SLIDESHOW_SPEED.SLOW:e=_SLIDESHOW_SPEED_TEXT.SLOW;break;case _SLIDESHOW_SPEED.NORMAL:e=_SLIDESHOW_SPEED_TEXT.NORMAL;break;case _SLIDESHOW_SPEED.FAST:e=_SLIDESHOW_SPEED_TEXT.FAST;break;default:}return e},_getEffect:function(){return log("Image viewer _getEffect"),this.slideshowEffect},_getEffectName:function(){log("Image viewer _getEffectName");var t=this._getEffect(),e="";switch(t){case _SLIDESHOW_EFFECT.CORNER_WIPE:e=_SLIDESHOW_EFFECT_TEXT.CORNER_WIPE;break;case _SLIDESHOW_EFFECT.FADE_IN_STILL:e=_SLIDESHOW_EFFECT_TEXT.FADE_IN_STILL;break;case _SLIDESHOW_EFFECT.FADE_IN_LEFT:e=_SLIDESHOW_EFFECT_TEXT.FADE_IN_LEFT;break;case _SLIDESHOW_EFFECT.FADE_IN_RIGHT:e=_SLIDESHOW_EFFECT_TEXT.FADE_IN_RIGHT;break;case _SLIDESHOW_EFFECT.FADE_IN_DOWN:e=_SLIDESHOW_EFFECT_TEXT.FADE_IN_DOWN;break;case _SLIDESHOW_EFFECT.FADE_IN_TOP:e=_SLIDESHOW_EFFECT_TEXT.FADE_IN_TOP;break;case _SLIDESHOW_EFFECT.SPIN_FADE_IN:e=_SLIDESHOW_EFFECT_TEXT.SPIN_FADE_IN;default:}return e},_prepareNext:function(){if(log("Image viewer _prepareNext"),self.nState===_IMAGE_VIEWER_STATE.STATE_STOPPED||self.nState===_IMAGE_VIEWER_STATE.STATE_PAUSED)return!1;var t=self._playList.getNextItem();if(-1!=t)this._playList.currentImageIndex+1<this._playList.list.length&&this._playList.currentImageIndex+1>=self.VISIBLE_THUMB&&self.slideIndex++,this._playList.currentImageIndex<self.VISIBLE_THUMB&&(self.slideIndex=0),self._cacheImage(t.url,function(){});else{self._playList.currentImageIndex=0,self.slideIndex=0;var e=self._playList.getCurItem();self._cacheImage(e.url,function(){})}self.nState===_IMAGE_VIEWER_STATE.STATE_PLAYING&&(self.animationState=_ANIMATION_STATE.RUNNING,self._startEffect())},_playList:{currentImageIndex:0,list:[],incrementIndex:function(){log("Image viewer _playList incrementIndex");var t=this.list.length;t-1>this.currentImageIndex&&this.currentImageIndex++},decrementIndex:function(){log("Image viewer _playList decrementIndex"),this.currentImageIndex>0&&this.currentImageIndex--},getNextItem:function(){log("Image viewer _playList getNextItem");var t=this.list.length;return t-1>this.currentImageIndex?this.list[++this.currentImageIndex]:-1},getCurItem:function(){return log("Image viewer _playList getCurItem"),this.list[this.currentImageIndex]},getItem:function(t){return log("Image viewer _playList getItem"),log("getItem index "+t),this.list[t]}},_startEffect:function(){log("Image viewer _startEffect");var effectNm=this._getEffect(),fn=eval("this."+effectNm);if(caph.isFunction(fn)){var url=this._playList.getCurItem().url;fn.call(this,url,function(){self._setImageInfo(self._playList.getCurItem()),self._resume()})}else log("[EffectStart] error")},_resume:function(){log("Image viewer _resume"),this.nState==_IMAGE_VIEWER_STATE.STATE_PLAYING&&this._prepareNext()},_getDomList:function(t){log("Image viewer _getDomList");var e=t?{visible:self.backImageDom,animating:self.frontImageDom,animImg:self.frontImage,visImg:self.backImage}:{visible:self.frontImageDom,animating:self.backImageDom,animImg:self.backImage,visImg:self.frontImage};return e},_cornerWipe:function(t,e){log("on image Load cornerWipe ");var i=self._getSpeed(),n=self.swichDomFlag,s=self._getDomList(n),o=s.animImg,r=s.visible,a=s.animating;timeline1=null,timeline2=null,timelinePlayer=null,animatingDiv=VDomLookUpTable.getDom(a),visibleDiv=VDomLookUpTable.getDom(r),o.src=t,o.onerror=function(){log("on image Load error "),o.src=no_imageAvaialable_url},o.onload=function(){new caph.animation.Transform(animatingDiv).setMultiply(!1).move(0,0,1,0,"ease-in").set(),new caph.animation.Transform(visibleDiv).setMultiply(!1).move(0,0,0,0,"ease-in").set(),timeline1=new caph.animation.Timeline,timeline2=new caph.animation.Timeline,timeline1.add({transition:caph.animation.transition.move(-_RESOLUTION.WIDTH,-_RESOLUTION.HEIGHT,1),duration:0,ease:caph.animation.ease.easeInOut,delay:0}),timeline1.add({transition:caph.animation.transition.move(_RESOLUTION.WIDTH,_RESOLUTION.HEIGHT,0),duration:i,ease:caph.animation.ease.easeInOut,delay:0,callback:function(){log("cornerwipe callback"+self.swichDomFlag),self._toggleSwitchFlag(),self.animationState=_ANIMATION_STATE.COMPLETE,o.onload=null,e()}}),timelinePlayer=new caph.animation.Player,timelinePlayer.add(animatingDiv,timeline1),timelinePlayer.play()}},_fadeInStill:function(t,e){log("on image Load fadeInStill");var i=self._getSpeed(),n=self.swichDomFlag,s=self._getDomList(n),o=s.animImg,r=s.visible,a=s.animating;timeline1=null,timeline2=null,timelinePlayer=null,animatingDiv=VDomLookUpTable.getDom(a),visibleDiv=VDomLookUpTable.getDom(r),o.src=t,o.onerror=function(){o.src=no_imageAvaialable_url},o.onload=function(){caph.dom._style.set(animatingDiv,"opacity",0),new caph.animation.Transform(animatingDiv).setMultiply(!1).move(0,0,1,0,"ease-in").set(),new caph.animation.Transform(visibleDiv).setMultiply(!1).move(0,0,0,0,"ease-in").set(),timeline1=new caph.animation.Timeline,timeline2=new caph.animation.Timeline,timeline1.add({transition:caph.animation.transition.move(0,0,1),duration:0,ease:caph.animation.ease.easeIn,delay:0}),timeline1.add({transition:caph.animation.transition.move(0,0,0),duration:i,ease:caph.animation.ease.easeIn,opacity:caph.animation.transition.opacity(0,1),delay:0,callback:function(){self._toggleSwitchFlag(),self.animationState=_ANIMATION_STATE.COMPLETE,o.onload=null,e()}}),timelinePlayer=new caph.animation.Player,timelinePlayer.add(animatingDiv,timeline1),timelinePlayer.play()}},_fadeInRight:function(t,e){log("on image Load fadeInRight");var i=self._getSpeed(),n=self.swichDomFlag,s=self._getDomList(n),o=s.animImg,r=s.visible,a=s.animating;timeline1=null,timeline2=null,timelinePlayer=null,animatingDiv=VDomLookUpTable.getDom(a),visibleDiv=VDomLookUpTable.getDom(r),o.src=t,o.onerror=function(){o.src=no_imageAvaialable_url},o.onload=function(){caph.dom._style.set(animatingDiv,"opacity",0),new caph.animation.Transform(animatingDiv).setMultiply(!1).move(0,0,1,0,"ease-in").set(),new caph.animation.Transform(visibleDiv).setMultiply(!1).move(0,0,0,0,"ease-in").set(),timeline1=new caph.animation.Timeline,timeline2=new caph.animation.Timeline,timeline1.add({transition:caph.animation.transition.move(-_RESOLUTION.WIDTH,0,1),duration:0,ease:caph.animation.ease.easeInOut,delay:0}),timeline1.add({transition:caph.animation.transition.move(_RESOLUTION.WIDTH,0,0),duration:i,ease:caph.animation.ease.easeInOut,opacity:caph.animation.transition.opacity(0,1),delay:0,callback:function(){self._toggleSwitchFlag(),self.animationState=_ANIMATION_STATE.COMPLETE,o.onload=null,e()}}),timelinePlayer=new caph.animation.Player,timelinePlayer.add(animatingDiv,timeline1),timelinePlayer.play()}},_fadeInLeft:function(t,e){log("on image Load fadeInLeft");var i=self._getSpeed(),n=self.swichDomFlag,s=self._getDomList(n),o=s.animImg,r=s.visible,a=s.animating;timeline1=null,timeline2=null,timelinePlayer=null,animatingDiv=VDomLookUpTable.getDom(a),visibleDiv=VDomLookUpTable.getDom(r),o.src=t,o.onerror=function(){o.src=no_imageAvaialable_url},o.onload=function(){caph.dom._style.set(animatingDiv,"opacity",0),new caph.animation.Transform(animatingDiv).setMultiply(!1).move(0,0,1,0,"ease-in").set(),new caph.animation.Transform(visibleDiv).setMultiply(!1).move(0,0,0,0,"ease-in").set(),timeline1=new caph.animation.Timeline,timeline2=new caph.animation.Timeline,timeline1.add({transition:caph.animation.transition.move(_RESOLUTION.WIDTH,0,1),duration:0,ease:caph.animation.ease.easeIn,delay:0}),timeline1.add({transition:caph.animation.transition.move(-_RESOLUTION.WIDTH,0,0),duration:i,ease:caph.animation.ease.easeIn,opacity:caph.animation.transition.opacity(0,1),delay:0,callback:function(){self._toggleSwitchFlag(),self.animationState=_ANIMATION_STATE.COMPLETE,o.onload=null,e()}}),timelinePlayer=new caph.animation.Player,timelinePlayer.add(animatingDiv,timeline1),timelinePlayer.play()}},_spinFadeIn:function(t,e){log("on image Load spinFadeIn");var i=self._getSpeed(),n=self.swichDomFlag,s=self._getDomList(n),o=s.animImg,r=s.visible,a=s.animating;timeline1=null,timeline2=null,timelinePlayer=null,animatingDiv=VDomLookUpTable.getDom(a),visibleDiv=VDomLookUpTable.getDom(r),o.src=t,o.onerror=function(){o.src=no_imageAvaialable_url},o.onload=function(){caph.dom._style.set(animatingDiv,"opacity",0),new caph.animation.Transform(animatingDiv).setMultiply(!1).move(0,0,1,0,"ease-in").set(),new caph.animation.Transform(visibleDiv).setMultiply(!1).move(0,0,0,0,"ease-in").set(),timeline1=new caph.animation.Timeline,timeline2=new caph.animation.Timeline;var t=new caph.animation.Timeline;timeline1.add({transition:caph.animation.transition.move(0,0,1),duration:0,ease:caph.animation.ease.easeIn,opacity:caph.animation.transition.opacity(0,0),delay:0}),timeline1.add({transition:caph.animation.transition.move(0,0,0),duration:i,ease:caph.animation.ease.easeIn,delay:0}),timeline2.add({transition:caph.animation.transition.rotateZ(360),duration:i,ease:caph.animation.ease.easeIn,opacity:caph.animation.transition.opacity(0,1),delay:0}),t.add({transition:caph.animation.transition.scale(.2,.2,1),duration:0,ease:caph.animation.ease.easeIn,opacity:caph.animation.transition.opacity(0,0),delay:0}),t.add({transition:caph.animation.transition.scale(5,5,1),duration:i,ease:caph.animation.ease.easeIn,delay:0,callback:function(){self._toggleSwitchFlag(),self.animationState=_ANIMATION_STATE.COMPLETE,o.onload=null,e()}}),timelinePlayer=new caph.animation.Player,timelinePlayer.add(animatingDiv,timeline1),timelinePlayer.add(animatingDiv,timeline2),timelinePlayer.add(animatingDiv,t),timelinePlayer.play()}},_fadeInDown:function(t,e){log("on image Load fadeInDown");var i=self._getSpeed(),n=self.swichDomFlag,s=self._getDomList(n),o=s.animImg,r=s.visible,a=s.animating;timeline1=null,timeline2=null,timelinePlayer=null,animatingDiv=VDomLookUpTable.getDom(a),visibleDiv=VDomLookUpTable.getDom(r),o.src=t,o.onerror=function(){o.src=no_imageAvaialable_url},o.onload=function(){new caph.animation.Transform(animatingDiv).setMultiply(!1).move(0,0,1,0,"ease-in").set(),new caph.animation.Transform(visibleDiv).setMultiply(!1).move(0,0,0,0,"ease-in").set(),timeline1=new caph.animation.Timeline,timeline2=new caph.animation.Timeline,timeline1.add({transition:caph.animation.transition.move(0,-_RESOLUTION.HEIGHT,1),duration:0,ease:caph.animation.ease.easeIn,delay:0}),timeline1.add({transition:caph.animation.transition.move(0,_RESOLUTION.HEIGHT,0),duration:i,ease:caph.animation.ease.easeIn,opacity:caph.animation.transition.opacity(0,1),delay:0,callback:function(){self._toggleSwitchFlag(),self.animationState=_ANIMATION_STATE.COMPLETE,o.onload=null,e()}}),timelinePlayer=new caph.animation.Player,timelinePlayer.add(animatingDiv,timeline1),timelinePlayer.play()}},_fadeInTop:function(t,e){log("on image Load fadeInTop");var i=self._getSpeed(),n=self.swichDomFlag,s=self._getDomList(n),o=s.animImg,r=s.visible,a=s.animating;timeline1=null,timeline2=null,timelinePlayer=null,animatingDiv=VDomLookUpTable.getDom(a),visibleDiv=VDomLookUpTable.getDom(r),o.src=t,o.onerror=function(){o.src=no_imageAvaialable_url},o.onload=function(){new caph.animation.Transform(animatingDiv).setMultiply(!1).move(0,0,1,0,"ease-in").setOpacity(0).set(),new caph.animation.Transform(visibleDiv).setMultiply(!1).move(0,0,0,0,"ease-in").set(),timeline1=new caph.animation.Timeline,timeline2=new caph.animation.Timeline,timeline1.add({transition:caph.animation.transition.move(0,_RESOLUTION.HEIGHT,1),duration:0,ease:caph.animation.ease.easeIn,delay:0}),timeline1.add({transition:caph.animation.transition.move(0,-_RESOLUTION.HEIGHT,0),duration:i,ease:caph.animation.ease.easeIn,opacity:caph.animation.transition.opacity(0,1),delay:0,callback:function(){self._toggleSwitchFlag(),self.animationState=_ANIMATION_STATE.COMPLETE,o.onload=null,e()}}),timelinePlayer=new caph.animation.Player,timelinePlayer.add(animatingDiv,timeline1),timelinePlayer.play()}},_toggleSwitchFlag:function(){log("Image viewer _toggleSwitchFlag"),this.swichDomFlag=0===this.swichDomFlag?1:0},_cacheImage:function(t,e){log("Image viewer _cacheImage"),cacheImage.length&&void 0!=cacheImage[cacheIdx]?(e(),cacheImage[cacheIdx].src=t,cacheIdx=(cacheIdx+1)%MAX_CACHE_LEN):(cacheImage[cacheIdx]=document.createElement("img"),e(),cacheImage[cacheIdx].src=t,cacheIdx=(cacheIdx+1)%MAX_CACHE_LEN)},_hideContextMenu:function(){log("Image viewer _hideContextMenu"),self.speedContextMenu.visibility(!1),self.effectContextMenu.visibility(!1),self.zoomRotateArea.visibility(!1),self.infoPopup.visibility(!1)},_close:function(){log("Image viewer _close");try{self.audioPlayer&&self.audioPlayer.close(),timelinePlayer&&timelinePlayer.clear(),self.hideMenuTimer&&(clearTimeout(self.hideMenuTimer),self.hideMenuTimer=null),self.hideSliderTimer&&(clearTimeout(self.hideSliderTimer),self.hideSliderTimer=null),self.calbackQueueTimer&&(clearTimeout(self.calbackQueueTimer),self.calbackQueueTimer=null),self.infoPopup.destroy(),setTimeout(function(){self.visibility(!1),self.callback("Image viewer object is going to be removed from view!!"),self.destroy()},1e3)}catch(t){console.log(t)}}})}(this),function(t){"use strict";var e=caph.require("module.renderer.RenderEngine"),i=caph.require("module.event.Manager"),n=caph.require("module.focus.Manager"),s=caph.require("ui.base.component.Surface"),o=caph.require("ui.base.Scene"),r=caph.require("ui.base.scene.Manager");$class({$namespace:"caph.AppBase",$extends:e,$constructor:function(){this.$super(),this.surface=null,this.sceneManager=null,this.eventManager=null,this.focusManager=null,this.sceneList=[]},setup:function(t){caph.extend(this._option,t)},_create:function(){this.$super(),this.surface=new s({size:[t.innerWidth,t.innerHeight]}),this.eventManager=i.getInstance(),caph.extend(this._option,{renderer:{root:this.surface}})},_initialize:function(){this.$super(),this._initFocusManager(this.surface),this._initSceneManager(),this._option.userCallback&&"function"==typeof this._option.userCallback.initialize&&this._option.userCallback.initialize(this.surface),this._option.renderer&&this._option.renderer.root.mount(this._option.renderer.mount)},_initFocusManager:function(t){this.focusManager=n.getInstance(),this.focusManager.setRootNode(t)},_initSceneManager:function(){if(this.sceneList.length>0){this.surface._setSceneManager(new r(this.surface)),this.sceneManager=this.surface._getSceneManager();for(var t;t=this.sceneList.shift();)this.sceneManager.add(t.name,t.scene);this.sceneManager.setMainScene(this._option.sceneID)}},_addScene:function(t,e){var i=e;"object"==typeof e&&(i=$class({$extends:o,oncreate:e.oncreate})),this.sceneList.push({name:t,scene:i})}})}(this),function(t){"use strict";var e=null,i=caph.require("AppBase"),n=caph.pattern.singleton(i);$class({$namespace:"caph.app",$constructor:function(){if(e)throw Error('IllegalStateError: The "caph.app" must exist only one instance. Use "caph.app.getInstance()" instead of "new caph.app()".');e=this},initialize:function(t){var e={userCallback:{initialize:t}};return n.getInstance().setup(e),this},addScene:function(t,e){return n.getInstance()._addScene.apply(n.getInstance(),[t,e]),this},run:function(t){t=t||{},caph.extend(t,{renderer:{mount:t.mount}}),n.getInstance().run(t)},$statics:{getInstance:function(){return null===e&&(e=new caph.app),e}}}),t.caph.app=caph.app.getInstance()}(this);